define(["jquery"],function(a){(function(g,e,b,i){var f="table2excel",h={exclude:".noExl",name:"Table2Excel"};function d(k,j){this.element=k;this.settings=g.extend({},h,j);this._defaults=h;this._name=f;this.init()}d.prototype={init:function(){var k=this;var j='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';k.template={head:'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40">'+j+"<head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets>",sheet:{head:"<x:ExcelWorksheet><x:Name>",tail:"</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet>"},mid:"</x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>",table:{head:"<table>",tail:"</table>"},foot:"</body></html>"};k.tableRows=[];g(k.element).each(function(l,n){var m="";g(n).find("tr").not(k.settings.exclude).each(function(p,q){m+="<tr>"+g(q).html()+"</tr>"});k.tableRows.push(m)});k.tableToExcel(k.tableRows,k.settings.name,k.settings.sheetName)},tableToExcel:function(r,j,k){var o=this,m="",n,p,q;o.uri="data:application/vnd.ms-excel;base64,";o.base64=function(t){return e.btoa(unescape(encodeURIComponent(t)))};o.format=function(t,u){return t.replace(/{(\w+)}/g,function(s,v){return u[v]})};k=typeof k==="undefined"?"Sheet":k;o.ctx={worksheet:j||"Worksheet",table:r,sheetName:k,};m=o.template.head;if(g.isArray(r)){for(n in r){m+=o.template.sheet.head+k+n+o.template.sheet.tail}}m+=o.template.mid;if(g.isArray(r)){for(n in r){m+=o.template.table.head+"{table"+n+"}"+o.template.table.tail}}m+=o.template.foot;for(n in r){o.ctx["table"+n]=r[n]}delete o.ctx.table;if(typeof msie!=="undefined"&&msie>0||!!navigator.userAgent.match(/Trident.*rv\:11\./)){if(typeof Blob!=="undefined"){m=[m];var l=new Blob(m,{type:"text/html"});e.navigator.msSaveBlob(l,c(o.settings))}else{txtArea1.document.open("text/html","replace");txtArea1.document.write(o.format(m,o.ctx));txtArea1.document.close();txtArea1.focus();sa=txtArea1.document.execCommand("SaveAs",true,c(o.settings))}}else{p=o.uri+o.base64(o.format(m,o.ctx));q=b.createElement("a");q.download=c(o.settings);q.href=p;b.body.appendChild(q);q.click();b.body.removeChild(q)}return true}};function c(j){return(j.filename?j.filename:"table2excel")+(j.fileext?j.fileext:".xlsx")}g.fn[f]=function(j){var k=this;k.each(function(){if(!g.data(k,"plugin_"+f)){g.data(k,"plugin_"+f,new d(this,j))}});return k}})(jQuery,window,document)});