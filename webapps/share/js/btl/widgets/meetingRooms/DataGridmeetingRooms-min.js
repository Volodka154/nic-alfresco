define(["dojo/_base/declare","btl/widgets/base/DataGrid","dojo/_base/lang"],function(c,i,a){return c([i],{Url:"search/meetingRooms",colModel:[],postMixInProperties:function d(){this.inherited(arguments);this.alfSubscribe("DATAGRID_DELETE_meetingRooms",a.hitch(this,this.deletemeetingRooms),true);this.alfSubscribe("DATAGRID_GET_meetingRooms_DATA",a.hitch(this,this.getmeetingRoomsData),true);this.alfSubscribe("ALF_CLOSE_DIALOG",a.hitch(this,this.closeDialog))},closeDialog:function e(j){alert("123")},setEventsDataGrid:function b(){var j=this;this.grid.pqGrid({rowDblClick:function(k,l){j.focusElement=document.activeElement;j.getmeetingRoomsData()}})},deletemeetingRooms:function f(){var j=this.grid.pqGrid("selection",{type:"row",method:"getSelection"});if(j&&j.length>0){var l=j[0].rowData;var k={};_row=l;this.serviceXhr({url:"/share/proxy/alfresco/meeting/get-meeting-by-room?room="+l.nodeRef,method:"GET",successCallback:this.returnMeetingRequestDelete,callbackScope:this})}},returnMeetingRequestDelete:function(j){if(j.meetings&&j.meetings.length>0){this.alfPublish("ALF_DISPLAY_PROMPT",{message:"Переговорная используется в "+j.meetings.length+" РК мероприятий. Удаление невозможно."},true)}else{j.requiresConfirmation=true;j.confirmationTitle="Удаление";j.confirmationPrompt="Вы действительно хотите удалить: "+_row.number+" ?";j.url="slingshot/datalists/list/node/"+_row.nodeRef.replace("://","/");j.responseTopic="DATAGRID_DELETE_ROW_FROM_STORE",this.alfPublish("ALF_CRUD_DELETE",j,true)}},getmeetingRoomsData:function g(){var j=this.grid.pqGrid("selection",{type:"row",method:"getSelection"});if(j&&j.length>0){var l=j[0].rowData;var k={};k.config={};k.data=l;k.data.rowId=j[0].rowIndx;k.config.dialogTitle="Редактировать";k.config.dialogConfirmationButtonTitle="edit.title";k.config.dialogCancellationButtonTitle="cancel.title";k.config.formSubmissionTopic="BTL_EDIT_meetingRooms";k.config.contentHeight="300px";this.alfPublish("BTL_CREATE_FORM_meetingRooms",k,true);this.alfLog("log","alfresco_meetingRoomsDataGrid__getmeetingRoomsData",l)}},loadDataToDataGrid:function h(k,j){k.items.forEach(function(n,m,l){if(n.confirmationRequired==true){k.items[m].confirmationRequired_img="&#9745;"}else{k.items[m].confirmationRequired_img="&#9937;"}});this.setDataDataGrid(k.items)},})});