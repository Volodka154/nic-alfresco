define(["dojo/_base/declare","btl/widgets/base/Tree","alfresco/documentlibrary/_AlfDocumentListTopicMixin","dojo/_base/lang","alfresco/core/CoreXhr","dojo/store/Observable","service/constants/Default","btl/service/FormContactor"],function(i,g,h,c,d,k,f,l){return i([g,h,d],{i18nRequirements:[{i18nFile:"./i18n/Contactor.properties"}],onClickTopic:"DATAGRID_LOAD_DATA",rootLabel:"departmentTreeRootLabel.label",Url:"/tree/departmentTree",query:"",publishTopic:"TREE_DEPART_CLICK",type:"btl-depart:department-folder",getInfoUrl:"search/department",postMixInProperties:function j(){this.inherited(arguments);this.alfSubscribe("TREE_GET_INFO_DEPARTAMENT",c.hitch(this,this.getInfo),true);this.alfSubscribe("TREE_DELETE_DEPARTAMENT",c.hitch(this,this.deleteNode),true);this.alfSubscribe("TREE_CREATE_DEPARTAMENT",c.hitch(this,this.createDepartment),true)},getInfo:function b(){var m=this.tree.get("selectedItems")[0];this.serviceXhr({url:"/share/proxy/alfresco/"+this.getInfoUrl+"?nodeRef="+m.id,method:"GET",successCallback:this.edit,callbackScope:this})},edit:function a(n,m){this.alfLog("log","alfresco_TreeDepartment__edit response",n);this.alfLog("log","alfresco_TreeDepartment__edit originalRequestConfig",m);var o={};o.config={};o.data=n;o.config.dialogTitle="formEditDepartment.title.label";o.config.dialogConfirmationButtonTitle="edit.title";o.config.dialogCancellationButtonTitle="cancel.title";o.config.formSubmissionTopic="BTL_EDIT_DEPARTAMENT";this.alfPublish("BTL_CREATE_FORM_DEPARTAMENT",o,true)},deleteNode:function e(){var m=this.tree.get("selectedItems")[0];var n={};n.requiresConfirmation=true;n.confirmationTitle="deleteDepartment.title.label";n.confirmationPrompt="Вы действительно хотите удалить: "+m.name+"?";n.nodeRef=m.id;n.responseTopic="BTL_SING_REMOVE_DEPARTAMENT",this.alfPublish("BTL_MSG_DELETE_DIALOG",n,true)},createDepartment:function e(n){var m=this.tree.get("selectedItems")[0];n.rootNodeRef=m.id;this.alfPublish("BTL_CREATE_FORM_DEPARTAMENT",n,true)}})});