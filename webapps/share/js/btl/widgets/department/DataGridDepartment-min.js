define(["dojo/_base/declare","btl/widgets/base/DataGrid","alfresco/core/CoreXhr","alfresco/core/Core","dojo/_base/lang","service/constants/Default"],function(g,l,b,i,a,d){return g([l,b,i],{title:"",Url:"search/dep-children-employee",colModel:[],selectionModel:{type:"null ",mode:"block"},allChild:false,toolbar:{cls:"pq-toolbar-crud",items:[{type:'<span><input id="checkboxAllChild" type="checkbox" onchange="window.employeeGrid.allChild = this.checked; window.employeeGrid.loadDataDataGrid(window.employeeGrid.dataEmployee);" >Отображать все дочерние</span>'}]},postMixInProperties:function m(){this.inherited(arguments);this.alfSubscribe("BTL_EDIT_DEPARTAMENT_EMPLOYEE",a.hitch(this,this.editDepEmployee),true)},gridAutoSize:function j(){var n=document.documentElement.offsetHeight;n-=document.getElementById("SHARE_HEADER").offsetHeight;n-=50;var o=document.documentElement.offsetWidth-document.getElementById("MAIN_LIST_MENU").offsetWidth-document.getElementById("ID_TREE_DEPART").offsetWidth;o-=30;return{height:n,width:o}},loadDataToDataGrid:function k(o,n){this.setDataDataGrid(o.items);window.employeeGrid=this},editDepEmployee:function f(n){this.alfLog("log","btl_DepartmentService__editDepartment",n);this.employee=n;this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+n.nodeRef.replace("://","/")+"/formprocessor",method:"POST",data:this.employee,successCallback:function(){this.loadDataDataGrid({nodeRef:this.dataEmployee.nodeRef})},callbackScope:this})},edit:function e(n){this.serviceXhr({url:"/share/proxy/alfresco/search/employee?nodeRef="+n+"&&oneInfo=true",method:"GET",successCallback:function(o){this.employee=o.items[0];var p={};p.dialogTitle="Редактирование РК сотрудника";p.dialogConfirmationButtonTitle="Сохранить";p.dialogCancellationButtonTitle="Отмена";p.formSubmissionTopic="BTL_EDIT_DEPARTAMENT_EMPLOYEE";p.widgets=this.getWidgets();p.dialogId="FORM_DEPARTAMENT_EMPLOYEE";p.contentWidth="1250px";this.alfPublish("ALF_CREATE_FORM_DIALOG_REQUEST",p,true)},callbackScope:this})},getWidgets:function h(){var A=[{value:"Мужской",label:"Мужской"},{value:"Женский",label:"Женский"}];var L=[];var P={name:"alfresco/forms/controls/DojoValidationTextBox",id:"btl-emp_firstname",config:{label:"btl-emp_firstname.title",name:"prop_btl-emp_firstname",value:(this.employee!==null)?this.employee.firstname:"",requirementConfig:{initialValue:true},validationConfig:[{validation:"minLength",errorMessage:"Поле обязательно для заполнения",length:1}]}};var K={name:"alfresco/forms/controls/DojoValidationTextBox",id:"btl-emp_middlename",config:{label:"btl-emp_middlename.title",name:"prop_btl-emp_middlename",value:(this.employee!==null)?this.employee.middlename:""}};var x={name:"alfresco/forms/controls/DojoValidationTextBox",config:{label:"btl-emp_surname.title",name:"prop_btl-emp_surname",value:(this.employee!==null)?this.employee.surname:"",requirementConfig:{initialValue:true},validationConfig:[{validation:"minLength",errorMessage:"Поле обязательно для заполнения",length:1}]}};var S={name:"alfresco/forms/controls/DojoValidationTextBox",config:{label:"btl-emp_position.title",name:"prop_btl-emp_position",value:(this.employee!==null)?this.employee.position:"",requirementConfig:{initialValue:true}}};var T={name:"btl/widgets/base/btlChoice",id:"ASSOC_BTL_EMP_POSITION",config:{name:"assoc_btl-emp_position",value:(this.employee!==null)?this.employee.position_ref:"",header:"Выбрать должность",labelText:"Должность",labelButton:"...",urlList:"/share/proxy/alfresco/filters/association",dataUrl:{type:"btl-pos:employee-position",s_field:"name",field:"name"},itemUrl:"/share/proxy/alfresco/picker/associationItem",dataItemUrl:{type:"btl-pos:employee-position",field:"name"}}};var G={name:"btl/widgets/base/btlChoice",id:"ASSOC_BTL_EMP_DEPARTMENT",config:{name:"assoc_btl-emp_department",header:"Выбрать подразделение",value:(this.employee!==null)?this.employee.department_ref:"",labelText:"btl-person_department.title",labelButton:"...",urlList:"/share/proxy/alfresco/filters/association",dataUrl:{type:"btl-depart:department-folder",s_field:"name",field:"name"},itemUrl:"/share/proxy/alfresco/picker/associationItem",dataItemUrl:{type:"btl-depart:department-folder",field:"name"}}};var v={name:"btl/widgets/base/btlChoice",id:"ASSOC_BTL_EMP_DIRECTOR",config:{name:"assoc_btl-emp_director",header:"Выбрать руководителя",value:(this.employee!==null)?this.employee.director_ref:"",labelText:"btl-person_director.title",labelButton:"...",urlList:"/share/proxy/alfresco/filters/association",dataUrl:{type:"btl-emp:employee-content",s_field:"surname",field:"surname,firstname,middlename"},itemUrl:"/share/proxy/alfresco/picker/associationItem",dataItemUrl:{type:"btl-emp:employee-content",field:"surname,firstname,middlename"}}};var n={name:"btl/widgets/base/btlChoice",id:"ASSOC_BTL_EMP_USER_ALFRESCO",config:{name:"assoc_btl-emp_user_alfresco",header:"Выбрать аккаунт пользователя Alfresco",value:(this.employee!==null)?this.employee.user_alfresco_ref:"",labelText:"Пользователь Alfresco",labelButton:"Выбрать",urlList:"/share/proxy/alfresco/filters/association",dataUrl:{type:"cm:person",s_field:"userName",field:"userName",userAlfresco:true},itemUrl:"/share/proxy/alfresco/picker/associationItem",dataItemUrl:{type:"cm:person",field:"userName"}}};var p={name:"btl/widgets/base/btlChoice",id:"ASSOC_BTL_EMP_DELEGATES",config:{name:"assoc_btl-emp_delegates",header:"Выбрать заместителей",value:(this.employee!==null)?this.employee.delegates_ref:"",labelText:"",single:false,height:"255px",labelButton:"Выбрать",urlList:"/share/proxy/alfresco/filters/association",dataUrl:{type:"btl-emp:employee-content",s_field:"surname",field:"surname,firstname,middlename"},itemUrl:"/share/proxy/alfresco/picker/associationItems",dataItemUrl:{type:"btl-emp:employee-content",field:"surname,firstname,middlename"},excluded:(this.employee!==null)?[this.employee.nodeRef.toString()]:[]}};var z={name:"btl/widgets/base/TextBox",config:{label:"btl-emp_phone.title",name:"prop_btl-emp_phone",style:{width:"300px"},value:(this.employee!==null)?this.employee.phone:""}};var r={name:"btl/widgets/base/TextBox",config:{label:"btl-emp_mobile.title",name:"prop_btl-emp_mobile",style:{width:"300px"},value:(this.employee!==null)?this.employee.mobile:""}};var R={name:"btl/widgets/base/TextBox",config:{label:"btl-emp_fax.title",name:"prop_btl-emp_fax",style:{width:"300px"},value:(this.employee!==null)?this.employee.fax:""}};var M={name:"btl/widgets/base/TextBox",config:{label:"btl-emp_email.title",name:"prop_btl-emp_email",style:{width:"300px"},value:(this.employee!==null)?this.employee.email:""}};var o={name:"btl/widgets/base/TextBox",config:{label:"btl-emp_tabnum.title",name:"prop_btl-emp_tabnum",style:{width:"250px"},value:(this.employee!==null)?this.employee.tabnum:""}};var Q={name:"alfresco/forms/controls/DojoTextarea",config:{label:"btl-emp_information.title",name:"prop_btl-emp_information",value:(this.employee!==null)?this.employee.information:""}};var O={name:"alfresco/forms/controls/DojoCheckBox",config:{label:"btl-emp_close_choice.title",name:"prop_btl-emp_close_choice",value:(this.employee!==null)?this.employee.close_choice:""}};var E={name:"alfresco/forms/controls/Select",config:{label:"btl-emp_sex.title",name:"prop_btl-emp_sex",value:(this.employee!==null)?this.employee.sex:"",optionsConfig:{fixed:A}}};var D={name:"alfresco/forms/controls/CheckBox",config:{label:"Отключен",name:"prop_btl-emp_notActual",value:(this.employee!==null)?this.employee.notActual:false}};var F={name:"alfresco/forms/controls/CheckBox",config:{label:"Не уведомлять по почте",name:"prop_btl-emp_not_email_notify",value:(this.employee!==null)?this.employee.not_email_notify:false}};if(this.employee!==null){L.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"nodeRef",value:this.employee.nodeRef,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"rowId",value:this.employee.rowId,visibilityConfig:{initialValue:false}}})}else{L.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"alf_destination",value:this.rootNodeRef,visibilityConfig:{initialValue:false}}})}var s={name:"btl/widgets/base/ClassicWindow",config:{title:"Контактная информация",widgets:[]}};var N={name:"btl/widgets/base/ClassicWindow",id:"WIN_DELEGATES",config:{title:"Заместители",style:"width: 383px;",widgets:[]}};var J={name:"btl/widgets/base/ClassicWindow",config:{title:"",widgets:[]}};var I={name:"btl/widgets/base/ClassicWindow",config:{widthPc:"37",title:"Дополнительная информация",widgets:[]}};var H={name:"alfresco/forms/ControlColumn",config:{widgets:[]}};var q={name:"alfresco/forms/ControlColumn",config:{widgets:[]}};var w={name:"alfresco/forms/ControlRow",config:{widgets:[]}};var y={name:"alfresco/forms/ControlRow",config:{widgets:[]}};var C={name:"alfresco/forms/ControlRow",config:{widgets:[]}};var B={name:"alfresco/forms/ControlRow",config:{widgets:[]}};var u={name:"alfresco/forms/ControlColumn",config:{widgets:[]}};var t={name:"alfresco/forms/ControlColumn",config:{widgets:[]}};I.config.widgets.push(E,o,n,D,F);C.config.widgets.push(x,P,K);B.config.widgets.push(T,G,v);u.config.widgets.push(C,B);J.config.widgets.push(u);s.config.widgets.push(z,r,M,R);N.config.widgets.push(p);w.config.widgets.push(s,I,N);t.config.widgets.push(J,w);L.push(t);return L},setEventsDataGrid:function c(){var n=this;this.grid.pqGrid({rowDblClick:function(o,p){n.edit(p.rowData.nodeRef)},showTitle:false})},})});