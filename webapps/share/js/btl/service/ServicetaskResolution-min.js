define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","alfresco/core/CoreXhr","service/constants/Default"],function(e,g,a,b,d){return e([g,b],{data:{},rootNodeRef:null,type:"btl-taskResolution%3ataskResolutionDataType",constructor:function k(l){a.mixin(this,l);this.alfSubscribe("BTL_CREATE_taskResolution",a.hitch(this,this.createtaskResolution));this.alfSubscribe("BTL_CREATE_FORM_taskResolution",a.hitch(this,this.onCreateFormlinkType));this.alfSubscribe("BTL_EDIT_taskResolution",a.hitch(this,this.edittaskResolution))},createtaskResolution:function j(l){this.alfLog("log","btl_createtaskResolutionService__createtaskResolution",l);this.data=l;this.data.name=l["prop_btl-taskResolution_name"];this.data.time=l["prop_btl-taskResolution_time"];this.data.dayType=l["prop_btl-taskResolution_dayType"];this.data.taskType=l["prop_btl-taskResolution_taskType"];this.serviceXhr({url:"/share/proxy/alfresco/api/type/"+this.type+"/formprocessor",method:"POST",data:this.data,successCallback:this.updatetaskResolutionGrid,callbackScope:this})},updatetaskResolutionGrid:function i(o,l){this.alfLog("log","btl_taskResolutionService__updatetaskResolutionGrid",l);var n="";if(l.data["prop_btl-taskResolution_dayType"]=="0"){n="Рабочий"}if(l.data["prop_btl-taskResolution_dayType"]=="1"){n="Календарный"}var m="";if(l.data["prop_btl-taskResolution_taskType"]=="0"){m="Резолюция по Входящему"}if(l.data["prop_btl-taskResolution_taskType"]=="1"){m="Резолюция по Исходящему"}if(l.data["prop_btl-taskResolution_taskType"]=="2"){m="Резолюция по Внутреннему"}if(l.data["prop_btl-taskResolution_taskType"]=="3"){m="Резолюция по Проекту"}if(l.data["prop_btl-taskResolution_taskType"]=="4"){m="Инициативное задание"}if(l.data["prop_btl-taskResolution_taskType"]=="5"){m="Задание по НТД"}if(l.data["prop_btl-taskResolution_taskType"]=="6"){m="Задание по делу проекта"}if(l.data["prop_btl-taskResolution_taskType"]=="7"){m="Задание по мероприятию"}if(l.data["prop_btl-taskResolution_taskType"]=="8"){m="Задание по ОРД"}if(l.data["prop_btl-taskResolution_taskType"]=="9"){m="Задание по договору"}this.alfPublish("DATAGRID_ADD_ROW",{nodeRef:o.persistedObject,name:l.data["prop_btl-taskResolution_name"],time:l.data["prop_btl-taskResolution_time"],dayType:l.data["prop_btl-taskResolution_dayType"],dayTypeName:n,taskType:l.data["prop_btl-taskResolution_taskType"],taskTypeName:m})},edittaskResolution:function h(n){this.alfLog("log","btl_taskResolutionService__edittaskResolution",n);var m="";if(n["prop_btl-taskResolution_dayType"]=="0"){m="Рабочий"}if(n["prop_btl-taskResolution_dayType"]=="1"){m="Календарный"}var l="";if(n["prop_btl-taskResolution_taskType"]=="0"){l="Резолюция по Входящему"}if(n["prop_btl-taskResolution_taskType"]=="1"){l="Задание по Исходящему"}if(n["prop_btl-taskResolution_taskType"]=="2"){l="Резолюция по Внутреннему"}if(n["prop_btl-taskResolution_taskType"]=="3"){l="Задание по Проекту"}if(n["prop_btl-taskResolution_taskType"]=="4"){l="Инициативное задание"}if(n["prop_btl-taskResolution_taskType"]=="5"){l="Задание по НТД"}if(n["prop_btl-taskResolution_taskType"]=="6"){l="Задание по делу проекта"}if(n["prop_btl-taskResolution_taskType"]=="7"){l="Задание по мероприятию"}if(n["prop_btl-taskResolution_taskType"]=="8"){l="Задание по ОРД"}if(n["prop_btl-taskResolution_taskType"]=="9"){l="Задание по договору"}this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+n.nodeRef.replace("://","/")+"/formprocessor",method:"POST",data:n,successCallback:this.alfPublish("DATAGRID_EDIT_ROW",{rowId:n.rowId,name:n["prop_btl-taskResolution_name"],time:n["prop_btl-taskResolution_time"],dayType:n["prop_btl-taskResolution_dayType"],dayTypeName:m,taskType:n["prop_btl-taskResolution_taskType"],taskTypeName:l}),callbackScope:this})},onCreateFormlinkType:function f(l){this.alfLog("log","alfresco_formtaskResolution__onCreateFormtaskResolution",l);this.data=l.data;this.rootNodeRef=l.rootNodeRef;var m={};m.dialogTitle=l.config.dialogTitle;m.dialogConfirmationButtonTitle=l.config.dialogConfirmationButtonTitle;m.dialogCancellationButtonTitle=l.config.dialogCancellationButtonTitle;m.formSubmissionTopic=l.config.formSubmissionTopic;m.widgets=this.getWidgets();this.alfLog("log","alfresco_formtaskResolution__onCreateFormtaskResolution",m);this.alfPublish("ALF_CREATE_FORM_DIALOG_REQUEST",m)},dayTypeOptions:[{value:0,label:"Рабочий"},{value:1,label:"Календарный"}],taskTypeOptions:[{value:0,label:"Резолюция по Входящему"},{value:1,label:"Задание по Исходящему"},{value:2,label:"Резолюция по Внутреннему"},{value:3,label:"Задание по Проекту"},{value:4,label:"Инициативное задание"},{value:5,label:"Задание по НТД"},{value:6,label:"Задание по делу проекта"},{value:7,label:"Задание по мероприятию"},{value:8,label:"Задание по ОРД"},{value:9,label:"Задание по договору"}],getWidgets:function c(){var l=[{name:"alfresco/forms/controls/DojoValidationTextBox",config:{label:"Название",name:"prop_btl-taskResolution_name",value:(this.data!==null)?this.data.name:""}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{label:"Количество дней",name:"prop_btl-taskResolution_time",value:(this.data!==null)?this.data.time:""}},{name:"alfresco/forms/controls/Select",config:{label:"Тип дня",name:"prop_btl-taskResolution_dayType",value:(this.data!==null)?this.data.dayType:"",optionsConfig:{fixed:this.dayTypeOptions}}},{name:"alfresco/forms/controls/Select",config:{label:"Тип задачи",name:"prop_btl-taskResolution_taskType",value:(this.data!==null)?this.data.taskType:"",optionsConfig:{fixed:this.taskTypeOptions}}}];if(this.data!==null){l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"nodeRef",value:this.data.nodeRef,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"rowId",value:this.data.rowId,visibilityConfig:{initialValue:false}}})}else{l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"alf_destination",value:this.rootNodeRef,visibilityConfig:{initialValue:false}}})}return l}})});