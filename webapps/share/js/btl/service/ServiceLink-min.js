define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","alfresco/core/CoreXhr","service/constants/Default"],function(d,h,a,b,c){return d([h,b],{data:{},rootNodeRef:null,type:"btl-link%3alinkType",constructor:function k(l){a.mixin(this,l);this.alfSubscribe("BTL_CREATE_LINK_TYPE",a.hitch(this,this.createLinkType));this.alfSubscribe("BTL_CREATE_FORM_LINK_TYPE",a.hitch(this,this.onCreateFormlinkType));this.alfSubscribe("BTL_EDIT_LINK_TYPE",a.hitch(this,this.editLinkType))},createLinkType:function g(l){this.alfLog("log","btl_createLinkTypeService__createLinkType",l);this.data=l;this.data.name=l["prop_btl-link_name"];this.serviceXhr({url:"/share/proxy/alfresco/api/type/"+this.type+"/formprocessor",method:"POST",data:this.data,successCallback:this.updateLinkTypeGrid,callbackScope:this})},updateLinkTypeGrid:function f(m,l){this.alfLog("log","btl_LinkTypeService__updateLinkTypeGrid",l);this.alfPublish("DATAGRID_ADD_ROW",{nodeRef:m.persistedObject,name:l.data["prop_btl-link_name"]})},editLinkType:function e(l){this.alfLog("log","btl_LinkTypeService__editLinkType",l);this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+l.nodeRef.replace("://","/")+"/formprocessor",method:"POST",data:l,successCallback:this.alfPublish("DATAGRID_EDIT_ROW",{rowId:l.rowId,name:l["prop_btl-link_name"]}),callbackScope:this})},onCreateFormlinkType:function j(l){this.alfLog("log","alfresco_formLinkType__onCreateFormLinkType",l);this.data=l.data;this.rootNodeRef=l.rootNodeRef;var m={};m.dialogTitle=l.config.dialogTitle;m.dialogConfirmationButtonTitle=l.config.dialogConfirmationButtonTitle;m.dialogCancellationButtonTitle=l.config.dialogCancellationButtonTitle;m.formSubmissionTopic=l.config.formSubmissionTopic;m.widgets=this.getWidgets();this.alfLog("log","alfresco_formLinkType__onCreateFormLinkType",m);this.alfPublish("ALF_CREATE_FORM_DIALOG_REQUEST",m)},getWidgets:function i(){var l=[{name:"alfresco/forms/controls/DojoValidationTextBox",config:{label:"Название",name:"prop_btl-link_name",value:(this.data!==null)?this.data.name:""}}];if(this.data!==null){l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"nodeRef",value:this.data.nodeRef,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"rowId",value:this.data.rowId,visibilityConfig:{initialValue:false}}})}else{l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"alf_destination",value:this.rootNodeRef,visibilityConfig:{initialValue:false}}})}return l}})});