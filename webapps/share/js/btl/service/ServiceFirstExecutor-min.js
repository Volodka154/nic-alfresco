define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","btlExtension/windowChoiceItem/window_choice_item","alfresco/core/CoreXhr","service/constants/Default","dojo/topic","dijit/Dialog","dojox/timing/_base"],function(g,j,b,i,d,e,h,k,a){return g([j,d],{constructor:function l(o){b.mixin(this,o)},createFirstExecutors:function c(o){this.alfLog("log","alfresco_createFirstExecutors__getWidgets",o);this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+o.newFirstExecutor.replace("://","/")+"/formprocessor",method:"POST",data:{"prop_btl-people_rank":o["prop_btl-people_rank"]},successCallback:this.successAddFirstExecutor,failureCallback:this.failureAddFirstExecutor,callbackScope:this})},successAddFirstExecutor:function m(p,o){h.publish("ALF_DISPLAY_NOTIFICATION",{message:"Добавлен новый первый исполнитель."});timer=new a.Timer(5000);timer.onTick=function(){timer.stop();require(["dojo/topic"],function(q){q.publish("DATAGRID_REFRESH_DATA")})};timer.start()},failureAddFirstExecutor:function m(p,o){var p=p;failureDialog=new k({title:"Ошибка при добавление первого исполнителя!",content:p.message,style:"width: 300px"});failureDialog.show()},onCreateFormFirstExecutors:function f(o){this.alfLog("log","alfresco_onCreateFormFirstExecutors",o)},getWidgets:function n(){var q=[];var r={name:"btl/widgets/base/TextBox",config:{label:"Ранг",name:"prop_btl-people_rank",style:{width:"250px"},value:(this.data!==null)?this.data.rank:"",validationConfig:[{validation:"regex",regex:"(^$|(\\d{1,5}))",errorMessage:"Только цифры"}]}};if(this.data!==null){q.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"nodeRef",value:this.data.nodeRef,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"rowId",value:this.data.rowId,visibilityConfig:{initialValue:false}}})}var o={name:"btl/widgets/base/ItemPicker",config:{name:"newFirstExecutor",value:"",labelText:"Справочник сотрудников",labelButton:"...",labelPicker:"Выбрать",pickedItemsLabel:"Текущая",availableItemsLabel:"Доступные",propertyToRender:"name",itemsProperty:"items",url:'filters/resource-executor?extra=!ASPECT:"btl-people:firstExecutor"',itemUrl:"/share/proxy/alfresco/picker/associationItem?type=btl-emp:employee-content&field=btl-people:fio&nodeRef="}};var p={name:"alfresco/forms/ControlColumn",config:{widgets:[]}};p.config.widgets.push(o,r);q.push(p);return q}})});