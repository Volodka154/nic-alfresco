define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","alfresco/core/CoreXhr","service/constants/Default"],function(g,h,b,c,d){return g([h,c],{newDoc_type:{},constructor:function f(l){b.mixin(this,l);this.alfSubscribe("BTL_CREATE_DOC_TYPE",b.hitch(this,this.createDoc_type));this.alfSubscribe("BTL_EDIT_DOC_TYPE",b.hitch(this,this.editDoc_type));this.alfSubscribe("BTL_CREATE_FORM_DOC_TYPE",b.hitch(this,this.onCreateFormDoc_type))},createDoc_type:function k(l){this.alfLog("log","btl_Doc_typeService__createDoc_type",l);this.newDoc_type.name=l["prop_btl-docType_name"];this.newDoc_type.type=l["prop_btl-docType_type"];this.serviceXhr({url:"/share/proxy/alfresco/api/type/btl-docType%3adocTypeData/formprocessor",method:"POST",data:{alf_destination:l.alf_destination,"prop_btl-docType_name":l["prop_btl-docType_name"],"prop_btl-docType_type":l["prop_btl-docType_type"]},successCallback:this.updateDoc_typeGrid,callbackScope:this})},updateDoc_typeGrid:function j(m,l){this.newDoc_type.nodeRef=m.persistedObject;this.alfPublish("DATAGRID_ADD_ROW",{nodeRef:this.newDoc_type.nodeRef,name:this.newDoc_type.name,type:this.newDoc_type.type})},editDoc_type:function e(l){this.alfLog("log","btl_Doc_typeService__editDoc_type",l);this.newDoc_type.rowId=l.rowId;this.newDoc_type.name=l["prop_btl-docType_name"];this.newDoc_type.type=l["prop_btl-docType_type"];this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+l.nodeRef.replace("://","/")+"/formprocessor",method:"POST",data:{"prop_btl-docType_name":l["prop_btl-docType_name"],"prop_btl-docType_type":l["prop_btl-docType_type"]},successCallback:this.alfPublish("DATAGRID_EDIT_ROW",this.newDoc_type),callbackScope:this})},onCreateFormDoc_type:function a(l){this.alfLog("log","alfresco_formDoc_type__onCreateFormDoc_type",l);this.data=l.data;this.rootNodeRef=l.rootNodeRef;var m={};m.dialogTitle=l.config.dialogTitle;m.dialogConfirmationButtonTitle=l.config.dialogConfirmationButtonTitle;m.dialogCancellationButtonTitle=l.config.dialogCancellationButtonTitle;m.formSubmissionTopic=l.config.formSubmissionTopic;m.widgets=this.getWidgets();this.alfLog("log","alfresco_formDoc_type__onCreateFormDoc_type",m);this.alfPublish("ALF_CREATE_FORM_DIALOG_REQUEST",m)},getWidgets:function i(){var m=[{value:"Входящий",label:"Входящий"},{value:"Исходящий",label:"Исходящий"},{value:"Внутренний",label:"Внутренний"},{value:"НТД",label:"НТД"},{value:"Мероприятие",label:"Мероприятие"},{value:"ОРД",label:"ОРД"},{value:"Договор",label:"Договор"}];var l=[{name:"alfresco/forms/controls/Select",config:{label:"Тип",name:"prop_btl-docType_type",value:(this.data!==null)?this.data.type:"",optionsConfig:{fixed:m}}},{name:"alfresco/forms/controls/DojoValidationTextBox",id:"btl-docType_name",config:{label:"Название",name:"prop_btl-docType_name",value:(this.data!==null)?this.data.name:"",requirementConfig:{initialValue:true}}}];if(this.data!==null){l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"nodeRef",value:this.data.nodeRef,visibilityConfig:{initialValue:false}}},{name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"rowId",value:this.data.rowId,visibilityConfig:{initialValue:false}}})}else{l.push({name:"alfresco/forms/controls/DojoValidationTextBox",config:{name:"alf_destination",value:this.rootNodeRef,visibilityConfig:{initialValue:false}}})}return l}})});