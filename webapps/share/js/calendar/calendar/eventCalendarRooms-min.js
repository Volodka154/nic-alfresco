define(["dojo/_base/declare","alfresco/core/Core","dojox/calendar/Calendar","dojo/_base/lang","alfresco/core/CoreXhr","meeting/utils/base","dojo/store/Memory","dojo/store/Cache","dojo/store/Observable","dijit/_WidgetBase","dijit/_TemplatedMixin","dojo/text!./templates/EventCalendar.html"],function(f,g,b,c,d,e,i,j,h,a,k,l){return f([a,k,g,d],{templateString:l,room:null,roomObject:null,roomContent:"",style:"position: relative; width: 99vw; height: calc(100vh - 110px);",startTime:null,endTime:null,inputData:null,selectDate:null,cssRequirements:[{cssFile:"./css/eventCalendarRooms.css"}],postMixInProperties:function(){this.inherited(arguments)},itemDoubleClick:function(m){this.alfPublish("ITEM_MEETING_CKICK",{nodeRef:m.item.id},true)},gridClick:function(m){this.alfPublish("BTL_CREATE_FORM_MEETINGS_SELECT_ROOMS",{date:m.date},true)},checkIntersectionTime:function(m){return false},checkMinimalTime:function(m){return false},itemEdit:function(n,m){return false},load:function(n){this.domNode.innerHTML="";if(!n){n=[]}var m=new Date();if(this.selectDate){m=new Date(this.selectDate);if(isNaN(m.getTime())){m=new Date()}}this.calendar=new b({date:m,store:new h(new i({data:n})),dateInterval:(this.calendar)?this.calendar.dateInterval:"month",columnViewProps:{minHours:8,maxHours:22,timeSlotDuration:30,hourSize:37},style:this.style,isItemMoveEnabled:this.itemEdit.bind(this),isItemResizeEnabled:this.itemEdit.bind(this),onItemDoubleClick:this.itemDoubleClick.bind(this),onGridDoubleClick:this.gridClick.bind(this),formatItemTimeFunc:function(r,q,o,p){return q.dateLocaleModule.format(p.startTime,{selector:"time",timePattern:"HH':'mm"})+" - "+q.dateLocaleModule.format(p.endTime,{selector:"time",timePattern:"HH':'mm"})}});___this=this;this.calendar.dateLocaleModule.isWeekend=this.isWeekend.bind(this);this.calendar.placeAt(this.domNode);this.calendar.startup()},isWeekend:function(n){var m=n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate();if(this.weekendDays.indexOf(m)>-1){return true}if(this.workDays.indexOf(m)>-1){return false}if(n.getDay()==6||n.getDay()==0){return true}return false},postCreate:function(){this.loadCalendar(null)},loadCalendar:function(m){this.serviceXhr({url:"/share/proxy/alfresco/meeting/get-my-meeting",method:"GET",successCallback:this.successLoadData,callbackScope:this})},successLoadData:function(o){var n=[];if(o.meetings){for(var m=0;m<o.meetings.length;m++){var p=o.meetings[m];if(p.startDate&&p.endDate){n.push({id:p.nodeRef,summary:p.theme,room:p.room,startTime:new Date(p.startDate),endTime:new Date(p.endDate)})}}}this.load(n)}})});