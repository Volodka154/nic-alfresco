define(["dojo/_base/declare","alfresco/services/BaseService","dojo/_base/lang","meeting/utils/base","alfresco/core/CoreXhr","alfresco/dialogs/AlfDialog","alfresco/core/topics",],function(b,a,f,e,c,d,g){return b([a,c],{constructor:function(h){f.mixin(this,h);this.alfSubscribe("MEETING_SELECT_ROOM",f.hitch(this,this.createMeeting),true);this.alfSubscribe("ITEM_MEETING_CKICK",f.hitch(this,this.meetingItemClick),true)},setCloseModalFunction:function(){document.frameCancel=function(i){var h=document.getElementById("editShadowDiv");h.style.display="none"};document.frameSave=function(i){var h=document.getElementById("editShadowDiv");h.style.display="none"}},openModal:function(j){var i=document.getElementById("editShadowDiv");var h=Dom.get("editModalWindow");this.setCloseModalFunction();h.innerHTML='<div style="height: 100%;"><iframe id="viewDocFrame" style="border-radius: 4px;" width="100%" height="100%" src="'+j+'"></div>';i.src=this.href;i.style.display="block"},meetingItemClick:function(h){if(h.nodeRef){this.openModal("/share/page/dp/ws/meeting-rooms?nodeRef="+h.nodeRef)}},createMeeting:function(h){this.openModal("/share/page/dp/ws/meeting-rooms?room="+h.prop_calendar.room+"&startDate="+this.DateToString(h.prop_calendar.startTime)+"&endDate="+this.DateToString(h.prop_calendar.endTime))},DateToString:function(h){return h.getFullYear()+"-"+this.addZero(h.getMonth()+1)+"-"+this.addZero(h.getDate())+" "+h.getHours()+":"+h.getMinutes()},addZero:function(h){if(h.toString().length==1){return"0"+h}else{return h}}})});