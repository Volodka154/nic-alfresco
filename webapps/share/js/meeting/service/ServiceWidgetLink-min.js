define(["dojo/_base/declare","alfresco/core/Core","dojo/_base/lang","alfresco/core/CoreXhr","service/constants/Default"],function(g,i,a,b,c){return g([i,b],{data:{},rootNodeRef:null,type:"btl-link%3awigetLink",constructor:function e(l){a.mixin(this,l);this.alfSubscribe("BTL_CREATE_WIDGET_LINK",a.hitch(this,this.createWidgetLink));this.alfSubscribe("BTL_CREATE_FORM_WIDGET_LINK",a.hitch(this,this.onCreateFormWidgetLink));this.alfSubscribe("BTL_EDIT_WIDGET_LINK",a.hitch(this,this.editWidgetLink))},createWidgetLink:function k(l){this.alfLog("log","btl_createWigetLinkService__createWigetLink",l);this.data=l;this.data.name=l["prop_btl-link_name"];this.data.alf_destination=this.rootNodeRef;this.data["assoc_btl-link_linkType_added"]=l["assoc_btl-link_linkType"];this.data["prop_btl-link_text"]=l["assoc_btl-link_linkObject_val"];this.serviceXhr({url:"/share/proxy/alfresco/api/type/"+this.type+"/formprocessor",method:"POST",data:this.data,successCallback:this.updateWidgetLinkGrid,callbackScope:this})},updateWidgetLinkGrid:function f(m,l){this.alfLog("log","btl_WigetLinkService__updateWigetLinkGrid",l);this.alfPublish("REFRESH_LINKS_GRID",null,true)},editWidgetLink:function h(l){this.alfLog("log","btl_WidgetLinkService__editWidgetLink",l);l["assoc_btl-link_linkType_added"]=l["assoc_btl-link_linkType"];l["assoc_btl-link_linkType_removed"]=this.data["assoc_btl-link_linkType"];this.serviceXhr({url:"/share/proxy/alfresco/api/node/"+this.data.nodeRef.replace("://","/")+"/formprocessor",method:"POST",data:l,successCallback:this.alfPublish("REFRESH_LINKS_GRID",null,true),callbackScope:this})},onCreateFormWidgetLink:function j(l){this.alfLog("log","alfresco_formWidgetLink__onCreateFormWidgetLink",l);this.data=l.data;this.rootNodeRef=l.rootNodeRef;var m={};m.dialogTitle=l.config.dialogTitle;m.dialogConfirmationButtonTitle=l.config.dialogConfirmationButtonTitle;m.dialogCancellationButtonTitle=l.config.dialogCancellationButtonTitle;m.formSubmissionTopic=l.config.formSubmissionTopic;m.widgets=this.getWidgets();this.alfLog("log","alfresco_formWidgetLink__onCreateFormWidgetLink",m);this.alfPublish("ALF_CREATE_FORM_DIALOG_REQUEST",m)},getWidgets:function d(){var o={name:"meeting/forms/controlLinksForm/Controls/LinkObjectTypeSelect",config:{value:(this.data!==null)?this.data["prop_btl-link_docType"]:"",onValueChangeEvent:function(q,p,r){this.alfPublish("BTL_LINK_OBJECT_TYPE_CHANGED",r,true)}}};var m={name:"meeting/forms/controlLinksForm/Controls/LinkObjectItemPicker",config:{readOnly:this.data!=null,value:(this.data)?this.data["assoc_btl-link_linkObject"]:"",objectType:(this.data!==null)?this.data["prop_btl-link_docType"]:"",rootNodeRef:this.rootNodeRef,disablementConfig:{initialValue:true,rules:[{targetId:"LINK_OBJECT_TYPE_SELECT",is:[null]}]},requirementConfig:{initialValue:true},}};var l={name:"meeting/forms/controlLinksForm/Controls/LinkTypeSelect",config:{value:(this.data!==null)?this.data["assoc_btl-link_linkType"]:"",objectType:(this.data!==null)?this.data["prop_btl-link_docType"]:"",rootNodeRef:this.rootNodeRef,requirementConfig:{initialValue:true},}};var n=[o,m,l];return n}})});