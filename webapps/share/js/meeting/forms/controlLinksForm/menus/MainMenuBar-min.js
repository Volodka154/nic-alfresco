define(["dojo/_base/declare","meeting/menus/_MenuBar","dojo/_base/lang","meeting/utils/base","dojo/topic",],function(b,e,d,c,a){return b([e],{access:"",state:"",documentNodeRef:null,isReadOnly:false,pathToComponents:"meeting/forms/controlLinksForm/MenuItems/",postMixInProperties:function(){this.inherited(arguments);this.initFirstRowHandle=this.alfSubscribe("ALF_WIDGET_PROCESSING_COMPLETE",d.hitch(this,this.initFirstRow),true);a.subscribe("SELECT_ROW_LINKS_GRID",this.changeStageMenuBar.bind(this))},initFirstRow:function(){if(this.widgetProcessingComplete){a.publish("TRIGGER_CURRENT_ROW_DATA_LINKS",{});this.alfUnsubscribe(this.initFirstRowHandle);if(this.documentNodeRef){this.setOnLoadMenuStage()}}},setOnLoadMenuStage:function(){Alfresco.util.Ajax.request({method:"GET",url:Alfresco.constants.PROXY_URI+"slingshot/doclib/node/"+this.documentNodeRef.replace("://","/"),successCallback:{fn:function(f){if(f.json.item.permissions.userAccess.edit!=true){this.alfPublish(this.pubSubScope+"IS_READ_ONLY_LINKS",{},true);this.isReadOnly=true}},scope:this}})},changeStageMenuBar:function(g){if(!this.isReadOnly){Alfresco.util.Ajax.jsonGet({url:Alfresco.constants.PROXY_URI+"slingshot/doclib/node/"+g.nodeRef.replace("://","/"),successCallback:{fn:function f(h){this.alfPublish(this.pubSubScope+"META_SELECT_DOCUMENT",h.json,true)},scope:this}})}},postCreate:function(){if(!this.state&&this.storeId){var f=c.getStoreById(this.storeId);if(f.document){this.state=f.state;this.documentNodeRef=f.nodeRef}}var i={name:this.pathToComponents+"AddLinkMenuItem",config:{documentNodeRef:this.documentNodeRef}};var h={name:this.pathToComponents+"EditLinkMenuItem",config:{parentNodeRef:this.documentNodeRef}};var g={name:this.pathToComponents+"DeleteLinkMenuItem",config:{parentNodeRef:this.documentNodeRef}};this.widgets=[i,h,g];this.inherited(arguments)},setState:function(f){this.state=f.state;switch(this.state){case"":break;default:break}},disableMenu:function(g){var f=g.isDisable;var h=this._processingWidgets;h.forEach(function(i){i.setDisabled((f)?true:false)})}})});