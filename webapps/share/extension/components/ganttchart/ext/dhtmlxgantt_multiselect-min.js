gantt.config.multiselect=!0,gantt.config.multiselect_one_level=!1,gantt._multiselect={selected:{},one_level:!0,active:!0,isActive:function(){return this.update_state(),this.active},update_state:function(){this.one_level=gantt.config.multiselect_one_level;var a=this.active;this.active=gantt.config.multiselect,this.active!=a&&this.reset()},reset:function(){this.selected={}},set_last_selected:function(a){this.last_selected=a},getLastSelected:function(){var a=this.last_selected;return a&&gantt.isTaskExists(a)?a:null},select:function(a,b){gantt.callEvent("onBeforeTaskMultiSelect",[a,!0,b])&&(this.selected[a]=!0,this.set_last_selected(a),gantt.callEvent("onTaskMultiSelect",[a,!0,b]))},toggle:function(a,b){this.selected[a]?this.unselect(a,b):this.select(a,b)},unselect:function(a,b){gantt.callEvent("onBeforeTaskMultiSelect",[a,!1,b])&&(this.selected[a]=!1,this.last_selected==a&&(this.last_selected=null),gantt.callEvent("onTaskMultiSelect",[a,!0,b]))},isSelected:function(a){return !(!gantt.isTaskExists(a)||!this.selected[a])},getSelected:function(){var a=[];for(var b in this.selected){this.selected[b]&&gantt.isTaskExists(b)?a.push(b):this.selected[b]=!1}return a.sort(function(c,d){return gantt.calculateTaskLevel(gantt.getTask(c))>gantt.calculateTaskLevel(gantt.getTask(d))?1:-1}),a},forSelected:function(a){for(var b=this.getSelected(),c=0;c<b.length;c++){a(b[c])}},is_same_level:function(a){if(!this.one_level){return !0}var b=this.getLastSelected();return b&&gantt.isTaskExists(b)&&gantt.isTaskExists(a)?!(gantt.calculateTaskLevel(gantt.getTask(b))!=gantt.calculateTaskLevel(gantt.getTask(a))):!0},_after_select:function(a){gantt.refreshTask(a)},_do_selection:function(d){if(!this.isActive()){return !0}var h=gantt.locate(d),j=this.getSelected();if(!h){return !0}if(!gantt.callEvent("onBeforeMultiSelect",[d])){return !0}if(d.ctrlKey||d.metaKey){h&&(this.toggle(h,d),this._after_select(h))}else{if(d.shiftKey&&j.length){var b=this.getLastSelected();if(b||(b=j[j.length-1]),h&&b!=h){for(var c=gantt.getGlobalTaskIndex(b),f=gantt.getGlobalTaskIndex(h),g=h;gantt.getGlobalTaskIndex(g)!=c;){this.select(g),this._after_select(g),g=c>f?gantt.getNext(g):gantt.getPrev(g)}this.forSelected(gantt.bind(function(a){var i=gantt.getGlobalTaskIndex(a);(i>c&&i>f||c>i&&f>i)&&(this.unselect(a),gantt.refreshTask(a))},this))}}else{this.forSelected(gantt.bind(function(a){a!=h&&(this.unselect(a),gantt.refreshTask(a))},this)),this.isSelected(h)||(this.select(h),this._after_select(h))}}return this.isSelected(h)?!0:!1}},function(){var a=gantt.selectTask;gantt.selectTask=function(c){var d=a.call(this,c);return this.config.multiselect&&this._multiselect.select(c),d};var b=gantt.unselectTask;gantt.unselectTask=function(c){void 0!==c&&this.config.multiselect&&this._multiselect.unselect(c);var d=b.call(this,c);return d},gantt.toggleTaskSelection=function(c){this.config.multiselect&&this._multiselect.toggle(c)},gantt.getSelectedTasks=function(){return this._multiselect.getSelected()},gantt.eachSelectedTask=function(c){return this._multiselect.forSelected(c)},gantt.isSelectedTask=function(c){return this._multiselect.isSelected(c)},gantt.getLastSelectedTask=function(){return this._multiselect.getLastSelected()}}(),gantt.attachEvent("onTaskIdChange",function(a,b){var c=gantt._multiselect;return c.isActive()?void (gantt.isSelectedTask(a)&&(c.unselect(a,null),c.select(b,null),gantt.refreshTask(b))):!0}),gantt.attachEvent("onAfterTaskDelete",function(a,b){var c=gantt._multiselect;return c.isActive()?(c.selected[a]&&c.unselect(a,null),void c.forSelected(function(d){gantt.isTaskExists(d)||c.unselect(d,null)})):!0}),gantt.attachEvent("onBeforeTaskMultiSelect",function(c,d,f){var b=gantt._multiselect;return d&&b.isActive()?b.is_same_level(c):!0}),gantt.attachEvent("onTaskClick",function(a,b){var c=gantt._multiselect._do_selection(b);return gantt.callEvent("onMultiSelect",[b]),c}),gantt.attachEvent("onEmptyClick",function(a){return gantt._multiselect._do_selection(a),gantt.callEvent("onMultiSelect",[a]),!0});