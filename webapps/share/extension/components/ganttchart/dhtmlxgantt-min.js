gantt={version:"4.0.0"},gantt.event=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},gantt.eventRemove=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c)},gantt._eventable=function(a){a._silent_mode=!1,a._silentStart=function(){this._silent_mode=!0},a._silentEnd=function(){this._silent_mode=!1},a.attachEvent=function(b,c,d){return b="ev_"+b.toLowerCase(),this[b]||(this[b]=new this._eventCatcher(d||this)),b+":"+this[b].addEvent(c)},a.callEvent=function(b,c){return this._silent_mode?!0:(b="ev_"+b.toLowerCase(),this[b]?this[b].apply(this,c):!0)},a.checkEvent=function(b){return !!this["ev_"+b.toLowerCase()]},a._eventCatcher=function(b){var c=[],d=function(){for(var g=!0,e=0;e<c.length;e++){if(c[e]){var f=c[e].apply(b,arguments);g=g&&f}}return g};return d.addEvent=function(e){return"function"==typeof e?c.push(e)-1:!1},d.removeEvent=function(e){c[e]=null},d},a.detachEvent=function(b){if(b){var c=b.split(":");this[c[0]].removeEvent(c[1])}},a.detachAllEvents=function(){for(var b in this){0===b.indexOf("ev_")&&delete this[b]}},a=null},gantt.copy=function(c){var d,f,b;if(c&&"object"==typeof c){for(b={},f=[Array,Date,Number,String,Boolean],d=0;d<f.length;d++){c instanceof f[d]&&(b=d?new f[d](c):new f[d])}for(d in c){Object.prototype.hasOwnProperty.apply(c,[d])&&(b[d]=gantt.copy(c[d]))}}return b||c},gantt.mixin=function(c,d,f){for(var b in d){(!c[b]||f)&&(c[b]=d[b])}return c},gantt.defined=function(a){return"undefined"!=typeof a},gantt.uid=function(){return this._seed||(this._seed=(new Date).valueOf()),this._seed++,this._seed},gantt.bind=function(a,b){return a.bind?a.bind(b):function(){return a.apply(b,arguments)}},gantt._get_position=function(m){var h=0,f=0;if(m.getBoundingClientRect){var k=m.getBoundingClientRect(),g=document.body,p=document.documentElement,b=window.pageYOffset||p.scrollTop||g.scrollTop,c=window.pageXOffset||p.scrollLeft||g.scrollLeft,l=p.clientTop||g.clientTop||0,j=p.clientLeft||g.clientLeft||0;return h=k.top+b-l,f=k.left+c-j,{y:Math.round(h),x:Math.round(f),width:m.offsetWidth,height:m.offsetHeight}}for(;m;){h+=parseInt(m.offsetTop,10),f+=parseInt(m.offsetLeft,10),m=m.offsetParent}return{y:h,x:f,width:m.offsetWidth,height:m.offsetHeight}},gantt._detectScrollSize=function(){var a=document.createElement("div");a.style.cssText="visibility:hidden;position:absolute;left:-1000px;width:100px;padding:0px;margin:0px;height:110px;min-height:100px;overflow-y:scroll;",document.body.appendChild(a);var b=a.offsetWidth-a.clientWidth;return document.body.removeChild(a),b},window.dhtmlx&&(dhtmlx.attaches||(dhtmlx.attaches={}),dhtmlx.attaches.attachGantt=function(d,g,h){var b=document.createElement("DIV");h=h||window.gantt,b.id="gantt_"+h.uid(),b.style.width="100%",b.style.height="100%",b.cmp="grid",document.body.appendChild(b),this.attachObject(b.id);var c=this.vs[this.av];c.grid=h,h.init(b.id,d,g),b.firstChild.style.border="none",c.gridId=b.id,c.gridObj=b;var f="_viewRestore";return this.vs[this[f]()].grid}),"undefined"!=typeof window.dhtmlXCellObject&&(dhtmlXCellObject.prototype.attachGantt=function(c,d,f){f=f||window.gantt;var b=document.createElement("DIV");b.id="gantt_"+f.uid(),b.style.width="100%",b.style.height="100%",b.cmp="grid",document.body.appendChild(b),this.attachObject(b.id),f.init(b.id,c,d),b.firstChild.style.border="none";return b=null,this.callEvent("_onContentAttach",[]),this.dataObj}),gantt._eventable(gantt),gantt._click={},gantt._dbl_click={},gantt._context_menu={},gantt._on_click=function(d){d=d||window.event;var f=d.target||d.srcElement,g=gantt.locate(d),b=!0;if(null!==g?b=!gantt.checkEvent("onTaskClick")||gantt.callEvent("onTaskClick",[g,d]):gantt.callEvent("onEmptyClick",[d]),b){var c=gantt._find_ev_handler(d,f,gantt._click,g);if(!c){return}g&&gantt.getTask(g)&&gantt.config.select_task&&gantt.selectTask(g)}},gantt._on_contextmenu=function(d){d=d||window.event;var f=d.target||d.srcElement,g=gantt.locate(f),b=gantt.locate(f,gantt.config.link_attribute),c=!gantt.checkEvent("onContextMenu")||gantt.callEvent("onContextMenu",[g,b,d]);return c||(d.preventDefault?d.preventDefault():d.returnValue=!1),c},gantt._find_ev_handler=function(d,h,k,b){for(var c=!0;h;){var f=gantt._getClassName(h);if(f){f=f.split(" ");for(var g=0;g<f.length;g++){if(f[g]&&k[f[g]]){var j=k[f[g]].call(gantt,d,b,h);c=c&&!("undefined"!=typeof j&&j!==!0)}}}h=h.parentNode}return c},gantt._on_dblclick=function(d){d=d||window.event;var f=d.target||d.srcElement,g=gantt.locate(d),b=!gantt.checkEvent("onTaskDblClick")||gantt.callEvent("onTaskDblClick",[g,d]);if(b){var c=gantt._find_ev_handler(d,f,gantt._dbl_click,g);if(!c){return}null!==g&&gantt.getTask(g)&&b&&gantt.config.details_on_dblclick&&gantt.showLightbox(g)}},gantt._on_mousemove=function(a){if(gantt.checkEvent("onMouseMove")){var b=gantt.locate(a);gantt._last_move_event=a,gantt.callEvent("onMouseMove",[b,a])}},gantt._DnD=function(a,b){b&&(this._settings=b),gantt._eventable(this),gantt.event(a,"mousedown",gantt.bind(function(c){b.original_target={target:c.target||c.srcElement},this.dragStart(a,c)},this))},gantt._DnD.prototype={dragStart:function(d,f){this.config={obj:d,marker:null,started:!1,pos:this.getPosition(f),sensitivity:4},this._settings&&gantt.mixin(this.config,this._settings,!0);var g=gantt.bind(function(a){return this.dragMove(d,a)},this),b=(gantt.bind(function(a){return this.dragScroll(d,a)},this),gantt.bind(function(a){return gantt.defined(this.config.updates_per_second)&&!gantt._checkTimeout(this,this.config.updates_per_second)?!0:g(a)},this)),c=gantt.bind(function(a){return gantt.eventRemove(document.body,"mousemove",b),gantt.eventRemove(document.body,"mouseup",c),this.dragEnd(d)},this);gantt.event(document.body,"mousemove",b),gantt.event(document.body,"mouseup",c),document.body.className+=" gantt_noselect"},dragMove:function(d,h){if(!this.config.marker&&!this.config.started){var j=this.getPosition(h),b=j.x-this.config.pos.x,c=j.y-this.config.pos.y,f=Math.sqrt(Math.pow(Math.abs(b),2)+Math.pow(Math.abs(c),2));if(f>this.config.sensitivity){if(this.config.started=!0,this.config.ignore=!1,this.callEvent("onBeforeDragStart",[d,this.config.original_target])===!1){return this.config.ignore=!0,!0}var g=this.config.marker=document.createElement("div");g.className="gantt_drag_marker",g.innerHTML="Dragging object",document.body.appendChild(g),this.callEvent("onAfterDragStart",[d,this.config.original_target])}else{this.config.ignore=!0}}this.config.ignore||(h.pos=this.getPosition(h),this.config.marker.style.left=h.pos.x+"px",this.config.marker.style.top=h.pos.y+"px",this.callEvent("onDragMove",[d,h]))},dragEnd:function(a){this.config.marker&&(this.config.marker.parentNode.removeChild(this.config.marker),this.config.marker=null,this.callEvent("onDragEnd",[])),document.body.className=document.body.className.replace(" gantt_noselect","")},getPosition:function(a){var b=0,c=0;return a=a||window.event,a.pageX||a.pageY?(b=a.pageX,c=a.pageY):(a.clientX||a.clientY)&&(b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:b,y:c}}},gantt._init_grid=function(){this._click.gantt_close=this.bind(function(a,b,c){return this.close(b),!1},this),this._click.gantt_open=this.bind(function(a,b,c){return this.open(b),!1},this),this._click.gantt_row=this.bind(function(c,d,f){if(null!==d){var b=this.getTask(d);this.config.scroll_on_click&&this.showDate(b.start_date),this.callEvent("onTaskRowClick",[d,f])}},this),this._click.gantt_grid_head_cell=this.bind(function(d,h,k){var b=k.getAttribute("column_id");if(this.callEvent("onGridHeaderClick",[b,d])){if("add"==b){return void this._click.gantt_add(d,this.config.root_id)}if(this.config.sort){for(var c,f=b,g=0;this.config.columns.length;g++){if(this.config.columns[g].name==b){c=this.config.columns[g];break}}if(c&&void 0!==c.sort&&c.sort!==!0&&(f=c.sort,!f)){return}var j=this._sort&&this._sort.direction&&this._sort.name==b?this._sort.direction:"desc";j="desc"==j?"asc":"desc",this._sort={name:b,direction:j},this.sort(f,"desc"==j)}}},this),!this.config.sort&&this.config.order_branch&&this._init_dnd(),this._click.gantt_add=this.bind(function(c,d,f){if(!this.config.readonly){var b={};return this.createTask(b,d?d:this.config.root_id),!1}},this),this._init_resize&&this._init_resize()},gantt._render_grid=function(){this._is_grid_visible()&&(this._calc_grid_width(),this._render_grid_header())},gantt._calc_grid_width=function(){for(var k=this.getGridColumns(),g=0,d=[],h=[],f=0;f<k.length;f++){var l=parseInt(k[f].width,10);window.isNaN(l)&&(l=50,d.push(f)),h[f]=l,g+=l}if(this.config.autofit||d.length){var b=this._get_grid_width()-g;b/(d.length>0?d.length:h.length>0?h.length:1);if(d.length>0){for(var c=b/(d.length?d.length:1),f=0;f<d.length;f++){var j=d[f];h[j]+=c}}else{for(var c=b/(h.length?h.length:1),f=0;f<h.length;f++){h[f]+=c}}for(var f=0;f<h.length;f++){k[f].width=h[f]}}else{this.config.grid_width=g}},gantt._render_grid_header=function(){for(var z=this.getGridColumns(),u=[],j=0,x=this.locale.labels,m=this.config.scale_height-2,A=0;A<z.length;A++){var b=A==z.length-1,f=z[A],y=1*f.width;b&&this._get_grid_width()>j+y&&(f.width=y=this._get_grid_width()-j),j+=y;var v=this._sort&&f.name==this._sort.name?"<div class='gantt_sort gantt_"+this._sort.direction+"'></div>":"",k=["gantt_grid_head_cell","gantt_grid_head_"+f.name,b?"gantt_last_cell":"",this.templates.grid_header_class(f.name,f)].join(" "),q="width:"+(y-(b?1:0))+"px;",p=f.label||x["column_"+f.name];p=p||"";var w="<div class='"+k+"' style='"+q+"' column_id='"+f.name+"'>"+p+v+"</div>";u.push(w)}this.$grid_scale.style.height=this.config.scale_height-1+"px",this.$grid_scale.style.lineHeight=m+"px",this.$grid_scale.style.width=j-1+"px",this.$grid_scale.innerHTML=u.join("")},gantt._render_grid_item=function(B){if(!gantt._is_grid_visible()){return null}dateControls=[];var j=1;for(var M=this.getGridColumns(),F=[],S=0;S<M.length;S++){var I,C,D=S==M.length-1,E=M[S];titleName=B[E.name];if(this.indexCount==null){this.indexCount=1}if(B.index==null){B.index=this.indexCount}datetext="";employeeText="";dateClick=false;var b="";change="";if(E.change){change="projectcheckDateDuration('"+B.id+"','"+B.parent+"')"}if(E.checkEndDate){change="projectcheckEndDate('"+B.id+"','"+B.parent+"')"}dateClick=false;if(B.index>1){dateClick=false;if(E.name=="start_date"){field="prop_btl-task_startDate";dateClick=true}else{if(E.name=="end_date"){field="prop_btl-task_endDate";dateClick=true}}if(dateClick){var L=new Date(titleName);var Q=L.getDate();var G=L.getMonth()+1;var w=L.getFullYear();var N=addZero(Q)+"."+addZero(G)+"."+w;if(E.edit){if(E.change){change="projectcheckDateDuration('"+B.id+"','"+B.parent+"'); document.getElementById('"+B.id+"_isAutoDate').innerHTML = ''; "}var x="ganttTableInputDate";var v=document.getElementById(B.id+"-"+E.name+"-value");if(v!=null){b=v.value}datetext='<input name="'+B.id+"-"+E.name+'-value" id="'+B.id+"-"+E.name+'-value" type="text" class="'+x+'" value="'+N+'" >';datetext+='<a tabindex="0" id="'+B.id+"-"+E.name+'-endTime-icon" onclick="showCalendar(\''+B.id+"', '"+E.name+'\')" style="float: right;">';datetext+='<img tabindex="0" class="datepicker-icon" src="/share/res/components/form/images/calendar.png" style="height: 80%; vertical-align: -4px;">';datetext+="</a>";datetext+='<div id="'+B.id+"-"+E.name+'-calendar" class="datepicker yui-calcontainer single withtitle"></div>'}else{datetext=N}}}"add"==E.name?C="<div class='gantt_add'></div>":(C=E.template?E.template(B):B[E.name],C instanceof Date&&(C=datetext),C="<div class='gantt_tree_content'>"+C+"</div>");var T="gantt_cell"+(D?" gantt_last_cell":""),O="";if(E.employee&&B.index>1){employeeName=B[E.name];var p=document.getElementById(B.id+"-employee");if(p){employeeName=p.innerHTML}if(E.edit){employeeText='<span class="editdateButton" onclick="editEmployee(\''+employeeName+"','"+B.id+'\')" style="float:right">&#9998;</span>';C="<div class='gantt_tree_content' style='width:100%;'><span id='"+B.id+"-employee' style='float:left'>"+employeeName+"</span>"+employeeText+"</div>"}else{employeeText=employeeName}}if(E.edit==true){if(B["inputValue"+E.name]==null){B["inputValue"+E.name]=B[E.name]}else{var A=document.getElementById(B.id+"_"+E.name);if(A){B["inputValue"+E.name]=A.value}else{B["inputValue"+E.name]=B[E.name]}}var k='type="text"';if(E.type){k='type="'+E.type+'"'}var R=B["inputValue"+E.name];st=R.length>25?'style="overflow: hidden; text-overflow:ellipsis; white-space: nowrap; width: 17em !important;"':"";C='<input id="'+B.id+"_"+E.name+'" '+k+'  value="'+B["inputValue"+E.name]+'" class="'+E.style+'"'+st+' onchange="'+change+'" >'}if(E.tree){this.indexCount=this.indexCount+1;for(var H=0;H<B.$level;H++){O+=this.templates.grid_indent(B)}var K=this._has_children(B.id);K?(O+=this.templates.grid_open(B)):(O+=this.templates.grid_blank(B));var q="";if(E.num){q="<div class='gantt_cell' style='width: 35px;'>"+B.index+"</div>"}var J="width:"+(E.width-(D?1:0)-35)+"px;";this.defined(E.align)&&(J+="text-align:"+E.align+";"),I=q+"<div class='"+T+"' style='"+J+"' title='"+titleName+"'>"+O+C+"</div>",F.push(I)}else{var J="width:"+(E.width-(D?1:0))+"px;";this.defined(E.align)&&(J+="text-align:"+E.align+";"),I="<div class='"+T+"' style='"+J+"'>"+O+C+"</div>",F.push(I)}if(dateClick){var U=B[E.name];if(b!=""){U=b}B[E.name].Value=getStringDate(B[E.name]);B[E.name].controlValue=getStringDate(U)}}var T=B.$index%2===0?"":" odd";if(T+=B.$transparent?" gantt_transparent":"",T+=B.$dataprocessor_class?" "+B.$dataprocessor_class:"",this.templates.grid_row_class){var P=this.templates.grid_row_class.call(this,B.start_date,B.end_date,B);P&&(T+=" "+P)}this.getState().selected_task==B.id&&(T+=" gantt_selected");var z=document.createElement("div");z.className="gantt_row"+T,z.style.height=j*this.config.row_height+"px",z.style.lineHeight=j*gantt.config.row_height+"px",z.setAttribute(this.config.task_attribute,B.id),z.innerHTML=F.join(""),z;return z},gantt.open=function(a){gantt._set_item_state(a,!0),this.callEvent("onTaskOpened",[a])},gantt.close=function(a){gantt._set_item_state(a,!1),this.callEvent("onTaskClosed",[a])},gantt._set_item_state=function(a,b){a&&this._pull[a]&&(this._pull[a].$open=b,gantt._refresh_on_toggle_element(a))},gantt._refresh_on_toggle_element=function(a){this.refreshData()},gantt._is_grid_visible=function(){return this.config.grid_width&&this.config.show_grid},gantt._get_grid_width=function(){return this._is_grid_visible()?this._is_chart_visible()?this.config.grid_width:this._x:0},gantt.moveTask=function(k,g,d){var h=arguments[3];if(h){if(h===k){return}d=this.getParent(h),g=this.getTaskIndex(h)}if(k!=d){d=d||this.config.root_id;var f=this.getTask(k),l=this.getParent(f.id),b=(this.getChildren(this.getParent(f.id)),this.getChildren(d));if(-1==g&&(g=b.length+1),l==d){var c=this.getTaskIndex(k);if(c==g){return}}if(this.callEvent("onBeforeTaskMove",[k,d,g])!==!1){this._replace_branch_child(l,k),b=this.getChildren(d);var j=b[g];j?b=b.slice(0,g).concat([k]).concat(b.slice(g)):b.push(k),this.setParent(f,d),this._branches[d]=b,f.$level=this.calculateTaskLevel(f),1*g>0?h?f.$drop_target=(this.getTaskIndex(k)>this.getTaskIndex(h)?"next:":"")+h:f.$drop_target="next:"+gantt.getPrevSibling(k):b[1*g+1]?f.$drop_target=b[1*g+1]:f.$drop_target=d,this.callEvent("onAfterTaskMove",[k,d,g])&&this.refreshData()}}},gantt._init_dnd=function(){var a=new gantt._DnD(this.$grid_data,{updates_per_second:60});this.defined(this.config.dnd_sensitivity)&&(a.config.sensitivity=this.config.dnd_sensitivity),a.attachEvent("onBeforeDragStart",this.bind(function(f,g){var b=this._locateHTML(g);if(!b){return !1}this.hideQuickInfo&&this._hideQuickInfo();var c=this.locate(g),d=gantt.getTask(c);return gantt._is_readonly(d)?!1:(a.config.initial_open_state=d.$open,this.callEvent("onRowDragStart",[c,g.target||g.srcElement,g])?void 0:!1)},this)),a.attachEvent("onAfterDragStart",this.bind(function(d,f){var b=this._locateHTML(f);a.config.marker.innerHTML=b.outerHTML,a.config.id=this.locate(f);var c=this.getTask(a.config.id);a.config.index=this.getTaskIndex(a.config.id),a.config.parent=c.parent,c.$open=!1,c.$transparent=!0,this.refreshData()},this)),a.lastTaskOfLevel=function(d){for(var g=gantt._order,h=gantt._pull,b=null,c=0,f=g.length;f>c;c++){h[g[c]].$level==d&&(b=h[g[c]])}return b?b.id:null},a._getGridPos=this.bind(function(c){var d=this._get_position(this.$grid_data),f=d.x,b=c.pos.y-10;return b<d.y&&(b=d.y),b>d.y+this.$grid_data.offsetHeight-this.config.row_height&&(b=d.y+this.$grid_data.offsetHeight-this.config.row_height),d.x=f,d.y=b,d},this),a.attachEvent("onDragMove",this.bind(function(z,m){function C(c,d){return c.$level==d.$level||gantt.config.order_branch_free}var t=a.config,G=a._getGridPos(m);t.marker.style.left=G.x+10+"px",t.marker.style.top=G.y+"px",G=a._getGridPos(m);var b=(G.x,G.y),k=document.documentElement.scrollTop||document.body.scrollTop,E=document.documentElement.scrollLeft||document.body.scrollLeft,A=document.elementFromPoint(G.x-E+1,b-k),q=this.locate(A),x=this.getTask(a.config.id);if(this.isTaskExists(q)||(q=a.lastTaskOfLevel(gantt.config.order_branch_free?x.$level:0),q==a.config.id&&(q=null)),this.isTaskExists(q)){var w=gantt._get_position(A),B=this.getTask(q);if(w.y+A.offsetHeight/2<b){var F=this.getGlobalTaskIndex(B.id),y=this._pull[this._order[F+1]];if(y){if(y.id==x.id){return}B=y}else{if(y=this._pull[this._order[F]],C(y,x)&&y.id!=x.id){return void this.moveTask(x.id,-1,this.getParent(y.id))}}}for(var F=this.getGlobalTaskIndex(B.id),j=this._pull[this._order[F-1]],D=1;(!j||j.id==B.id)&&F-D>=0;){j=this._pull[this._order[F-D]],D++}if(x.id==B.id){return}C(B,x)&&x.id!=B.id?this.moveTask(x.id,0,0,B.id):B.$level!=x.$level-1||gantt.getChildren(B.id).length?j&&C(j,x)&&x.id!=j.id&&this.moveTask(x.id,-1,this.getParent(j.id)):this.moveTask(x.id,0,B.id)}return !0},this)),a.attachEvent("onDragEnd",this.bind(function(){var b=this.getTask(a.config.id);this.callEvent("onBeforeRowDragEnd",[a.config.id,a.config.parent,a.config.index])===!1?(this.moveTask(a.config.id,a.config.index,a.config.parent),b.$drop_target=null):this.callEvent("onRowDragEnd",[a.config.id,b.$drop_target]),b.$transparent=!1,b.$open=a.config.initial_open_state,this.refreshData()},this))},gantt.getGridColumns=function(){return this.config.columns},gantt._has_children=function(a){return this.getChildren(a).length>0},gantt._scale_helpers={getSum:function(d,f,g){void 0===g&&(g=d.length-1),void 0===f&&(f=0);for(var b=0,c=f;g>=c;c++){b+=d[c]}return b},setSumWidth:function(d,h,k,b){var c=h.width;void 0===b&&(b=c.length-1),void 0===k&&(k=0);var f=b-k+1;if(!(k>c.length-1||0>=f||b>c.length-1)){var g=this.getSum(c,k,b),j=d-g;this.adjustSize(j,c,k,b),this.adjustSize(-j,c,b+1),h.full_width=this.getSum(c)}},splitSize:function(c,d){for(var f=[],b=0;d>b;b++){f[b]=0}return this.adjustSize(c,f),f},adjustSize:function(k,g,d,h){d||(d=0),void 0===h&&(h=g.length-1);for(var f=h-d+1,l=this.getSum(g,d,h),b=0,c=d;h>=c;c++){var j=Math.floor(k*(l?g[c]/l:1/f));l-=g[c],k-=j,f--,g[c]+=j,b+=j}g[g.length-1]+=k},sortScales:function(a){function b(c,d){var f=new Date(1970,0,1);return gantt.date.add(f,d,c)-f}a.sort(function(c,d){return b(c.unit,c.step)<b(d.unit,d.step)?1:b(c.unit,c.step)>b(d.unit,d.step)?-1:0})},primaryScale:function(){return gantt._init_template("date_scale"),{unit:gantt.config.scale_unit,step:gantt.config.step,template:gantt.templates.date_scale,date:gantt.config.date_scale,css:gantt.templates.scale_cell_class}},prepareConfigs:function(m,h,f,k){for(var g=this.splitSize(k,m.length),p=f,b=[],c=m.length-1;c>=0;c--){var l=c==m.length-1,j=this.initScaleConfig(m[c]);l&&this.processIgnores(j),this.initColSizes(j,h,p,g[c]),this.limitVisibleRange(j),l&&(p=j.full_width),b.unshift(j)}for(var c=0;c<b.length-1;c++){this.alineScaleColumns(b[b.length-1],b[c])}for(var c=0;c<b.length;c++){this.setPosSettings(b[c])}return b},setPosSettings:function(a){for(var b=0,c=a.trace_x.length;c>b;b++){a.left.push((a.width[b-1]||0)+(a.left[b-1]||0))}},_ignore_time_config:function(a){return this.config.skip_off_time?!this.isWorkTime(a):!1},processIgnores:function(a){a.ignore_x={},a.display_count=a.count},initColSizes:function(d,h,k,b){var c=k;d.height=b;var f=void 0===d.display_count?d.count:d.display_count;f||(f=1),d.col_width=Math.floor(c/f),h&&d.col_width<h&&(d.col_width=h,c=d.col_width*f),d.width=[];for(var g=d.ignore_x||{},j=0;j<d.trace_x.length;j++){g[d.trace_x[j].valueOf()]||d.display_count==d.count?d.width[j]=0:d.width[j]=1}this.adjustSize(c-this.getSum(d.width),d.width),d.full_width=this.getSum(d.width)},initScaleConfig:function(a){var b=gantt.mixin({count:0,col_width:0,full_width:0,height:0,width:[],left:[],trace_x:[]},a);return this.eachColumn(a.unit,a.step,function(c){b.count++,b.trace_x.push(new Date(c))}),b},iterateScales:function(v,m,f,q,j){for(var w=m.trace_x,b=v.trace_x,c=f||0,u=q||b.length-1,p=0,h=1;h<w.length;h++){for(var k=c;u>=k;k++){+b[k]!=+w[h]||(j&&j.apply(this,[p,h,c,k]),c=k,p=h)}}},alineScaleColumns:function(c,d,f,b){this.iterateScales(c,d,f,b,function(l,e,g,h){var j=this.getSum(c.width,g,h-1),k=this.getSum(d.width,l,e-1);k!=j&&this.setSumWidth(j,d,l,e-1)})},eachColumn:function(d,h,j){var b=new Date(gantt._min_date),c=new Date(gantt._max_date);gantt.date[d+"_start"]&&(b=gantt.date[d+"_start"](b));var f=new Date(b);for(+f>=+c&&(c=gantt.date.add(f,h,d));+c>+f;){j.call(this,new Date(f));var g=f.getTimezoneOffset();f=gantt.date.add(f,h,d),f=gantt._correct_dst_change(f,g,h,d),gantt.date[d+"_start"]&&(f=gantt.date[d+"_start"](f))}},limitVisibleRange:function(x){var q=x.trace_x,f=0,v=x.width.length-1,k=0;if(+q[0]<+gantt._min_date&&f!=v){var y=Math.floor(x.width[0]*((q[1]-gantt._min_date)/(q[1]-q[0])));k+=x.width[0]-y,x.width[0]=y,q[0]=new Date(gantt._min_date)}var b=q.length-1,c=q[b],w=gantt.date.add(c,x.step,x.unit);if(+w>+gantt._max_date&&b>0){var y=x.width[b]-Math.floor(x.width[b]*((w-gantt._max_date)/(w-c)));k+=x.width[b]-y,x.width[b]=y}if(k){for(var u=this.getSum(x.width),j=0,p=0;p<x.width.length;p++){var m=Math.floor(k*(x.width[p]/u));x.width[p]+=m,j+=m}this.adjustSize(k-j,x.width)}}},gantt._tasks_dnd={drag:null,_events:{before_start:{},before_finish:{},after_finish:{}},_handlers:{},init:function(){this.clear_drag_state();var c=gantt.config.drag_mode;this.set_actions();var d={before_start:"onBeforeTaskDrag",before_finish:"onBeforeTaskChanged",after_finish:"onAfterTaskDrag"};for(var f in this._events){for(var b in c){this._events[f][b]=d[f]}}this._handlers[c.move]=this._move,this._handlers[c.resize]=this._resize,this._handlers[c.progress]=this._resize_progress},set_actions:function(){var a=gantt.$task_data;gantt.event(a,"mousemove",gantt.bind(function(b){this.on_mouse_move(b||event)},this)),gantt.event(a,"mousedown",gantt.bind(function(b){this.on_mouse_down(b||event)},this)),gantt.event(a,"mouseup",gantt.bind(function(b){this.on_mouse_up(b||event)},this))},clear_drag_state:function(){this.drag={id:null,mode:null,pos:null,start_x:null,start_y:null,obj:null,left:null}},_resize:function(d,f,g){var b=gantt.config,c=this._drag_task_coords(d,g);g.left?(d.start_date=gantt.dateFromPos(c.start+f),d.start_date||(d.start_date=new Date(gantt.getState().min_date))):(d.end_date=gantt.dateFromPos(c.end+f),d.end_date||(d.end_date=new Date(gantt.getState().max_date))),d.end_date-d.start_date<b.min_duration&&(g.left?d.start_date=gantt.calculateEndDate(d.end_date,-1):d.end_date=gantt.calculateEndDate(d.start_date,1)),gantt._init_task_timing(d)},_resize_progress:function(d,f,g){var b=this._drag_task_coords(d,g),c=Math.max(0,g.pos.x-b.start);d.progress=Math.min(1,c/(b.end-b.start))},_move:function(d,g,h){var b=this._drag_task_coords(d,h),c=gantt.dateFromPos(b.start+g),f=gantt.dateFromPos(b.end+g);c?f?(d.start_date=c,d.end_date=f):(d.end_date=new Date(gantt.getState().max_date),d.start_date=gantt.dateFromPos(gantt.posFromDate(d.end_date)-(b.end-b.start))):(d.start_date=new Date(gantt.getState().min_date),d.end_date=gantt.dateFromPos(gantt.posFromDate(d.start_date)+(b.end-b.start)))},_drag_task_coords:function(c,d){var f=d.obj_s_x=d.obj_s_x||gantt.posFromDate(c.start_date),b=d.obj_e_x=d.obj_e_x||gantt.posFromDate(c.end_date);return{start:f,end:b}},on_mouse_move:function(a){this.drag.start_drag&&this._start_dnd(a);var b=this.drag;if(b.mode){if(!gantt._checkTimeout(this,40)){return}this._update_on_move(a)}},_update_on_move:function(d){var h=this.drag;if(h.mode){var k=gantt._get_mouse_pos(d);if(h.pos&&h.pos.x==k.x){return}h.pos=k;var b=gantt.dateFromPos(k.x);if(!b||isNaN(b.getTime())){return}var c=k.x-h.start_x,f=gantt.getTask(h.id);if(this._handlers[h.mode]){var g=gantt.mixin({},f),j=gantt.mixin({},f);this._handlers[h.mode].apply(this,[j,c,h]),gantt.mixin(f,j,!0),gantt.callEvent("onTaskDrag",[f.id,h.mode,j,g,d]),gantt.mixin(f,j,!0),gantt._update_parents(h.id),gantt.refreshTask(h.id)}}},on_mouse_down:function(d,h){if(2!=d.button){var j=gantt.locate(d),b=null;if(gantt.isTaskExists(j)&&(b=gantt.getTask(j)),!gantt._is_readonly(b)&&!this.drag.mode){this.clear_drag_state(),h=h||d.target||d.srcElement;var c=gantt._getClassName(h);if(!c||!this._get_drag_mode(c)){return h.parentNode?this.on_mouse_down(d,h.parentNode):void 0}var f=this._get_drag_mode(c);if(f){if(f.mode&&f.mode!=gantt.config.drag_mode.ignore&&gantt.config["drag_"+f.mode]){if(j=gantt.locate(h),b=gantt.copy(gantt.getTask(j)||{}),gantt._is_readonly(b)){return this.clear_drag_state(),!1}if(gantt._is_flex_task(b)&&f.mode!=gantt.config.drag_mode.progress){return void this.clear_drag_state()}f.id=j;var g=gantt._get_mouse_pos(d);f.start_x=g.x,f.start_y=g.y,f.obj=b,this.drag.start_drag=f}else{this.clear_drag_state()}}else{if(gantt.checkEvent("onMouseDown")&&gantt.callEvent("onMouseDown",[c.split(" ")[0]])&&h.parentNode){return this.on_mouse_down(d,h.parentNode)}}}}},_fix_dnd_scale_time:function(d,g){function h(a){gantt.isWorkTime(a.start_date)||(a.start_date=gantt.calculateEndDate(a.start_date,-1,gantt.config.duration_unit))}function b(a){gantt.isWorkTime(new Date(a.end_date-1))||(a.end_date=gantt.calculateEndDate(a.end_date,1,gantt.config.duration_unit))}var c=gantt._tasks.unit,f=gantt._tasks.step;gantt.config.round_dnd_dates||(c="minute",f=gantt.config.time_step),g.mode==gantt.config.drag_mode.resize?g.left?(d.start_date=gantt.roundDate({date:d.start_date,unit:c,step:f}),h(d)):(d.end_date=gantt.roundDate({date:d.end_date,unit:c,step:f}),b(d)):g.mode==gantt.config.drag_mode.move&&(d.start_date=gantt.roundDate({date:d.start_date,unit:c,step:f}),h(d),d.end_date=gantt.calculateEndDate(d.start_date,d.duration,gantt.config.duration_unit))},_fix_working_times:function(a,b){var b=b||{mode:gantt.config.drag_mode.move};gantt.config.work_time&&gantt.config.correct_work_time&&(b.mode==gantt.config.drag_mode.resize?b.left?a.start_date=gantt.getClosestWorkTime({date:a.start_date,dir:"future"}):a.end_date=gantt.getClosestWorkTime({date:a.end_date,dir:"past"}):b.mode==gantt.config.drag_mode.move&&gantt.correctTaskWorkTime(a))},on_mouse_up:function(c){var d=this.drag;if(d.mode&&d.id){var f=gantt.getTask(d.id);if(gantt.config.work_time&&gantt.config.correct_work_time&&this._fix_working_times(f,d),this._fix_dnd_scale_time(f,d),gantt._init_task_timing(f),this._fireEvent("before_finish",d.mode,[d.id,d.mode,gantt.copy(d.obj),c])){var b=d.id;gantt._init_task_timing(f),this.clear_drag_state(),gantt.updateTask(f.id),this._fireEvent("after_finish",d.mode,[b,d.mode,c])}else{d.obj._dhx_changed=!1,gantt.mixin(f,d.obj,!0),gantt.updateTask(f.id)}}this.clear_drag_state()},_get_drag_mode:function(d){var f=gantt.config.drag_mode,g=(d||"").split(" "),b=g[0],c={mode:null,left:null};switch(b){case"gantt_task_line":case"gantt_task_content":c.mode=f.move;break;case"gantt_task_drag":c.mode=f.resize,g[1]&&-1!==g[1].indexOf("left",g[1].length-"left".length)?c.left=!0:c.left=!1;break;case"gantt_task_progress_drag":c.mode=f.progress;break;case"gantt_link_control":case"gantt_link_point":c.mode=f.ignore;break;default:c=null}return c},_start_dnd:function(c){var d=this.drag=this.drag.start_drag;delete d.start_drag;var f=gantt.config,b=d.id;f["drag_"+d.mode]&&gantt.callEvent("onBeforeDrag",[b,d.mode,c])&&this._fireEvent("before_start",d.mode,[b,d.mode,c])?(delete d.start_drag,gantt.callEvent("onTaskDragStart",[])):this.clear_drag_state()},_fireEvent:function(c,d,f){gantt.assert(this._events[c],"Invalid stage:{"+c+"}");var b=this._events[c][d];return gantt.assert(b,"Unknown after drop mode:{"+d+"}"),gantt.assert(f,"Invalid event arguments"),gantt.checkEvent(b)?gantt.callEvent(b,f):!0}},gantt.roundTaskDates=function(a){var b=gantt._tasks_dnd.drag;b||(b={mode:gantt.config.drag_mode.move}),gantt._tasks_dnd._fix_dnd_scale_time(a,b)},gantt._render_link=function(c){for(var d=this.getLink(c),f=gantt._get_link_renderers(),b=0;b<f.length;b++){f[b].render_item(d)}},gantt._get_link_type=function(a,b){var c=null;return a&&b?c=gantt.config.links.start_to_start:!a&&b?c=gantt.config.links.finish_to_start:a||b?a&&!b&&(c=gantt.config.links.start_to_finish):c=gantt.config.links.finish_to_finish,c},gantt.isLinkAllowed=function(d,g,h,b){var c=null;if(c="object"==typeof d?d:{source:d,target:g,type:this._get_link_type(h,b)},!c){return !1}if(!(c.source&&c.target&&c.type)){return !1}if(c.source==c.target){return !1}var f=!0;return this.checkEvent("onLinkValidation")&&(f=this.callEvent("onLinkValidation",[c])),f},gantt._render_link_element=function(q){var j=this._path_builder.get_points(q),f=gantt._drawer,m=f.get_lines(j),h=document.createElement("div"),u="gantt_task_link";q.color&&(u+=" gantt_link_inline_color");var b=this.templates.link_class?this.templates.link_class(q):"";b&&(u+=" "+b),this.config.highlight_critical_path&&this.isCriticalLink&&this.isCriticalLink(q)&&(u+=" gantt_critical_link"),h.className=u,h.setAttribute(gantt.config.link_attribute,q.id);for(var c=0;c<m.length;c++){c==m.length-1&&(m[c].size-=gantt.config.link_arrow_size);m[c].type=q.type;var p=f.render_line(m[c],m[c+1]);q.color&&(p.firstChild.style.backgroundColor=q.color),h.appendChild(p)}var k=m[m.length-1].direction,g=gantt._render_link_arrow(j[j.length-1],k,q.type);return q.color&&(g.style.borderColor=q.color),h.appendChild(g),h},gantt._render_link_arrow=function(m,h,j){var d=document.createElement("div"),k=gantt._drawer,g=m.y,p=m.x,b=gantt.config.link_arrow_size,c=gantt.config.row_height,l="gantt_link_arrow gantt_link_arrow_"+h;var f="";if(j=="0"){f="border-color: #0046c6;"}switch(h){case k.dirs.right:g-=(b-c)/2,p-=b;break;case k.dirs.left:g-=(b-c)/2;break;case k.dirs.up:p-=b;break;case k.dirs.down:g+=2*b,p-=b}return d.style.cssText=["top:"+g+"px","left:"+p+"px",f].join(";"),d.className=l,d},gantt._drawer={current_pos:null,dirs:{left:"left",right:"right",up:"up",down:"down"},path:[],clear:function(){this.current_pos=null,this.path=[]},point:function(a){this.current_pos=gantt.copy(a)},get_lines:function(a){this.clear(),this.point(a[0]);for(var b=1;b<a.length;b++){this.line_to(a[b])}return this.get_path()},line_to:function(c){var d=gantt.copy(c),f=this.current_pos,b=this._get_line(f,d);this.path.push(b),this.current_pos=d},get_path:function(){return this.path},get_wrapper_sizes:function(c){var d,f=gantt.config.link_wrapper_width,b=(gantt.config.link_line_width,c.y+(gantt.config.row_height-f)/2);switch(c.direction){case this.dirs.left:d={top:b,height:f,lineHeight:f,left:c.x-c.size-f/2,width:c.size+f};break;case this.dirs.right:d={top:b,lineHeight:f,height:f,left:c.x-f/2,width:c.size+f};break;case this.dirs.up:d={top:b-c.size,lineHeight:c.size+f,height:c.size+f,left:c.x-f/2,width:f};break;case this.dirs.down:d={top:b,lineHeight:c.size+f,height:c.size+f,left:c.x-f/2,width:f}}return d},get_line_sizes:function(d){var f,g=gantt.config.link_line_width,b=gantt.config.link_wrapper_width,c=d.size+g;switch(d.direction){case this.dirs.left:case this.dirs.right:f={height:g,width:c,marginTop:(b-g)/2,marginLeft:(b-g)/2};break;case this.dirs.up:case this.dirs.down:f={height:c,width:g,marginTop:(b-g)/2,marginLeft:(b-g)/2}}return f},render_line:function(d){var g=this.get_wrapper_sizes(d),h=document.createElement("div");h.style.cssText=["top:"+g.top+"px","left:"+g.left+"px","height:"+g.height+"px","width:"+g.width+"px"].join(";"),h.className="gantt_line_wrapper";var f="";if(d.type=="0"){f="background-color: #0046c6;"}var b=this.get_line_sizes(d),c=document.createElement("div");return c.style.cssText=["height:"+b.height+"px","width:"+b.width+"px","margin-top:"+b.marginTop+"px","margin-left:"+b.marginLeft+"px",f].join(";"),c.className="gantt_link_line_"+d.direction,h.appendChild(c),h},_get_line:function(c,d){var f=this.get_direction(c,d),b={x:c.x,y:c.y,direction:this.get_direction(c,d)};return f==this.dirs.left||f==this.dirs.right?b.size=Math.abs(c.x-d.x):b.size=Math.abs(c.y-d.y),b},get_direction:function(a,b){var c=0;return c=b.x<a.x?this.dirs.left:b.x>a.x?this.dirs.right:b.y>a.y?this.dirs.down:this.dirs.up}},gantt._y_from_ind=function(a){return a*gantt.config.row_height},gantt._path_builder={path:[],clear:function(){this.path=[]},current:function(){return this.path[this.path.length-1]},point:function(a){return a?(this.path.push(gantt.copy(a)),a):this.current()},point_to:function(c,d,f){f=f?{x:f.x,y:f.y}:gantt.copy(this.point());var b=gantt._drawer.dirs;switch(c){case b.left:f.x-=d;break;case b.right:f.x+=d;break;case b.up:f.y-=d;break;case b.down:f.y+=d}return this.point(f)},get_points:function(k){var g=this.get_endpoint(k),d=gantt.config,h=g.e_y-g.y,f=g.e_x-g.x,l=gantt._drawer.dirs;this.clear(),this.point({x:g.x,y:g.y});var b=2*d.link_arrow_size,c=g.e_x>g.x;if(k.type==gantt.config.links.start_to_start){this.point_to(l.left,b),c?(this.point_to(l.down,h),this.point_to(l.right,f)):(this.point_to(l.right,f),this.point_to(l.down,h)),this.point_to(l.right,b)}else{if(k.type==gantt.config.links.finish_to_start){if(c=g.e_x>g.x+2*b,this.point_to(l.right,b),c){f-=b,this.point_to(l.down,h),this.point_to(l.right,f)}else{f-=2*b;var j=h>0?1:-1;this.point_to(l.down,j*(d.row_height/2)),this.point_to(l.right,f),this.point_to(l.down,j*(Math.abs(h)-d.row_height/2)),this.point_to(l.right,b)}}else{if(k.type==gantt.config.links.finish_to_finish){this.point_to(l.right,b),c?(this.point_to(l.right,f),this.point_to(l.down,h)):(this.point_to(l.down,h),this.point_to(l.right,f)),this.point_to(l.left,b)}else{if(k.type==gantt.config.links.start_to_finish){if(c=g.e_x>g.x-2*b,this.point_to(l.left,b),c){f+=2*b;var j=h>0?1:-1;this.point_to(l.down,j*(d.row_height/2)),this.point_to(l.right,f),this.point_to(l.down,j*(Math.abs(h)-d.row_height/2)),this.point_to(l.left,b)}else{f+=b,this.point_to(l.down,h),this.point_to(l.right,f)}}}}}return this.path},get_endpoint:function(d){var g=gantt.config.links,h=!1,b=!1;d.type==g.start_to_start?h=b=!0:d.type==g.finish_to_finish?h=b=!1:d.type==g.finish_to_start?(h=!1,b=!0):d.type==g.start_to_finish?(h=!0,b=!1):gantt.assert(!1,"Invalid link type");var c=gantt._get_task_visible_pos(gantt._pull[d.source],h),f=gantt._get_task_visible_pos(gantt._pull[d.target],b);return{x:c.x,e_x:f.x,y:c.y,e_y:f.y}}},gantt._init_links_dnd=function(){function B(d,g,h){var c=gantt._get_task_pos(d,!!g);return c.y+=gantt._get_task_height()/2,h=h||0,c.x+=(g?-1:1)*h,c}function v(c){var g=y(),h=["gantt_link_tooltip"];g.from&&g.to&&(gantt.isLinkAllowed(g.from,g.to,g.from_start,g.to_start)?h.push("gantt_allowed_link"):h.push("gantt_invalid_link"));var a=gantt.templates.drag_link_class(g.from,g.from_start,g.to,g.to_start);a&&h.push(a);var d="<div class='"+a+"'>"+gantt.templates.drag_link(g.from,g.from_start,g.to,g.to_start)+"</div>";c.innerHTML=d}function j(a,c){a.style.left=c.x+5+"px",a.style.top=c.y+5+"px"}function y(){return{from:gantt._link_source_task,to:gantt._link_target_task,from_start:gantt._link_source_task_start,to_start:gantt._link_target_task_start}}function m(){gantt._link_source_task=gantt._link_source_task_start=gantt._link_target_task=null,gantt._link_target_task_start=!0}function C(P,J,o,F){var Q=z(),K=y(),D=["gantt_link_direction"];gantt.templates.link_direction_class&&D.push(gantt.templates.link_direction_class(K.from,K.from_start,K.to,K.to_start));var H=Math.sqrt(Math.pow(o-P,2)+Math.pow(F-J,2));if(H=Math.max(0,H-3)){Q.className=D.join(" ");var G=(F-J)/(o-P),L=Math.atan(G);2==f(P,o,J,F)?L+=Math.PI:3==f(P,o,J,F)&&(L-=Math.PI);var O=Math.sin(L),I=Math.cos(L),a=Math.round(J),N=Math.round(P),r=["-webkit-transform: rotate("+L+"rad)","-moz-transform: rotate("+L+"rad)","-ms-transform: rotate("+L+"rad)","-o-transform: rotate("+L+"rad)","transform: rotate("+L+"rad)","width:"+Math.round(H)+"px"];if(-1!=window.navigator.userAgent.indexOf("MSIE 8.0")){r.push('-ms-filter: "'+b(O,I)+'"');var E=Math.abs(Math.round(P-o)),M=Math.abs(Math.round(F-J));switch(f(P,o,J,F)){case 1:a-=M;break;case 2:N-=E,a-=M;break;case 3:N-=E}}r.push("top:"+a+"px"),r.push("left:"+N+"px"),Q.style.cssText=r.join(";")}}function b(a,c){return"progid:DXImageTransform.Microsoft.Matrix(M11 = "+c+",M12 = -"+a+",M21 = "+a+",M22 = "+c+",SizingMethod = 'auto expand')"}function f(d,g,h,c){return g>=d?h>=c?1:4:h>=c?2:3}function z(){return k._direction||(k._direction=document.createElement("div"),gantt.$task_links.appendChild(k._direction)),k._direction}function w(){k._direction&&(k._direction.parentNode&&k._direction.parentNode.removeChild(k._direction),k._direction=null)}var k=new gantt._DnD(this.$task_bars,{sensitivity:0,updates_per_second:60}),q="task_left",p="task_right",x="gantt_link_point",A="gantt_link_control";k.attachEvent("onBeforeDragStart",gantt.bind(function(h,l){var c=l.target||l.srcElement;if(m(),gantt.getState().drag_id){return !1}if(gantt._locate_css(c,x)){gantt._locate_css(c,q)&&(gantt._link_source_task_start=!0);var d=gantt._link_source_task=this.locate(l),g=gantt.getTask(d);if(gantt._is_readonly(g)){return m(),!1}var i=0;return gantt._get_safe_type(g.type)==gantt.config.types.milestone&&(i=(gantt._get_visible_milestone_width()-gantt._get_milestone_width())/2),this._dir_start=B(g,!!gantt._link_source_task_start,i),!0}return !1},this)),k.attachEvent("onAfterDragStart",gantt.bind(function(a,c){v(k.config.marker)},this)),k.attachEvent("onDragMove",gantt.bind(function(H,t){var e=k.config,l=k.getPosition(t);j(e.marker,l);var J=gantt._is_link_drop_area(t),E=gantt._link_target_task,u=gantt._link_landing,F=gantt._link_target_task_start,D=gantt.locate(t),h=!0;if(J&&(h=!gantt._locate_css(t,p),J=!!D),gantt._link_target_task=D,gantt._link_landing=J,gantt._link_target_task_start=h,J){var I=gantt.getTask(D),n=gantt._locate_css(t,A),s=0;n&&(s=Math.floor(n.offsetWidth/2)),this._dir_end=B(I,!!gantt._link_target_task_start,s)}else{this._dir_end=gantt._get_mouse_pos(t)}var G=!(u==J&&E==D&&F==h);return G&&(E&&gantt.refreshTask(E,!1),D&&gantt.refreshTask(D,!1)),G&&v(e.marker),C(this._dir_start.x,this._dir_start.y,this._dir_end.x,this._dir_end.y),!0},this)),k.attachEvent("onDragEnd",gantt.bind(function(){var a=y();if(a.from&&a.to&&a.from!=a.to){var c=gantt._get_link_type(a.from_start,a.to_start),d={source:a.from,target:a.to,type:c};d.type&&gantt.isLinkAllowed(d)&&gantt.addLink(d)}m(),a.from&&gantt.refreshTask(a.from,!1),a.to&&gantt.refreshTask(a.to,!1),w()},this)),gantt._is_link_drop_area=function(a){return !!gantt._locate_css(a,A)}},gantt._get_link_state=function(){return{link_landing_area:this._link_landing,link_target_id:this._link_target_task,link_target_start:this._link_target_task_start,link_source_id:this._link_source_task,link_source_start:this._link_source_task_start}},gantt._task_renderer=function(c,d,f,b){return this._task_area_pulls||(this._task_area_pulls={}),this._task_area_renderers||(this._task_area_renderers={}),this._task_area_renderers[c]?this._task_area_renderers[c]:(d||this.assert(!1,"Invalid renderer call"),f&&f.setAttribute(this.config.layer_attribute,!0),this._task_area_renderers[c]={render_item:function(e,a){if(a=a||f,b&&!b(e)){return void this.remove_item(e.id)}var g=d.call(gantt,e);this.append(e,g,a)},clear:function(a){this.rendered=gantt._task_area_pulls[c]={},this.clear_container(a)},clear_container:function(a){a=a||f,a&&(a.innerHTML="")},render_items:function(j,l){l=l||f;var g=document.createDocumentFragment();this.clear(l);if(l.getAttribute("class")=="gantt_grid_data"){gantt.config.projectHasChild=Boolean(j.length!=1)}for(var h=0,k=j.length;k>h;h++){this.render_item(j[h],g)}l.appendChild(g)},append:function(a,g,h){g&&(this.rendered[a.id]&&this.rendered[a.id].parentNode?this.replace_item(a.id,g):h.appendChild(g),this.rendered[a.id]=g)},replace_item:function(a,g){var h=this.rendered[a];h&&h.parentNode&&h.parentNode.replaceChild(g,h),this.rendered[a]=g},remove_item:function(a){this.hide(a),delete this.rendered[a]},hide:function(a){var g=this.rendered[a];g&&g.parentNode&&g.parentNode.removeChild(g)},restore:function(a){var g=this.rendered[a.id];g?g.parentNode||this.append(a,g,f):this.render_item(a,f)},change_id:function(a,g){this.rendered[g]=this.rendered[a],delete this.rendered[a]},rendered:this._task_area_pulls[c],node:f,unload:function(){this.clear(),delete gantt._task_area_renderers[c],delete gantt._task_area_pulls[c]}},this._task_area_renderers[c])},gantt._clear_renderers=function(){for(var a in this._task_area_renderers){this._task_renderer(a).unload()}},gantt._is_layer=function(a){return a&&a.hasAttribute&&a.hasAttribute(this.config.layer_attribute)},gantt._init_tasks=function(){function a(g,h,j,d){for(var f=0;f<g.length;f++){g[f].change_id(h,j),g[f].render_item(d)}}this._tasks={col_width:this.config.columnWidth,width:[],full_width:0,trace_x:[],rendered:{}},this._click.gantt_task_link=this.bind(function(d,f){var g=this.locate(d,gantt.config.link_attribute);g&&this.callEvent("onLinkClick",[g,d])},this),this._click.gantt_scale_cell=this.bind(function(g,j){var k=gantt._get_mouse_pos(g),d=gantt.dateFromPos(k.x),f=Math.floor(gantt._day_index_by_date(d)),h=gantt._tasks.trace_x[f];gantt.callEvent("onScaleClick",[g,h])},this),this._dbl_click.gantt_task_link=this.bind(function(d,f,g){var f=this.locate(d,gantt.config.link_attribute);this._delete_link_handler(f,d)},this),this._dbl_click.gantt_link_point=this.bind(function(g,h,j){var h=this.locate(g),d=this.getTask(h),f=null;return j.parentNode&&gantt._getClassName(j.parentNode)&&(f=gantt._getClassName(j.parentNode).indexOf("_left")>-1?d.$target[0]:d.$source[0]),f&&this._delete_link_handler(f,g),!1},this),this._tasks_dnd.init(),this._init_links_dnd(),this._link_layers.clear();var b=this.addLinkLayer({renderer:this._render_link_element,container:this.$task_links,filter:gantt._create_filter([gantt._filter_link,gantt._is_chart_visible].concat(this._get_link_filters()))});this._linkRenderer=this._link_layers.getRenderer(b),this._task_layers.clear();var c=this.addTaskLayer({renderer:this._render_task_element,container:this.$task_bars,filter:gantt._create_filter([gantt._filter_task,gantt._is_chart_visible].concat(this._get_task_filters()))});this._taskRenderer=this._task_layers.getRenderer(c),this.addTaskLayer({renderer:this._render_grid_item,container:this.$grid_data,filter:gantt._create_filter([gantt._filter_task,gantt._is_grid_visible].concat(this._get_task_filters()))}),this.addTaskLayer({renderer:this._render_bg_line,container:this.$task_bg,filter:gantt._create_filter([gantt._filter_task,gantt._is_chart_visible,gantt._is_std_background].concat(this._get_task_filters()))}),this._onTaskIdChange&&this.detachEvent(this._onTaskIdChange),this._onTaskIdChange=this.attachEvent("onTaskIdChange",function(f,g){var d=this._get_task_renderers();a(d,f,g,this.getTask(g))}),this._onLinkIdChange&&this.detachEvent(this._onLinkIdChange),this._onLinkIdChange=this.attachEvent("onLinkIdChange",function(f,g){var d=this._get_link_renderers();a(d,f,g,this.getLink(g))})},gantt._get_task_filters=function(){return[]},gantt._get_link_filters=function(){return[]},gantt._is_chart_visible=function(){return !!this.config.show_chart},gantt._filter_task=function(c,d){var f=null,b=null;return this.config.start_date&&this.config.end_date&&(f=this.config.start_date.valueOf(),b=this.config.end_date.valueOf(),+d.start_date>b||+d.end_date<+f)?!1:!0},gantt._filter_link=function(a,b){return this.config.show_links?!gantt.isTaskVisible(b.source)||!gantt.isTaskVisible(b.target)||gantt._isAllowedUnscheduledTask(gantt.getTask(b.source))||gantt._isAllowedUnscheduledTask(gantt.getTask(b.target))?!1:this.callEvent("onBeforeLinkDisplay",[a,b]):!1},gantt._is_std_background=function(){return !this.config.static_background},gantt._delete_link_handler=function(d,f){if(d&&this.callEvent("onLinkDblClick",[d,f])){var g=gantt.getLink(d);if(gantt._is_readonly(g)){return}var b="",c=gantt.locale.labels.link+" "+this.templates.link_description(this.getLink(d))+" "+gantt.locale.labels.confirm_link_deleting;window.setTimeout(function(){gantt._dhtmlx_confirm(c,b,function(){gantt.deleteLink(d)})},gantt.config.touch?300:1)}},gantt.getTaskNode=function(a){return this._taskRenderer.rendered[a]},gantt.getLinkNode=function(a){return this._linkRenderer.rendered[a]},gantt._get_tasks_data=function(){for(var c=[],d=this._get_data_range(),f=0;f<d.length;f++){var b=this._pull[d[f]];b.$index=f,this.resetProjectDates(b),c.push(b)}return c},gantt._get_data_range=function(){return this._order},gantt._get_links_data=function(){return this._links.slice()},gantt._render_data=function(){if(this.callEvent("onBeforeDataRender",[]),this._is_render_active()){this._order_synced?this._order_synced=!1:this._sync_order(),this._update_layout_sizes(),this._scroll_resize();for(var c=this._get_tasks_data(),d=this._get_task_renderers(),f=0;f<d.length;f++){d[f].render_items(c)}var b=gantt._get_links_data();d=this._get_link_renderers();for(var f=0;f<d.length;f++){d[f].render_items(b)}this.callEvent("onDataRender",[])}},gantt._update_layout_sizes=function(){var d=this._tasks;d.bar_height=this._get_task_height(),this.$task_data.style.height=Math.max(this.$task.offsetHeight-this.config.scale_height,0)+"px",gantt.config.smart_rendering?this.$task_bg.style.height=gantt.config.row_height*this.getVisibleTaskCount()+"px":this.$task_bg.style.height="",this.$task_bg.style.backgroundImage="";for(var h=this.$task_data.childNodes,j=0,b=h.length;b>j;j++){var c=h[j];this._is_layer(c)&&c.style&&(c.style.width=d.full_width+"px")}if(this._is_grid_visible()){for(var f=this.getGridColumns(),g=0,j=0;j<f.length;j++){g+=f[j].width}this.$grid_data.style.width=Math.max(g-1,0)+"px"}},gantt._scale_range_unit=function(){var a=this.config.scale_unit;if(this.config.scale_offset_minimal){var b=this._get_scales();a=b[b.length-1].unit}return a},gantt._init_tasks_range=function(){var c=this._scale_range_unit();if(this.config.start_date&&this.config.end_date){this._min_date=this.date[c+"_start"](new Date(this.config.start_date));var d=new Date(this.config.end_date),f=this.date[c+"_start"](new Date(d));return d=+d!=+f?this.date.add(f,1,c):f,void (this._max_date=d)}this._get_tasks_data();var b=this.getSubtaskDates();this._min_date=b.start_date,this._max_date=b.end_date,this._max_date&&this._max_date||(this._min_date=new Date,this._max_date=new Date(this._min_date)),this._min_date=this.date[c+"_start"](this._min_date),this._min_date=this.calculateEndDate(this.date[c+"_start"](this._min_date),-1,c),this._max_date=this.date[c+"_start"](this._max_date),this._max_date=this.calculateEndDate(this._max_date,2,c)},gantt._prepare_scale_html=function(v){var m=[],f=null,q=null,j=null;(v.template||v.date)&&(q=v.template||this.date.date_to_str(v.date)),j=v.css||function(){},!v.css&&this.config.inherit_scale_class&&(j=gantt.templates.scale_cell_class);for(var w=0;w<v.count;w++){f=new Date(v.trace_x[w]);var b=q.call(this,f),c=v.width[w],u="",p="",h="";if(c){u="width:"+c+"px;",h="gantt_scale_cell"+(w==v.count-1?" gantt_last_cell":""),p=j.call(this,f),p&&(h+=" "+p);var k="<div class='"+h+"' style='"+u+"'>"+b+"</div>";m.push(k)}}return m.join("")},gantt._get_scales=function(){var a=this._scale_helpers,b=[a.primaryScale()].concat(this.config.subscales);return a.sortScales(b),b},gantt._render_tasks_scales=function(){this._init_tasks_range(),this._scroll_resize(),this._set_sizes();var B="",v=0,j=0,y=0;if(this._is_chart_visible()){var m=this._scale_helpers,C=this._get_scales();y=this.config.scale_height-1;for(var b=this._get_resize_options(),f=b.x?Math.max(this.config.autosize_min_width,0):this.$task.offsetWidth,z=m.prepareConfigs(C,this.config.min_column_width,f,y),w=this._tasks=z[z.length-1],k=[],q=this.templates.scale_row_class,p=0;p<z.length;p++){var x="gantt_scale_line",A=q(z[p]);A&&(x+=" "+A),k.push('<div class="'+x+'" style="height:'+z[p].height+"px;line-height:"+z[p].height+'px">'+this._prepare_scale_html(z[p])+"</div>")}B=k.join(""),v=w.full_width+this.$scroll_ver.offsetWidth+"px",j=w.full_width+"px",y+="px"}this._is_chart_visible()?this.$task.style.display="":this.$task.style.display="none",this.$task_scale.style.height=y,this.$task_data.style.width=this.$task_scale.style.width=v,this.$task_scale.innerHTML=B},gantt._render_bg_line=function(q){var j=gantt._tasks,f=j.count,m=document.createElement("div");if(gantt.config.show_task_cells){for(var h=0;f>h;h++){var u=j.width[h],b="";if(u>0){var c=document.createElement("div");c.style.width=u+"px",b="gantt_task_cell"+(h==f-1?" gantt_last_cell":""),k=this.templates.task_cell_class(q,j.trace_x[h]),k&&(b+=" "+k),c.className=b,m.appendChild(c)}}}var p=q.$index%2!==0,k=gantt.templates.task_row_class(q.start_date,q.end_date,q),g="gantt_task_row"+(p?" odd":"")+(k?" "+k:"");return this.getState().selected_task==q.id&&(g+=" gantt_selected"),m.className=g,gantt.config.smart_rendering&&(m.style.position="absolute",m.style.top=this.getTaskTop(q.id)+"px",m.style.width="100%"),m.style.height=gantt.config.row_height+"px",m.setAttribute(this.config.task_attribute,q.id),m},gantt._adjust_scales=function(){if(this.config.fit_tasks){var a=+this._min_date,b=+this._max_date;if(this._init_tasks_range(),+this._min_date!=a||+this._max_date!=b){return this.render(),this.callEvent("onScaleAdjusted",[]),!0}}return !1},gantt.refreshTask=function(d,f){if(this._is_render_active()){var g=this._get_task_renderers(),b=this.getTask(d);if(b&&this.isTaskVisible(d)){for(var c=0;c<g.length;c++){g[c].render_item(b)}if(void 0!==f&&!f){return}for(var c=0;c<b.$source.length;c++){gantt.refreshLink(b.$source[c])}for(var c=0;c<b.$target.length;c++){gantt.refreshLink(b.$target[c])}}}},gantt.refreshLink=function(a){if(this._is_render_active()){if(this.isLinkExists(a)){this._render_link(a)}else{for(var b=this._get_link_renderers(),c=0;c<b.length;c++){b[c].remove_item(a)}}}},gantt._combine_item_class=function(v,m,f){var q=[v];m&&q.push(m);var j=gantt.getState(),w=this.getTask(f);this._get_safe_type(w.type)==this.config.types.milestone&&q.push("gantt_milestone"),this._get_safe_type(w.type)==this.config.types.project&&q.push("gantt_project"),this._is_flex_task(w)&&q.push("gantt_dependent_task"),this.config.select_task&&f==j.selected_task&&q.push("gantt_selected"),f==j.drag_id&&(q.push("gantt_drag_"+j.drag_mode),j.touch_drag&&q.push("gantt_touch_"+j.drag_mode));var b=gantt._get_link_state();if(b.link_source_id==f&&q.push("gantt_link_source"),b.link_target_id==f&&q.push("gantt_link_target"),this.config.highlight_critical_path&&this.isCriticalTask&&this.isCriticalTask(w)&&q.push("gantt_critical_task"),b.link_landing_area&&b.link_target_id&&b.link_source_id&&b.link_target_id!=b.link_source_id){var c=b.link_source_id,u=b.link_source_start,p=b.link_target_start,h=gantt.isLinkAllowed(c,f,u,p),k="";k=h?p?"link_start_allow":"link_finish_allow":p?"link_start_deny":"link_finish_deny",q.push(k)}return q.join(" ")},gantt._render_pair=function(d,f,g,b){var c=gantt.getState();+g.end_date<=+c.max_date&&d.appendChild(b(f+" task_right")),+g.start_date>=+c.min_date&&d.appendChild(b(f+" task_left"))},gantt._get_task_height=function(){var a=this.config.task_height;return"full"==a&&(a=this.config.row_height-5),a=Math.min(a,this.config.row_height),Math.max(a,0)},gantt._get_milestone_width=function(){return this._get_task_height()},gantt._get_visible_milestone_width=function(){var a=gantt._get_task_height();return Math.sqrt(2*a*a)},gantt.getTaskPosition=function(d,h,j){var b=this.posFromDate(h||d.start_date),c=this.posFromDate(j||d.end_date);c=Math.max(b,c);var f=this.getTaskTop(d.id),g=gantt._get_task_height();return{left:b,top:f,height:g,width:Math.max(c-b,0)}},gantt._get_task_width=function(a,b,c){return Math.round(this._get_task_pos(a,!1).x-this._get_task_pos(a,!0).x)},gantt._is_readonly=function(a){return a&&a[this.config.editable_property]?!1:a&&a[this.config.readonly_property]||this.config.readonly},gantt._task_default_render=function(v){if(!this._isAllowedUnscheduledTask(v)){var m=this._get_task_pos(v),f=this.config,q=this._get_task_height(),j=Math.floor((this.config.row_height-q)/2);this._get_safe_type(v.type)==f.types.milestone&&f.link_line_width>1&&(j+=1);var w=document.createElement("div"),b=gantt._get_task_width(v),c=this._get_safe_type(v.type);w.setAttribute(this.config.task_attribute,v.id),f.show_progress&&c!=this.config.types.milestone&&this._render_task_progress(v,w,b);var u=gantt._render_task_content(v,b);v.textColor&&(u.style.color=v.textColor),w.appendChild(u);var p=this._combine_item_class("gantt_task_line",this.templates.task_class(v.start_date,v.end_date,v),v.id);(v.color||v.progressColor||v.textColor)&&(p+=" gantt_task_inline_color"),w.className=p;var h=["left:"+m.x+"px","top:"+(j+m.y)+"px","height:"+q+"px","line-height:"+q+"px","width:"+b+"px"];v.color&&h.push("background-color:"+v.color),v.textColor&&h.push("color:"+v.textColor),w.style.cssText=h.join(";");var k=this._render_leftside_content(v);return k&&w.appendChild(k),k=this._render_rightside_content(v),k&&w.appendChild(k),this._is_readonly(v)||(f.drag_resize&&!this._is_flex_task(v)&&c!=this.config.types.milestone&&gantt._render_pair(w,"gantt_task_drag",v,function(a){var d=document.createElement("div");return d.className=a,d}),f.drag_links&&this.config.show_links&&gantt._render_pair(w,"gantt_link_control",v,function(a){var d=document.createElement("div");d.className=a,d.style.cssText=["height:"+q+"px","line-height:"+q+"px"].join(";");var g=document.createElement("div");return g.className="gantt_link_point",d.appendChild(g),d})),w}},gantt._render_task_element=function(c){var d=this.config.type_renderers,f=d[this._get_safe_type(c.type)],b=this._task_default_render;return f||(f=b),f.call(this,c,this.bind(b,this))},gantt._render_side_content=function(d,f,g){if(!f){return null}var b=f(d.start_date,d.end_date,d);if(!b){return null}var c=document.createElement("div");return c.className="gantt_side_content "+g,c.innerHTML=b,c},gantt._render_leftside_content=function(a){var b="gantt_left "+gantt._get_link_crossing_css(!0,a);return gantt._render_side_content(a,this.templates.leftside_text,b)},gantt._render_rightside_content=function(a){var b="gantt_right "+gantt._get_link_crossing_css(!1,a);return gantt._render_side_content(a,this.templates.rightside_text,b)},gantt._get_conditions=function(a){return a?{$source:[gantt.config.links.start_to_start],$target:[gantt.config.links.start_to_start,gantt.config.links.finish_to_start]}:{$source:[gantt.config.links.finish_to_start,gantt.config.links.finish_to_finish],$target:[gantt.config.links.finish_to_finish]}},gantt._get_link_crossing_css=function(d,h){var k=gantt._get_conditions(d);for(var b in k){for(var c=h[b],f=0;f<c.length;f++){for(var g=gantt.getLink(c[f]),j=0;j<k[b].length;j++){if(g.type==k[b][j]){return"gantt_link_crossing"}}}}return""},gantt._render_task_content=function(a,b){var c=document.createElement("div");return this._get_safe_type(a.type)!=this.config.types.milestone&&(c.innerHTML=this.templates.task_text(a.start_date,a.end_date,a)),c.className="gantt_task_content",c},gantt._render_task_progress=function(d,h,j){var b=1*d.progress||0;j=Math.max(j-2,0);var c=document.createElement("div"),f=Math.round(j*b);if(f=Math.min(j,f),d.progressColor&&(c.style.backgroundColor=d.progressColor,c.style.opacity=1),c.style.width=f+"px",c.className="gantt_task_progress",c.innerHTML=this.templates.progress_text(d.start_date,d.end_date,d),h.appendChild(c),this.config.drag_progress&&!gantt._is_readonly(d)){var g=document.createElement("div");g.style.left=f+"px",g.className="gantt_task_progress_drag",c.appendChild(g),h.appendChild(g)}},gantt._get_line=function(a){var b={second:1,minute:60,hour:3600,day:86400,week:604800,month:2592000,year:31536000};return b[a]||0},gantt.dateFromPos=function(d){var h=this._tasks;if(0>d||d>h.full_width||!h.full_width){return null}var k=this._findBinary(this._tasks.left,d),b=this._tasks.left[k],c=h.width[k]||h.col_width,f=0;c&&(f=(d-b)/c);var g=0;f&&(g=gantt._get_coll_duration(h,h.trace_x[k]));var j=new Date(h.trace_x[k].valueOf()+Math.round(f*g));return j},gantt.posFromDate=function(d){var f=gantt._day_index_by_date(d);this.assert(f>=0,"Invalid day index");var g=Math.floor(f),b=f%1,c=gantt._tasks.left[Math.min(g,gantt._tasks.width.length-1)];return g==gantt._tasks.width.length&&(c+=gantt._tasks.width[gantt._tasks.width.length-1]),b&&(c+=g<gantt._tasks.width.length?gantt._tasks.width[g]*(b%1):1),c},gantt._day_index_by_date=function(d){var g=new Date(d).valueOf(),h=gantt._tasks.trace_x,b=gantt._tasks.ignore_x;if(g<=this._min_date){return 0}if(g>=this._max_date){return h.length}for(var c=gantt._findBinary(h,g),f=+gantt._tasks.trace_x[c];b[f];){f=gantt._tasks.trace_x[++c]}return f?c+(d-h[c])/gantt._get_coll_duration(gantt._tasks,h[c]):0},gantt._findBinary=function(d,h){for(var j,b,c,f=0,g=d.length-1;g>=f;){if(j=Math.floor((f+g)/2),b=+d[j],c=+d[j-1],h>b){f=j+1}else{if(!(b>h)){return j}if(!isNaN(c)&&h>c){return j-1}g=j-1}}return d.length-1},gantt._get_coll_duration=function(a,b){return gantt.date.add(b,a.step,a.unit)-b},gantt._get_x_pos=function(a,b){b=b!==!1;gantt.posFromDate(b?a.start_date:a.end_date)},gantt.getTaskTop=function(a){return this._y_from_ind(this.getGlobalTaskIndex(a))},gantt._get_task_coord=function(d,h,j){h=h!==!1,j=j||0;var b=this._get_safe_type(d.type)==this.config.types.milestone,c=null;c=h||b?d.start_date||this._default_task_date(d):d.end_date||this.calculateEndDate(this._default_task_date(d));var f=this.posFromDate(c),g=this.getTaskTop(d.id);return b&&(h?f-=j:f+=j),{x:f,y:g}},gantt._get_task_pos=function(a,b){b=b!==!1;var c=gantt._get_milestone_width()/2;return this._get_task_coord(a,b,c)},gantt._get_task_visible_pos=function(a,b){b=b!==!1;var c=gantt._get_visible_milestone_width()/2;return this._get_task_coord(a,b,c)},gantt._correct_shift=function(a,b){return a-=60000*(new Date(gantt._min_date).getTimezoneOffset()-new Date(a).getTimezoneOffset())*(b?-1:1)},gantt._get_mouse_pos=function(c){if(c.pageX||c.pageY){var d={x:c.pageX,y:c.pageY}}var f=gantt.env.isIE?document.documentElement:document.body,d={x:c.clientX+f.scrollLeft-f.clientLeft,y:c.clientY+f.scrollTop-f.clientTop},b=gantt._get_position(gantt.$task_data);return d.x=d.x-b.x+gantt.$task_data.scrollLeft,d.y=d.y-b.y+gantt.$task_data.scrollTop,d},gantt._is_layer=function(a){return a&&a.hasAttribute&&a.hasAttribute(this.config.layer_attribute)},gantt.attachEvent("onGanttReady",function(){gantt._task_layers.add(),gantt._link_layers.add()}),gantt._layers={prepareConfig:function(a){"function"==typeof a&&(a={renderer:a});a.id=gantt.uid();return a.container||(a.container=document.createElement("div")),a},create:function(a,b){return{tempCollection:[],renderers:{},container:a,getRenderers:function(){var c=[];for(var d in this.renderers){c.push(this.renderers[d])}return c},getRenderer:function(c){return this.renderers[c]},add:function(f){if(f&&this.tempCollection.push(f),this.container()){for(var k=this.container(),c=this.tempCollection,e=0;e<c.length;e++){var f=c[e],g=f.container,h=f.id,j=f.topmost;if(!g.parentNode){if(j){k.appendChild(g)}else{var d=b?b():k.firstChild;d?k.insertBefore(g,d):k.appendChild(g)}}this.renderers[h]=gantt._task_renderer(h,f.renderer,g,f.filter),this.tempCollection.splice(e,1),e--}}},remove:function(c){this.renderers[c].unload(),delete this.renderers[c]},clear:function(){for(var c in this.renderers){this.renderers[c].unload()}this.renderers={}}}}},gantt._create_filter=function(a){return a instanceof Array||(a=Array.prototype.slice.call(arguments,0)),function(f){for(var g=!0,b=0,c=a.length;c>b;b++){var d=a[b];d&&(g=g&&d.apply(gantt,[f.id,f])!==!1)}return g}},gantt._add_generic_layer=function(a,b){return function(c){return void 0===c.filter&&(c.filter=gantt._create_filter(b)),c=gantt._layers.prepareConfig(c),a.add(c),c.id}},gantt._task_layers=gantt._layers.create(function(){return gantt.$task_data},function(){return gantt.$task_links}),gantt._link_layers=gantt._layers.create(function(){return gantt.$task_data}),gantt.addTaskLayer=gantt._add_generic_layer(gantt._task_layers,[gantt._filter_task,gantt._is_chart_visible].concat(gantt._get_task_filters())),gantt.removeTaskLayer=function(a){gantt._task_layers.remove(a)},gantt.addLinkLayer=gantt._add_generic_layer(gantt._link_layers,[gantt._filter_link,gantt._is_chart_visible].concat(gantt._get_link_filters())),gantt.removeLinkLayer=function(a){gantt._link_layers.remove(a)},gantt._get_task_renderers=function(){return this._task_layers.getRenderers()},gantt._get_link_renderers=function(){return this._link_layers.getRenderers()},gantt._pull={},gantt._branches={},gantt._order=[],gantt._lpull={},gantt._links=[],gantt._order_full=[],gantt.load=function(d,f,g){this._load_url=d,this.assert(arguments.length,"Invalid load arguments"),this.callEvent("onLoadStart",[]);var b="json",c=null;arguments.length>=3?(b=f,c=g):"string"==typeof arguments[1]?b=arguments[1]:"function"==typeof arguments[1]&&(c=arguments[1]),this._load_type=b,this.ajax.get(d,gantt.bind(function(a){this.on_load(a,b),this.callEvent("onLoadEnd",[]),"function"==typeof c&&c.call(this)},this))},gantt.getEditTask=function(){editTasks=[];for(var c=0;c<this._order_full.length;c++){var b=this._pull[this._order_full[c]];if(b.parent!=""){var a=document.getElementById(b.id+"-start_date-value").value;var f=document.getElementById(b.id+"_text").value;var d=document.getElementById(b.id+"_dur").value;var h=document.getElementById(b.id+"-end_date-value").value;var g=document.getElementById(b.id+"_isAutoDate").innerHTML;if(g.trim().length>0){g=true}else{g=false}var e=false;if((b.isAutoDate!="true"&&g==true)||(b.isAutoDate=="true"&&g==false)){e=true}if(f!=b.text||(b.start_date.Value!=a)||(b.end_date.Value!=h)||d!=b.dur||e){editTasks.push({id:b.id,value:f,start_date:a,end_date:h,dur:d,isAutoDate:g})}}}return editTasks},gantt.getTaskById=function(a){return this._pull[a]},gantt.getTaskByNumber=function(c){for(var b=0;b<this._order_full.length;b++){var a=this._pull[this._order_full[b]];if(a.index==c){return a}}return null},gantt.getChildNoPrevious=function(c){childTasks=[];for(var b=0;b<this._order_full.length;b++){var a=this._pull[this._order_full[b]];if(a.parent==c){if(a.previousId==""){childTasks.push(a)}}}return childTasks},gantt.getPrevious=function(c){previousTasks=[];for(var b=0;b<this._order_full.length;b++){var a=this._pull[this._order_full[b]];if(a.previousId==c){previousTasks.push(a)}}return previousTasks},gantt.parse=function(a,b){this.on_load({xmlDoc:{responseText:a}},b)},gantt.serialize=function(a){return a=a||"json",this[a].serialize()},gantt.on_load=function(c,d){this.callEvent("onBeforeParse",[]),d||(d="json"),this.assert(this[d],"Invalid data type:'"+d+"'");var f=c.xmlDoc.responseText,b=this[d].parse(f,c);this._process_loading(b)},gantt._load_task=function(a){return this._init_task(a),this.callEvent("onTaskLoading",[a])?(this._pull[a.id]=a,!0):!1},gantt._build_pull=function(d){for(var f=null,g=[],b=0,c=d.length;c>b;b++){f=d[b],this._load_task(f)&&g.push(f)}return g},gantt._build_hierarchy=function(c){for(var d=null,f=0,b=c.length;b>f;f++){d=c[f],this.setParent(d,this.getParent(d)||this.config.root_id)}for(var f=0,b=c.length;b>f;f++){d=c[f],this._add_branch(d),d.$level=this.calculateTaskLevel(d)}},gantt._process_loading=function(a){a.collections&&this._load_collections(a.collections);var b=this._build_pull(a.data);if(this._build_hierarchy(b),this._sync_order(),this._order_synced=!0,this._init_links(a.links||(a.collections?a.collections.links:[])),this.callEvent("onParse",[]),this.render(),this.config.initial_scroll){var c=this._order[0]||this.config.root_id;c&&this.showTask(c)}},gantt._init_links=function(a){if(a){for(var b=0;b<a.length;b++){if(a[b]){var c=this._init_link(a[b]);this._lpull[c.id]=c}}}this._sync_links()},gantt._load_collections=function(k){var g=!1;for(var d in k){if(k.hasOwnProperty(d)){g=!0;var h=k[d],f=this.serverList[d];if(!f){continue}f.splice(0,f.length);for(var l=0;l<h.length;l++){var b=h[l],c=this.copy(b);c.key=c.value;for(var j in b){if(b.hasOwnProperty(j)){if("value"==j||"label"==j){continue}c[j]=b[j]}}f.push(c)}}}g&&this.callEvent("onOptionsLoad",[])},gantt._sync_order=function(a){this._order=[],this._order_full=[],this._order_search={},this._sync_order_item({parent:this.config.root_id,$open:!0,$ignore:!0,id:this.config.root_id}),a||(this._scroll_resize(),this._set_sizes())},gantt.attachEvent("onBeforeTaskDisplay",function(a,b){return !b.$ignore}),gantt._sync_order_item=function(c,d){c.id&&(this._order_full.push(c.id),!d&&this._filter_task(c.id,c)&&this.callEvent("onBeforeTaskDisplay",[c.id,c])&&(this._order.push(c.id),this._order_search[c.id]=this._order.length-1));var f=this.getChildren(c.id);if(f){for(var b=0;b<f.length;b++){this._sync_order_item(this._pull[f[b]],d||!c.$open)}}},gantt.getTaskCount=function(){return this._order_full.length},gantt.getLinkCount=function(){return this._links.length},gantt.getVisibleTaskCount=function(){return this._order.length},gantt.getTaskIndex=function(a){for(var b=this.getChildren(this.getParent(a)),c=0;c<b.length;c++){if(b[c]==a){return c}}return -1},gantt.getGlobalTaskIndex=function(a){this.assert(a,"Invalid argument");var b=this._order_search[a];return void 0!==b?b:-1},gantt._get_visible_order=gantt.getGlobalTaskIndex,gantt.eachTask=function(d,g,h){g=g||this.config.root_id,h=h||this;var b=this.getChildren(g);if(b){for(var c=0;c<b.length;c++){var f=this._pull[b[c]];d.call(h,f),this.hasChild(f.id)&&this.eachTask(d,f.id,h)}}},gantt.json={parse:function(a){return gantt.assert(a,"Invalid data"),"string"==typeof a&&(window.JSON?a=JSON.parse(a):gantt.assert(!1,"JSON is not supported")),a.dhx_security&&(gantt.security_key=a.dhx_security),a},_copyLink:function(a){var b={};for(var c in a){b[c]=a[c]}return b},_copyObject:function(a){var b={};for(var c in a){"$"!=c.charAt(0)&&(b[c]=a[c],b[c] instanceof Date&&(b[c]=gantt.templates.xml_format(b[c])))}return b},serialize:function(){var a=[],b=[];return gantt.eachTask(function(c){gantt.resetProjectDates(c),a.push(this._copyObject(c))},gantt.config.root_id,this),b=gantt._links.slice(),{data:a,links:b}}},gantt.xml={_xmlNodeToJSON:function(d,f){for(var g={},b=0;b<d.attributes.length;b++){g[d.attributes[b].name]=d.attributes[b].value}if(!f){for(var b=0;b<d.childNodes.length;b++){var c=d.childNodes[b];1==c.nodeType&&(g[c.tagName]=c.firstChild?c.firstChild.nodeValue:"")}g.text||(g.text=d.firstChild?d.firstChild.nodeValue:"")}return g},_getCollections:function(x){for(var q={},f=gantt.ajax.xpath("//coll_options",x),v=0;v<f.length;v++){for(var k=f[v].getAttribute("for"),y=q[k]=[],b=gantt.ajax.xpath(".//item",f[v]),c=0;c<b.length;c++){for(var w=b[c],u=w.attributes,j={key:b[c].getAttribute("value"),label:b[c].getAttribute("label")},p=0;p<u.length;p++){var m=u[p];"value"!=m.nodeName&&"label"!=m.nodeName&&(j[m.nodeName]=m.nodeValue)}y.push(j)}}return q},_getXML:function(d,f,g){g=g||"data",f.getXMLTopNode||(f=gantt.ajax.parse(f));var b=gantt.ajax.xmltop(g,f.xmlDoc);if(b.tagName!=g){throw"Invalid XML data"}var c=b.getAttribute("dhx_security");return c&&(gantt.security_key=c),b},parse:function(d,g){g=this._getXML(d,g);for(var h={},b=h.data=[],c=gantt.ajax.xpath("//task",g),f=0;f<c.length;f++){b[f]=this._xmlNodeToJSON(c[f])}return h.collections=this._getCollections(g),h},_copyLink:function(a){return"<item id='"+a.id+"' source='"+a.source+"' target='"+a.target+"' type='"+a.type+"' />"},_copyObject:function(a){return"<task id='"+a.id+"' parent='"+(a.parent||"")+"' start_date='"+a.start_date+"' duration='"+a.duration+"' open='"+!!a.open+"' progress='"+a.progress+"' end_date='"+a.end_date+"'><![CDATA["+a.text+"]]></task>"},serialize:function(){for(var d=[],f=[],g=gantt.json.serialize(),b=0,c=g.data.length;c>b;b++){d.push(this._copyObject(g.data[b]))}for(var b=0,c=g.links.length;c>b;b++){f.push(this._copyLink(g.links[b]))}return"<data>"+d.join("")+"<coll_options for='links'>"+f.join("")+"</coll_options></data>"}},gantt.oldxml={parse:function(d,h){h=gantt.xml._getXML(d,h,"projects");for(var k={collections:{links:[]}},b=k.data=[],c=gantt.ajax.xpath("//task",h),f=0;f<c.length;f++){b[f]=gantt.xml._xmlNodeToJSON(c[f]);var g=c[f].parentNode;"project"==g.tagName?b[f].parent="project-"+g.getAttribute("id"):b[f].parent=g.parentNode.getAttribute("id")}c=gantt.ajax.xpath("//project",h);for(var f=0;f<c.length;f++){var j=gantt.xml._xmlNodeToJSON(c[f],!0);j.id="project-"+j.id,b.push(j)}for(var f=0;f<b.length;f++){var j=b[f];j.start_date=j.startdate||j.est,j.end_date=j.enddate,j.text=j.name,j.duration=j.duration/8,j.open=1,j.duration||j.end_date||(j.duration=1),j.predecessortasks&&k.collections.links.push({target:j.id,source:j.predecessortasks,type:gantt.config.links.finish_to_start})}return k},serialize:function(){gantt.message("Serialization to 'old XML' is not implemented")}},gantt.serverList=function(a,b){return b?this.serverList[a]=b.slice(0):this.serverList[a]||(this.serverList[a]=[]),this.serverList[a]},gantt._working_time_helper={units:["year","month","week","day","hour","minute"],hours:[8,17],dates:{0:!1,6:!1},_working_units_cache:{_cache:{},get:function(d,g){var h=-1,b=this._cache;if(b&&b[d]){var c=b[d],f=g.getTime();void 0!==c[f]&&(h=c[f])}return h},put:function(d,f,g){if(!d||!f){return !1}var b=this._cache,c=f.getTime();return g=!!g,b?(b[d]||(b[d]={}),b[d][c]=g,!0):!1},clear:function(){this._cache={}}},_get_unit_order:function(a){for(var b=0,c=this.units.length;c>b;b++){if(this.units[b]==a){return b}}gantt.assert(!1,"Incorrect duration unit")},_timestamp:function(a){var b=null;return a.day||0===a.day?b=a.day:a.date&&(b=gantt.date.date_part(new Date(a.date)).valueOf()),b},set_time:function(a){var b=void 0!==a.hours?a.hours:!0,c=this._timestamp(a);null!==c?this.dates[c]=b:this.hours=b,this._working_units_cache.clear()},unset_time:function(a){if(a){var b=this._timestamp(a);null!==b&&delete this.dates[b]}else{this.hours=[]}this._working_units_cache.clear()},is_working_unit:function(c,d,f){if(!gantt.config.work_time){return !0}var b=this._working_units_cache.get(d,c);return -1==b&&(b=this._check_is_working_unit(c,d,f),this._working_units_cache.put(d,c,b)),b},_check_is_working_unit:function(a,b,c){return void 0===c&&(c=this._get_unit_order(b)),void 0===c?!1:c&&!this.is_working_unit(a,this.units[c-1],c-1)?!1:this["is_work_"+b]?this["is_work_"+b](a):!0},is_work_day:function(a){var b=this.get_working_hours(a);return b instanceof Array?b.length>0:!1},is_work_hour:function(c){for(var d=this.get_working_hours(c),f=c.getHours(),b=0;b<d.length;b+=2){if(void 0===d[b+1]){return d[b]==f}if(f>=d[b]&&f<d[b+1]){return !0}}return !1},get_working_hours:function(a){var b=this._timestamp({date:a}),c=!0;return void 0!==this.dates[b]?c=this.dates[b]:void 0!==this.dates[a.getDay()]&&(c=this.dates[a.getDay()]),c===!0?this.hours:c?c:[]},intern_dates_pull:{},next_date:function(d,g,h){var b=+d,c=g+"_"+h,f=this.intern_dates_pull[c];return f||(f=this.intern_dates_pull[c]={}),f[b]||(f[b]=gantt.date.add(d,h,g)),f[b]},get_work_units_between:function(d,h,j,b){if(!j){return !1}for(var c=new Date(d),f=new Date(h),b=b||1,g=0;c.valueOf()<f.valueOf();){this.is_working_unit(c,j)&&g++,c=this.next_date(c,j,b)}return g},is_work_units_between:function(d,g,h,b){if(!h){return !1}for(var c=new Date(d),f=new Date(g),b=b||1;c.valueOf()<f.valueOf();){if(this.is_working_unit(c,h)){return !0}c=this.next_date(c,h,b)}return !1},add_worktime:function(d,h,j,b){if(!j){return !1}var c=new Date(d),f=0,b=b||1,h=1*h;if(gantt.config.work_time){for(;h>f;){var g=this.next_date(c,j,b);this.is_working_unit(b>0?new Date(g.valueOf()-1):new Date(g.valueOf()+1),j)&&f++,c=g}return c}return gantt.date.add(c,b*h,j)},get_closest_worktime:function(q){if(this.is_working_unit(q.date,q.unit)){return q.date}var j=q.unit,f=gantt.date[j+"_start"](q.date),m=new Date(f),h=new Date(f),u=!0,b=3000,c=0,p="any"==q.dir||!q.dir,k=1;for("past"==q.dir&&(k=-1);!this.is_working_unit(f,j);){p&&(f=u?m:h,k=-1*k);var g=f.getTimezoneOffset();if(f=gantt.date.add(f,k,j),f=gantt._correct_dst_change(f,g,k,j),gantt.date[j+"_start"]&&(f=gantt.date[j+"_start"](f)),p&&(u?m=f:h=f),u=!u,c++,c>b){return gantt.assert(!1,"Invalid working time check"),!1}}return(f==h||"past"==q.dir)&&(f=gantt.date.add(f,1,j)),f}},gantt.getTask=function(a){gantt.assert(a,"Invalid argument for gantt.getTask");var b=this._pull[a];return gantt.assert(b,"Task not found id="+a),b},gantt.getTaskByTime=function(d,g){var h=this._pull,b=[];if(d||g){d=+d||-(1/0),g=+g||1/0;for(var c in h){var f=h[c];+f.start_date<g&&+f.end_date>d&&b.push(f)}}else{for(var c in h){b.push(h[c])}}return b},gantt.isTaskExists=function(a){return gantt.defined(this._pull[a])},gantt.isUnscheduledTask=function(a){return !!a.unscheduled||!a.start_date},gantt._isAllowedUnscheduledTask=function(a){return a.unscheduled&&gantt.config.show_unscheduled},gantt.isTaskVisible=function(a){if(!this._pull[a]){return !1}var b=this._pull[a];return(+b.start_date<+this._max_date&&+b.end_date>+this._min_date||gantt._isAllowedUnscheduledTask(b))&&void 0!==this._order_search[a]?!0:!1},gantt.updateTask=function(a,b){return gantt.defined(b)||(b=this.getTask(a)),this.callEvent("onBeforeTaskUpdate",[a,b])===!1?!1:(this._pull[b.id]=b,this._is_parent_sync(b)||this._resync_parent(b),this._isAllowedUnscheduledTask(b)&&(this._init_task(b),this._sync_links()),this._update_parents(b.id),this.refreshTask(b.id),this.callEvent("onAfterTaskUpdate",[a,b]),this._sync_order(),void this._adjust_scales())},gantt._add_branch=function(d,h){var j=this.getParent(d);this.hasChild(j)||(this._branches[j]=[]);for(var b=this.getChildren(j),c=!1,f=0,g=b.length;g>f;f++){if(b[f]==d.id){c=!0;break}}c||(1*h==h?b.splice(h,0,d.id):b.push(d.id)),this._sync_parent(d)},gantt._move_branch=function(a,b,c){this.setParent(a,c),this._sync_parent(a),this._replace_branch_child(b,a.id),this.isTaskExists(c)||c==this.config.root_id?this._add_branch(a):delete this._branches[a.id],a.$level=this.calculateTaskLevel(a),this._sync_order()},gantt._resync_parent=function(a){this._move_branch(a,a.$rendered_parent,this.getParent(a))},gantt._sync_parent=function(a){a.$rendered_parent=this.getParent(a)},gantt._is_parent_sync=function(a){return a.$rendered_parent==this.getParent(a)},gantt._replace_branch_child=function(d,g,h){var b=this.getChildren(d);if(b){for(var c=[],f=0;f<b.length;f++){b[f]!=g?c.push(b[f]):h&&c.push(h)}this._branches[d]=c}this._sync_order()},gantt.addTask=function(a,b,c){return gantt.defined(b)||(b=this.getParent(a)||0),this.isTaskExists(b)||(b=0),this.setParent(a,b),a=this._init_task(a),this.callEvent("onBeforeTaskAdd",[a.id,a])===!1?!1:(this._pull[a.id]=a,this._add_branch(a,c),this.callEvent("onAfterTaskAdd",[a.id,a]),this.refreshData(),this._adjust_scales(),a.id)},gantt._default_task_date=function(d,f){var g=f&&f!=this.config.root_id?this.getTask(f):!1,b="";if(g){b=g.start_date}else{var c=this._order[0];b=c?this.getTask(c).start_date?this.getTask(c).start_date:this.getTask(c).end_date?this.calculateEndDate(this.getTask(c).end_date,-this.config.duration_step):"":this.config.start_date||this.getState().min_date}return gantt.assert(b,"Invalid dates"),new Date(b)},gantt._set_default_task_timing=function(a){a.start_date=a.start_date||gantt._default_task_date(a,this.getParent(a)),a.duration=a.duration||this.config.duration_step,a.end_date=a.end_date||this.calculateEndDate(a.start_date,a.duration)},gantt.createTask=function(c,d,f){if(c=c||{},c.id=gantt.uid(),c.start_date||(c.start_date=gantt._default_task_date(c,d)),void 0===c.text&&(c.text=gantt.locale.labels.new_task),void 0===c.duration&&(c.duration=1),d){this.setParent(c,d);var b=this.getTask(d);b.$open=!0}return this.callEvent("onTaskCreated",[c])?(this.config.details_on_create?(c.$new=!0,this._pull[c.id]=this._init_task(c),this._add_branch(c,f),c.$level=this.calculateTaskLevel(c),this.selectTask(c.id),this.refreshData(),this.showLightbox(c.id)):this.addTask(c,d,f)&&(this.showTask(c.id),this.selectTask(c.id)),c.id):null},gantt.deleteTask=function(a){return this._deleteTask(a)},gantt._getChildLinks=function(d){var g=this.getTask(d);if(!g){return[]}for(var h=g.$source.concat(g.$target),b=this.getChildren(g.id),c=0;c<b.length;c++){h=h.concat(this._getChildLinks(b[c]))}for(var f={},c=0;c<h.length;c++){f[h[c]]=!0}h=[];for(var c in f){h.push(c)}return h},gantt._getTaskTree=function(d){var f=this.getTask(d);if(!f){return[]}for(var g=[],b=this.getChildren(f.id),c=0;c<b.length;c++){g.push(b[c]),g=g.concat(this._getTaskTree(b[c]))}return g},gantt._deleteRelatedLinks=function(d,g){var h=this._dp&&!g,b="",c=h?"off"!=this._dp.updateMode:!1;h&&(b=this._dp.updateMode,this._dp.setUpdateMode("off"));for(var f=0;f<d.length;f++){h&&(this._dp.setGanttMode("links"),this._dp.setUpdated(d[f],!0,"deleted")),this._deleteLink(d[f],!0)}h&&(this._dp.setUpdateMode(b),c&&this._dp.sendAllData())},gantt._deleteRelatedTasks=function(d,h){var j=this._dp&&!h,b="";j&&(b=this._dp.updateMode,this._dp.setGanttMode("tasks"),this._dp.setUpdateMode("off"));for(var c=this._getTaskTree(d),f=0;f<c.length;f++){var g=c[f];this._unset_task(g),j&&this._dp.setUpdated(g,!0,"deleted")}j&&this._dp.setUpdateMode(b)},gantt._unset_task=function(a){var b=this.getTask(a);this._update_flags(a,null),delete this._pull[a],this._move_branch(b,this.getParent(b),null)},gantt._deleteTask=function(c,d){var f=this.getTask(c);if(!d&&this.callEvent("onBeforeTaskDelete",[c,f])===!1){return !1}var b=gantt._getChildLinks(c);return this._deleteRelatedTasks(c,d),this._deleteRelatedLinks(b,d),this._unset_task(c),d||(this.callEvent("onAfterTaskDelete",[c,f]),this.refreshData()),!0},gantt.clearAll=function(){this._clear_data(),this.callEvent("onClear",[]),this.refreshData()},gantt._clear_data=function(){this._pull={},this._branches={},this._order=[],this._order_full=[],this._lpull={},this._links=[],this._update_flags(),this.userdata={}},gantt._update_flags=function(a,b){void 0===a?(this._lightbox_id=this._selected_task=null,this._tasks_dnd.drag&&(this._tasks_dnd.drag.id=null)):(this._lightbox_id==a&&(this._lightbox_id=b),this._selected_task==a&&(this._selected_task=b),this._tasks_dnd.drag&&this._tasks_dnd.drag.id==a&&(this._tasks_dnd.drag.id=b))},gantt.changeTaskId=function(d,h){var k=this._pull[h]=this._pull[d];this._pull[h].id=h,delete this._pull[d],this._update_flags(d,h),this._replace_branch_child(this.getParent(k),d,h);for(var b in this._pull){var c=this._pull[b];this.getParent(c)==d&&(this.setParent(c,h),this._resync_parent(c))}for(var f=this._get_task_links(k),g=0;g<f.length;g++){var j=this.getLink(f[g]);j.source==d&&(j.source=h),j.target==d&&(j.target=h)}this.callEvent("onTaskIdChange",[d,h])},gantt._get_task_links=function(a){var b=[];return a.$source&&(b=b.concat(a.$source)),a.$target&&(b=b.concat(a.$target)),b},gantt._get_duration_unit=function(){return 1000*gantt._get_line(this.config.duration_unit)||this.config.duration_unit},gantt._get_safe_type=function(a){return"task"},gantt._get_type_name=function(a){for(var b in this.config.types){if(this.config.types[b]==a){return b}}return"task"},gantt.getWorkHours=function(a){return this._working_time_helper.get_working_hours(a)},gantt.setWorkTime=function(a){this._working_time_helper.set_time(a)},gantt.isWorkTime=function(a,b){var c=this._working_time_helper;return c.is_working_unit(a,b||this.config.duration_unit)},gantt.correctTaskWorkTime=function(a){gantt.config.work_time&&gantt.config.correct_work_time&&(gantt.isWorkTime(a.start_date)?gantt.isWorkTime(new Date(+a.end_date-1))||(a.end_date=gantt.calculateEndDate(a.start_date,a.duration)):(a.start_date=gantt.getClosestWorkTime({date:a.start_date,dir:"future"}),a.end_date=gantt.calculateEndDate(a.start_date,a.duration)))},gantt.getClosestWorkTime=function(a){var b=this._working_time_helper;return a instanceof Date&&(a={date:a}),a.dir=a.dir||"any",a.unit=a.unit||this.config.duration_unit,b.get_closest_worktime(a)},gantt.calculateDuration=function(a,b){var c=this._working_time_helper;return c.get_work_units_between(a,b,this.config.duration_unit,this.config.duration_step)},gantt._hasDuration=function(a,b){var c=this._working_time_helper;return c.is_work_units_between(a,b,this.config.duration_unit,this.config.duration_step)},gantt.calculateEndDate=function(d,f,g){var b=this._working_time_helper,c=f>=0?1:-1;return b.add_worktime(d,Math.abs(f),g||this.config.duration_unit,c*this.config.duration_step)},gantt._init_task=function(a){return gantt.defined(a.id)||(a.id=gantt.uid()),a.start_date&&(a.start_date=gantt.date.parseDate(a.start_date,"xml_date")),a.end_date&&(a.end_date=gantt.date.parseDate(a.end_date,"xml_date")),a.start_date?!a.end_date&&a.duration&&(a.end_date=this.calculateEndDate(a.start_date,a.duration)):a.end_date&&void 0!==a.duration&&(a.start_date=this.calculateEndDate(a.end_date,-a.duration)),this._isAllowedUnscheduledTask(a)&&this._set_default_task_timing(a),gantt._init_task_timing(a),a.start_date&&a.end_date&&gantt.correctTaskWorkTime(a),a.$source=[],a.$target=[],void 0===a.parent&&this.setParent(a,this.config.root_id),gantt.defined(a.$open)||(a.$open=gantt.defined(a.open)?a.open:this.config.open_tree_initially),a.$level=this.calculateTaskLevel(a),a},gantt._init_task_timing=function(a){var b=this._get_safe_type(a.type);void 0===a.$rendered_type?a.$rendered_type=b:a.$rendered_type!=b&&(delete a.$no_end,delete a.$no_start,a.$rendered_type=b),void 0!==a.$no_end&&void 0!==a.$no_start||b==this.config.types.milestone||(b==this.config.types.project?(a.$no_end=a.$no_start=!0,this._set_default_task_timing(a)):(a.$no_end=!(a.end_date||a.duration),a.$no_start=!a.start_date,this._isAllowedUnscheduledTask(a)&&(a.$no_end=a.$no_start=!1))),b==this.config.types.milestone&&(a.end_date=a.start_date),a.start_date&&a.end_date&&(a.duration=this.calculateDuration(a.start_date,a.end_date)),a.duration=a.duration||0},gantt._is_flex_task=function(a){return !(!a.$no_end&&!a.$no_start)},gantt.resetProjectDates=function(a){if(a.$no_end||a.$no_start){var b=this.getSubtaskDates(a.id);this._assign_project_dates(a,b.start_date,b.end_date)}},gantt.getSubtaskDates=function(c){var d=null,f=null,b=void 0!==c?c:gantt.config.root_id;return this.eachTask(function(a){this._get_safe_type(a.type)==gantt.config.types.project||this.isUnscheduledTask(a)||(a.start_date&&!a.$no_start&&(!d||d>a.start_date.valueOf())&&(d=a.start_date.valueOf()),a.end_date&&!a.$no_end&&(!f||f<a.end_date.valueOf())&&(f=a.end_date.valueOf()))},b),{start_date:d?new Date(d):null,end_date:f?new Date(f):null}},gantt._assign_project_dates=function(a,b,c){a.$no_start&&(b&&b!=1/0?a.start_date=new Date(b):a.start_date=this._default_task_date(a,this.getParent(a))),a.$no_end&&(c&&c!=-(1/0)?a.end_date=new Date(c):a.end_date=this.calculateEndDate(a.start_date,this.config.duration_step)),(a.$no_start||a.$no_end)&&this._init_task_timing(a)},gantt._update_parents=function(d,h){if(d){var j=this.getTask(d),b=this.getParent(j),c=!0;if(j.$no_start||j.$no_end){var f=j.start_date.valueOf(),g=j.end_date.valueOf();gantt.resetProjectDates(j),f==j.start_date.valueOf()&&g==j.end_date.valueOf()&&(c=!1),c&&!h&&this.refreshTask(j.id,!0)}c&&b&&this.isTaskExists(b)&&this._update_parents(b,h)}},gantt.isChildOf=function(c,d){if(!this.isTaskExists(c)){return !1}if(d===this.config.root_id){return this.isTaskExists(c)}for(var f=this.getTask(c),b=this.getParent(c);f&&this.isTaskExists(b);){if(f=this.getTask(b),f&&f.id==d){return !0}b=this.getParent(f)}return !1},gantt.roundDate=function(d){d instanceof Date&&(d={date:d,unit:gantt._tasks.unit,step:gantt._tasks.step});var h,k,b,c=d.date,f=d.step,g=d.unit;if(g==gantt._tasks.unit&&f==gantt._tasks.step&&+c>=+gantt._min_date&&+c<=+gantt._max_date){b=Math.floor(gantt._day_index_by_date(c)),gantt._tasks.trace_x[b]||(b-=1),k=new Date(gantt._tasks.trace_x[b]),h=new Date(k),h=gantt._tasks.trace_x[b+1]?new Date(gantt._tasks.trace_x[b+1]):gantt.date.add(k,f,g)}else{for(b=Math.floor(gantt._day_index_by_date(c)),h=gantt.date[g+"_start"](new Date(this._min_date)),gantt._tasks.trace_x[b]&&(h=gantt.date[g+"_start"](gantt._tasks.trace_x[b]));+c>+h;){h=gantt.date[g+"_start"](gantt.date.add(h,f,g));var j=h.getTimezoneOffset();h=gantt.date.add(h,f,g),h=gantt._correct_dst_change(h,j,h,g),gantt.date[g+"_start"]&&(h=gantt.date[g+"_start"](h))}k=gantt.date.add(h,-1*f,g)}return d.dir&&"future"==d.dir?h:d.dir&&"past"==d.dir?k:Math.abs(c-k)<Math.abs(h-c)?k:h},gantt.attachEvent("onBeforeTaskUpdate",function(a,b){return gantt._init_task_timing(b),!0}),gantt.attachEvent("onBeforeTaskAdd",function(a,b){return gantt._init_task_timing(b),!0}),gantt.calculateTaskLevel=function(a){for(var b=0;this.getParent(a)&&this.isTaskExists(this.getParent(a));){a=this.getTask(this.getParent(a)),b++}return b},gantt.sort=function(m,h,f,k){var g=!k;this.isTaskExists(f)||(f=this.config.root_id),m||(m="order");var p="string"==typeof m?function(i,o){if(i[m]==o[m]){return 0}var d=i[m]>o[m];return d?1:-1}:m;if(h){var b=p;p=function(a,d){return b(d,a)}}var c=this.getChildren(f);if(c){for(var l=[],j=c.length-1;j>=0;j--){l[j]=this._pull[c[j]]}l.sort(p);for(var j=0;j<l.length;j++){c[j]=l[j].id,this.sort(m,h,c[j],!0)}}g&&this.render()},gantt.getNext=function(a){for(var b=0;b<this._order.length-1;b++){if(this._order[b]==a){return this._order[b+1]}}return null},gantt.getPrev=function(a){for(var b=1;b<this._order.length;b++){if(this._order[b]==a){return this._order[b-1]}}return null},gantt._get_parent_id=function(a){var b=this.config.root_id;return a&&(b=a.parent),b},gantt.getParent=function(a){var b=null;return b=a.id?a:gantt.getTask(a),this._get_parent_id(b)},gantt.setParent=function(a,b){a.parent=b},gantt.getSiblings=function(a){if(!this.isTaskExists(a)){return[]}var b=this.getParent(a);return this.getChildren(b)},gantt.getNextSibling=function(c){for(var d=this.getSiblings(c),f=0,b=d.length;b>f;f++){if(d[f]==c){return d[f+1]||null}}return null},gantt.getPrevSibling=function(c){for(var d=this.getSiblings(c),f=0,b=d.length;b>f;f++){if(d[f]==c){return d[f-1]||null}}return null},gantt._dp_init=function(c){c.setTransactionMode("POST",!0),c.serverProcessor+=(-1!=c.serverProcessor.indexOf("?")?"&":"?")+"editing=true",c._serverProcessor=c.serverProcessor,c.styles={updated:"gantt_updated",order:"gantt_updated",inserted:"gantt_inserted",deleted:"gantt_deleted",invalid:"gantt_invalid",error:"gantt_error",clear:""},c._methods=["_row_style","setCellTextStyle","_change_id","_delete_task"],c.setGanttMode=function(h){var i=c.modes||{};c._ganttMode&&(i[c._ganttMode]={_in_progress:c._in_progress,_invalid:c._invalid,updatedRows:c.updatedRows});var g=i[h];g||(g=i[h]={_in_progress:{},_invalid:{},updatedRows:[]}),c._in_progress=g._in_progress,c._invalid=g._invalid,c.updatedRows=g.updatedRows,c.modes=i,c._ganttMode=h},this._sendTaskOrder=function(a,g){g.$drop_target&&(c.setGanttMode("tasks"),this.getTask(a).target=g.$drop_target,c.setUpdated(a,!0,"order"),delete this.getTask(a).$drop_target)},this.attachEvent("onAfterTaskAdd",function(a,g){c.setGanttMode("tasks"),c.setUpdated(a,!0,"inserted")}),this.attachEvent("onAfterTaskUpdate",function(a,g){c.setGanttMode("tasks"),c.setUpdated(a,!0),gantt._sendTaskOrder(a,g)}),this.attachEvent("onAfterTaskDelete",function(a,g){c.setGanttMode("tasks"),c.setUpdated(a,!0,"deleted"),"off"==c.updateMode||c._tSend||c.sendAllData()}),this.attachEvent("onAfterLinkUpdate",function(a,g){c.setGanttMode("links"),c.setUpdated(a,!0)}),this.attachEvent("onAfterLinkAdd",function(a,g){c.setGanttMode("links"),c.setUpdated(a,!0,"inserted")}),this.attachEvent("onAfterLinkDelete",function(a,g){c.setGanttMode("links"),c.setUpdated(a,!0,"deleted")}),this.attachEvent("onRowDragEnd",function(a,g){gantt._sendTaskOrder(a,gantt.getTask(a))});var d=null,f=null;this.attachEvent("onTaskIdChange",function(g,j){if(c._waitMode){var k=gantt.getChildren(j);if(k.length){d=d||{};for(var m=0;m<k.length;m++){var p=this.getTask(k[m]);d[p.id]=p}}var h=this.getTask(j),n=this._get_task_links(h);if(n.length){f=f||{};for(var m=0;m<n.length;m++){var e=this.getLink(n[m]);f[e.id]=e}}}}),c.attachEvent("onAfterUpdateFinish",function(){(d||f)&&(gantt.batchUpdate(function(){for(var a in d){gantt.updateTask(d[a].id)}for(var a in f){gantt.updateLink(f[a].id)}d=null,f=null}),d?gantt._dp.setGanttMode("tasks"):gantt._dp.setGanttMode("links"))}),c.attachEvent("onBeforeDataSending",function(){var a=this._serverProcessor;if("REST"==this._tMode){var g=this._ganttMode.substr(0,this._ganttMode.length-1);a=a.substring(0,a.indexOf("?")>-1?a.indexOf("?"):a.length),this.serverProcessor=a+("/"==a.slice(-1)?"":"/")+g}else{this.serverProcessor=a+gantt._urlSeparator(a)+"gantt_mode="+this._ganttMode}return !0}),this._init_dp_live_update_hooks(c);var b=c.afterUpdate;c.afterUpdate=function(){var h;h=3==arguments.length?arguments[1]:arguments[4];var j=c._ganttMode,a=h.filePath;j="REST"!=this._tMode?-1!=a.indexOf("gantt_mode=links")?"links":"tasks":a.indexOf("/link")>a.indexOf("/task")?"links":"tasks",c.setGanttMode(j);var g=b.apply(c,arguments);return c.setGanttMode(j),g},c._getRowData=gantt.bind(function(l,m){var g;g="tasks"==c._ganttMode?this.isTaskExists(l)?this.getTask(l):{id:l}:this.isLinkExists(l)?this.getLink(l):{id:l},g=gantt.copy(g);var h={};for(var j in g){if("$"!=j.substr(0,1)){var k=g[j];k instanceof Date?h[j]=this.templates.xml_format(k):null===k?h[j]="":h[j]=k}}return g.$no_start&&(g.start_date="",g.duration=""),g.$no_end&&(g.end_date="",g.duration=""),h[c.action_param]=this.getUserData(l,c.action_param),h},this),this._change_id=gantt.bind(function(a,g){"tasks"!=c._ganttMode?this.changeLinkId(a,g):this.changeTaskId(a,g)},this),this._row_style=function(h,i){if("tasks"==c._ganttMode&&gantt.isTaskExists(h)){var g=gantt.getTask(h);g.$dataprocessor_class=i,gantt.refreshTask(h)}},this._delete_task=function(a,g){},this._dp=c},gantt.getUserData=function(a,b){return this.userdata||(this.userdata={}),this.userdata[a]&&this.userdata[a][b]?this.userdata[a][b]:""},gantt.setUserData=function(a,b,c){this.userdata||(this.userdata={}),this.userdata[a]||(this.userdata[a]={}),this.userdata[a][b]=c},gantt._init_link=function(a){return gantt.defined(a.id)||(a.id=gantt.uid()),a},gantt._sync_links=function(){for(var d=null,f=0,g=this._order_full.length;g>f;f++){d=this._pull[this._order_full[f]],d.$source=[],d.$target=[]}this._links=[];for(var b in this._lpull){var c=this._lpull[b];this._links.push(c),this._pull[c.source]&&this._pull[c.source].$source.push(b),this._pull[c.target]&&this._pull[c.target].$target.push(b)}},gantt.getLink=function(a){return gantt.assert(this._lpull[a],"Link doesn't exist"),this._lpull[a]},gantt.getLinks=function(){var a=[];for(var b in gantt._lpull){a.push(gantt._lpull[b])}return a},gantt.isLinkExists=function(a){return gantt.defined(this._lpull[a])},gantt.addLink=function(a){return a=this._init_link(a),this.callEvent("onBeforeLinkAdd",[a.id,a])===!1?!1:(this._lpull[a.id]=a,this._sync_links(),this._render_link(a.id),this.callEvent("onAfterLinkAdd",[a.id,a]),a.id)},gantt.updateLink=function(a,b){return gantt.defined(b)||(b=this.getLink(a)),this.callEvent("onBeforeLinkUpdate",[a,b])===!1?!1:(this._lpull[a]=b,this._sync_links(),this._render_link(a),this.callEvent("onAfterLinkUpdate",[a,b]),!0)},gantt.deleteLink=function(a){return this._deleteLink(a)},gantt._deleteLink=function(a,b){var c=this.getLink(a);return b||this.callEvent("onBeforeLinkDelete",[a,c])!==!1?(delete this._lpull[a],this._sync_links(),this.refreshLink(a),b||this.callEvent("onAfterLinkDelete",[a,c]),!0):!1},gantt.changeLinkId=function(a,b){this._lpull[a]&&(this._lpull[b]=this._lpull[a],this._lpull[b].id=b,delete this._lpull[a],this._sync_links(),this.callEvent("onLinkIdChange",[a,b]))},gantt.getChildren=function(a){return gantt.defined(this._branches[a])?this._branches[a]:[]},gantt.hasChild=function(a){return gantt.defined(this._branches[a])&&this._branches[a].length},gantt.refreshData=function(){this._render_data()},gantt._isTask=function(a){return !(a.type&&a.type==gantt.config.types.project||a.$no_start||a.$no_end)},gantt._isProject=function(a){return !this._isTask(a)},gantt._configure=function(c,d,f){for(var b in d){("undefined"==typeof c[b]||f)&&(c[b]=d[b])}},gantt._init_skin=function(){gantt._get_skin(!1),gantt._init_skin=function(){}},gantt._get_skin=function(d){if(!gantt.skin||d){for(var g=document.getElementsByTagName("link"),h=0;h<g.length;h++){var b=g[h].href.match("dhtmlxgantt_([a-z]+).css");if(b){gantt.skin=b[1];break}}}gantt.skin||(gantt.skin="terrace");var c=gantt.skins[gantt.skin];this._configure(gantt.config,c.config,d);var f=gantt.getGridColumns();f[1]&&"undefined"==typeof f[1].width&&(f[1].width=c._second_column_width),f[2]&&"undefined"==typeof f[2].width&&(f[2].width=c._third_column_width),c._lightbox_template&&(gantt._lightbox_template=c._lightbox_template),gantt.resetLightbox()},gantt.resetSkin=function(){this.skin="",this._get_skin(!0)},gantt.skins={},gantt._lightbox_methods={},gantt._lightbox_template="<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span></div><div class='gantt_cal_larea'></div>",gantt.showLightbox=function(a){if(a&&!gantt._is_readonly(this.getTask(a))&&this.callEvent("onBeforeLightbox",[a])){var b=this.getTask(a),c=this.getLightbox(this._get_safe_type(b.type));this._center_lightbox(c),this.showCover(),this._fill_lightbox(a,c),this.callEvent("onLightbox",[a])}},gantt._get_timepicker_step=function(){if(this.config.round_dnd_dates){var a=gantt._tasks,b=this._get_line(a.unit)*a.step/60;return(b>=1440||!this._is_chart_visible())&&(b=this.config.time_step),b}return this.config.time_step},gantt.getLabel=function(d,g){for(var h=this._get_typed_lightbox_config(),b=0;b<h.length;b++){if(h[b].map_to==d){for(var c=h[b].options,f=0;f<c.length;f++){if(c[f].key==g){return c[f].label}}}}return""},gantt.updateCollection=function(a,b){b=b.slice(0);var c=gantt.serverList(a);return c?(c.splice(0,c.length),c.push.apply(c,b||[]),void gantt.resetLightbox()):!1},gantt.getLightboxType=function(){return this._get_safe_type(this._lightbox_type)},gantt.getLightbox=function(m){if(void 0===m&&(m=this.getLightboxType()),!this._lightbox||this.getLightboxType()!=this._get_safe_type(m)){this._lightbox_type=this._get_safe_type(m);var h=document.createElement("DIV");h.className="gantt_cal_light";var f=this._is_lightbox_timepicker();(gantt.config.wide_form||f)&&(h.className+=" gantt_cal_light_wide"),f&&(gantt.config.wide_form=!0,h.className+=" gantt_cal_light_full"),h.style.visibility="hidden";for(var k=this._lightbox_template,g=this.config.buttons_left,p=0;p<g.length;p++){var b=this.config._migrate_buttons[g[p]]?this.config._migrate_buttons[g[p]]:g[p];k+="<div class='gantt_btn_set gantt_left_btn_set "+b+"_set'><div dhx_button='1' class='"+b+"'></div><div>"+this.locale.labels[b]+"</div></div>"}g=this.config.buttons_right;for(var p=0;p<g.length;p++){var b=this.config._migrate_buttons[g[p]]?this.config._migrate_buttons[g[p]]:g[p];k+="<div class='gantt_btn_set gantt_right_btn_set "+b+"_set' style='float:right;'><div dhx_button='1' class='"+b+"'></div><div>"+this.locale.labels[b]+"</div></div>"}k+="</div>",h.innerHTML=k,gantt.config.drag_lightbox&&(h.firstChild.onmousedown=gantt._ready_to_dnd,h.firstChild.onselectstart=function(){return !1},h.firstChild.style.cursor="pointer",gantt._init_dnd_events()),document.body.insertBefore(h,document.body.firstChild),this._lightbox=h;var c=this._get_typed_lightbox_config(m);k=this._render_sections(c);for(var l=h.getElementsByTagName("div"),p=0;p<l.length;p++){var j=l[p];if("gantt_cal_larea"==j.className){j.innerHTML=k;break}}this.resizeLightbox(),this._init_lightbox_events(this),h.style.display="none",h.style.visibility="visible"}return this._lightbox},gantt._render_sections=function(d){for(var g="",h=0;h<d.length;h++){var b=this.form_blocks[d[h].type];if(b){d[h].id="area_"+this.uid();var c=d[h].hidden?" style='display:none'":"",f="";d[h].button&&(f="<div class='gantt_custom_button' index='"+h+"'><div class='gantt_custom_button_"+d[h].button+"'></div><div>"+this.locale.labels["button_"+d[h].button]+"</div></div>"),this.config.wide_form&&(g+="<div class='gantt_wrap_section' "+c+">"),g+="<div id='"+d[h].id+"' class='gantt_cal_lsection'>"+f+this.locale.labels["section_"+d[h].name]+"</div>"+b.render.call(this,d[h]),g+="</div>"}}return g},gantt.resizeLightbox=function(){var a=this._lightbox;if(a){var b=a.childNodes[1];b.style.height="0px",b.style.height=b.scrollHeight+"px",a.style.height=b.scrollHeight+this.config.lightbox_additional_height+"px",b.style.height=b.scrollHeight+"px"}},gantt._center_lightbox=function(c){if(c){c.style.display="block";var d=window.pageYOffset||document.body.scrollTop||document.documentElement.scrollTop,f=window.pageXOffset||document.body.scrollLeft||document.documentElement.scrollLeft,b=window.innerHeight||document.documentElement.clientHeight;d?c.style.top=Math.round(d+Math.max((b-c.offsetHeight)/2,0))+"px":c.style.top=Math.round(Math.max((b-c.offsetHeight)/2,0)+9)+"px",document.documentElement.scrollWidth>document.body.offsetWidth?c.style.left=Math.round(f+(document.body.offsetWidth-c.offsetWidth)/2)+"px":c.style.left=Math.round((document.body.offsetWidth-c.offsetWidth)/2)+"px"}},gantt.showCover=function(){if(!this._cover){this._cover=document.createElement("DIV"),this._cover.className="gantt_cal_cover";var a=void 0!==document.height?document.height:document.body.offsetHeight,b=document.documentElement?document.documentElement.scrollHeight:0;this._cover.style.height=Math.max(a,b)+"px",document.body.appendChild(this._cover)}},gantt._init_lightbox_events=function(){gantt.lightbox_events={},gantt.lightbox_events.gantt_save_btn=function(a){gantt._save_lightbox()},gantt.lightbox_events.gantt_delete_btn=function(a){gantt.callEvent("onLightboxDelete",[gantt._lightbox_id])&&(gantt.isTaskExists(gantt._lightbox_id)?gantt.$click.buttons["delete"](gantt._lightbox_id):gantt.hideLightbox())},gantt.lightbox_events.gantt_cancel_btn=function(a){gantt._cancel_lightbox()},gantt.lightbox_events["default"]=function(d,h){if(h.getAttribute("dhx_button")){gantt.callEvent("onLightboxButton",[h.className,h,d])}else{var j,b,c,f=gantt._getClassName(h);-1!=f.indexOf("gantt_custom_button")&&(-1!=f.indexOf("gantt_custom_button_")?(j=h.parentNode.getAttribute("index"),c=h.parentNode.parentNode):(j=h.getAttribute("index"),c=h.parentNode,h=h.firstChild));var g=gantt._get_typed_lightbox_config();j&&(b=gantt.form_blocks[g[j].type],b.button_click(j,h,c,c.nextSibling))}},this.event(gantt.getLightbox(),"click",function(c){c=c||window.event;var d=c.target?c.target:c.srcElement,f=gantt._getClassName(d);if(f||(d=d.previousSibling,f=gantt._getClassName(d)),d&&f&&0===f.indexOf("gantt_btn_set")&&(d=d.firstChild,f=gantt._getClassName(d)),d&&f){var b=gantt.defined(gantt.lightbox_events[d.className])?gantt.lightbox_events[d.className]:gantt.lightbox_events["default"];return b(c,d)}return !1}),gantt.getLightbox().onkeydown=function(a){switch((a||event).keyCode){case gantt.keys.edit_save:if((a||event).shiftKey){return}gantt._save_lightbox();break;case gantt.keys.edit_cancel:gantt._cancel_lightbox()}}},gantt._cancel_lightbox=function(){var a=this.getLightboxValues();this.callEvent("onLightboxCancel",[this._lightbox_id,a.$new]),gantt.isTaskExists(a.id)&&a.$new&&this._deleteTask(a.id,!0),this.refreshData(),this.hideLightbox()},gantt._save_lightbox=function(){var a=this.getLightboxValues();this.callEvent("onLightboxSave",[this._lightbox_id,a,!!a.$new])&&(a.$new?(delete a.$new,this._replace_branch_child(this.getParent(a.id),a.id),this.addTask(a)):this.isTaskExists(a.id)&&(this.mixin(this.getTask(a.id),a,!0),this.updateTask(a.id)),this.refreshData(),this.hideLightbox())},gantt._resolve_default_mapping=function(a){var b=a.map_to,c={time:!0,time_optional:!0,duration:!0,duration_optional:!0};return c[a.type]&&("auto"==a.map_to?b={start_date:"start_date",end_date:"end_date",duration:"duration"}:"string"==typeof a.map_to&&(b={start_date:a.map_to})),b},gantt.getLightboxValues=function(){var d={};gantt.isTaskExists(this._lightbox_id)&&(d=this.mixin({},this.getTask(this._lightbox_id)));for(var h=this._get_typed_lightbox_config(),k=0;k<h.length;k++){var b=document.getElementById(h[k].id);b=b?b.nextSibling:b;var c=this.form_blocks[h[k].type];if(c){var f=c.get_value.call(this,b,d,h[k]),g=gantt._resolve_default_mapping(h[k]);if("string"==typeof g&&"auto"!=g){d[g]=f}else{if("object"==typeof g){for(var j in g){g[j]&&(d[g[j]]=f[j])}}}}}return d},gantt.hideLightbox=function(){var a=this.getLightbox();a&&(a.style.display="none"),this._lightbox_id=null,this.hideCover(),this.callEvent("onAfterLightbox",[])},gantt.hideCover=function(){this._cover&&this._cover.parentNode.removeChild(this._cover),this._cover=null},gantt.resetLightbox=function(){gantt._lightbox&&!gantt._custom_lightbox&&gantt._lightbox.parentNode.removeChild(gantt._lightbox),gantt._lightbox=null},gantt._set_lightbox_values=function(q,j){var f=q,m=j.getElementsByTagName("span");gantt.templates.lightbox_header?(m[1].innerHTML="",m[2].innerHTML=gantt.templates.lightbox_header(f.start_date,f.end_date,f)):(m[1].innerHTML=this.templates.task_time(f.start_date,f.end_date,f),m[2].innerHTML=(this.templates.task_text(f.start_date,f.end_date,f)||"").substr(0,70));for(var h=this._get_typed_lightbox_config(this.getLightboxType()),u=0;u<h.length;u++){var b=h[u];if(this.form_blocks[b.type]){var c=document.getElementById(b.id).nextSibling,p=this.form_blocks[b.type],k=gantt._resolve_default_mapping(h[u]),g=this.defined(f[k])?f[k]:b.default_value;p.set_value.call(gantt,c,g,f,b),b.focus&&p.focus.call(gantt,c)}}q.id&&(gantt._lightbox_id=q.id)},gantt._fill_lightbox=function(a,b){var c=this.getTask(a);this._set_lightbox_values(c,b)},gantt.getLightboxSection=function(d){var h=this._get_typed_lightbox_config(),k=0;for(k;k<h.length&&h[k].name!=d;k++){}var b=h[k];if(!b){return null}this._lightbox||this.getLightbox();var c=document.getElementById(b.id),f=c.nextSibling,g={section:b,header:c,node:f,getValue:function(a){return gantt.form_blocks[b.type].get_value.call(gantt,f,a||{},b)},setValue:function(a,i){return gantt.form_blocks[b.type].set_value.call(gantt,f,a,i||{},b)}},j=this._lightbox_methods["get_"+b.type+"_control"];return j?j(g):g},gantt._lightbox_methods.get_template_control=function(a){return a.control=a.node,a},gantt._lightbox_methods.get_select_control=function(a){return a.control=a.node.getElementsByTagName("select")[0],a},gantt._lightbox_methods.get_textarea_control=function(a){return a.control=a.node.getElementsByTagName("textarea")[0],a},gantt._lightbox_methods.get_time_control=function(a){return a.control=a.node.getElementsByTagName("select"),a},gantt._init_dnd_events=function(){this.event(document.body,"mousemove",gantt._move_while_dnd),this.event(document.body,"mouseup",gantt._finish_dnd),gantt._init_dnd_events=function(){}},gantt._move_while_dnd=function(a){if(gantt._dnd_start_lb){document.gantt_unselectable||(document.body.className+=" gantt_unselectable",document.gantt_unselectable=!0);var b=gantt.getLightbox(),c=a&&a.target?[a.pageX,a.pageY]:[event.clientX,event.clientY];b.style.top=gantt._lb_start[1]+c[1]-gantt._dnd_start_lb[1]+"px",b.style.left=gantt._lb_start[0]+c[0]-gantt._dnd_start_lb[0]+"px"}},gantt._ready_to_dnd=function(a){var b=gantt.getLightbox();gantt._lb_start=[parseInt(b.style.left,10),parseInt(b.style.top,10)],gantt._dnd_start_lb=a&&a.target?[a.pageX,a.pageY]:[event.clientX,event.clientY]},gantt._finish_dnd=function(){gantt._lb_start&&(gantt._lb_start=gantt._dnd_start_lb=!1,document.body.className=document.body.className.replace(" gantt_unselectable",""),document.gantt_unselectable=!1)},gantt._focus=function(a,b){if(a&&a.focus){if(gantt.config.touch){}else{try{b&&a.select&&a.select(),a.focus()}catch(c){}}}},gantt.form_blocks={getTimePicker:function(w,J){var B=w.time_format;if(!B){var B=["%d","%m","%Y"];gantt._get_line(gantt._tasks.unit)<gantt._get_line("day")&&B.push("%H:%i")}w._time_format_order={size:0};var N=this.config,F=this.date.date_part(new Date(gantt._min_date.valueOf())),x=1440,y=0;gantt.config.limit_time_select&&(x=60*N.last_hour+1,y=60*N.first_hour,F.setHours(N.first_hour));for(var A="",O=0;O<B.length;O++){var K=B[O];O>0&&(A+=" ");var D="";switch(K){case"%Y":w._time_format_order[2]=O,w._time_format_order.size++;var H,G,L,q;w.year_range&&(isNaN(w.year_range)?w.year_range.push&&(L=w.year_range[0],q=w.year_range[1]):H=w.year_range),H=H||10,G=G||Math.floor(H/2),L=L||F.getFullYear()-G,q=q||L+H;for(var I=L;q>I;I++){D+="<option value='"+I+"'>"+I+"</option>"}break;case"%m":w._time_format_order[1]=O,w._time_format_order.size++;for(var I=0;12>I;I++){D+="<option value='"+I+"'>"+this.locale.date.month_full[I]+"</option>"}break;case"%d":w._time_format_order[0]=O,w._time_format_order.size++;for(var I=1;32>I;I++){D+="<option value='"+I+"'>"+I+"</option>"}break;case"%H:%i":w._time_format_order[3]=O,w._time_format_order.size++;var I=y,z=F.getDate();for(w._time_values=[];x>I;){var j=this.templates.time_picker(F);D+="<option value='"+I+"'>"+j+"</option>",w._time_values.push(I),F.setTime(F.valueOf()+60*this._get_timepicker_step()*1000);var C=F.getDate()!=z?1:0;I=24*C*60+60*F.getHours()+F.getMinutes()}}if(D){var E=w.readonly?"disabled='disabled'":"",M=J?" style='display:none'":"";A+="<select "+E+M+">"+D+"</select>"}}return A},_fill_lightbox_select:function(d,h,j,b,c){if(d[h+b[0]].value=j.getDate(),d[h+b[1]].value=j.getMonth(),d[h+b[2]].value=j.getFullYear(),gantt.defined(b[3])){var f=60*j.getHours()+j.getMinutes();f=Math.round(f/gantt._get_timepicker_step())*gantt._get_timepicker_step();var g=d[h+b[3]];g.value=f,g.setAttribute("data-value",f)}},template:{render:function(a){var b=(a.height||"30")+"px";return"<div class='gantt_cal_ltext gantt_cal_template' style='height:"+b+";'></div>"},set_value:function(c,d,f,b){c.innerHTML=d||""},get_value:function(a,b,c){return a.innerHTML||""},focus:function(a){}},textarea:{render:function(a){var b=(a.height||"130")+"px";return"<div class='gantt_cal_ltext' style='height:"+b+";'><textarea></textarea></div>"},set_value:function(a,b,c){a.firstChild.value=b||""},get_value:function(a,b){return a.firstChild.value},focus:function(a){var b=a.firstChild;gantt._focus(b,!0)}},select:{render:function(c){for(var d=(c.height||"23")+"px",f="<div class='gantt_cal_ltext' style='height:"+d+";'><select style='width:100%;'>",b=0;b<c.options.length;b++){f+="<option value='"+c.options[b].key+"'>"+c.options[b].label+"</option>"}return f+="</select></div>"},set_value:function(d,f,g,b){var c=d.firstChild;!c._dhx_onchange&&b.onchange&&(c.onchange=b.onchange,c._dhx_onchange=!0),"undefined"==typeof f&&(f=(c.options[0]||{}).value),c.value=f||""},get_value:function(a,b){return a.firstChild.value},focus:function(a){var b=a.firstChild;gantt._focus(b,!0)}},time:{render:function(a){var b=this.form_blocks.getTimePicker.call(this,a),c=["<div style='height:"+(a.height||30)+"px;padding-top:0px;font-size:inherit;text-align:center;' class='gantt_section_time'>"];return c.push(b),a.single_date?(b=this.form_blocks.getTimePicker.call(this,a,!0),c.push("<span></span>")):c.push("<span style='font-weight:normal; font-size:10pt;'> &nbsp;&ndash;&nbsp; </span>"),c.push(b),c.push("</div>"),c.join("")},set_value:function(v,m,f,q){var j=q,w=v.getElementsByTagName("select"),b=q._time_format_order;q._time_format_size;if(j.auto_end_date){for(var c=function(){h=new Date(w[b[2]].value,w[b[1]].value,w[b[0]].value,0,0),k=gantt.calculateEndDate(h,1),this.form_blocks._fill_lightbox_select(w,b.size,k,b,j)},u=0;4>u;u++){w[u].onchange=c}}var p=gantt._resolve_default_mapping(q);"string"==typeof p&&(p={start_date:p});var h=f[p.start_date]||new Date,k=f[p.end_date]||gantt.calculateEndDate(h,1);this.form_blocks._fill_lightbox_select(w,0,h,b,j),this.form_blocks._fill_lightbox_select(w,b.size,k,b,j)},get_value:function(v,m,f){var q=v.getElementsByTagName("select"),j=f._time_format_order,w=0,b=0;if(gantt.defined(j[3])){var c=parseInt(q[j[3]].value,10);w=Math.floor(c/60),b=c%60}var u=new Date(q[j[2]].value,q[j[1]].value,q[j[0]].value,w,b);if(w=b=0,gantt.defined(j[3])){var c=parseInt(q[j.size+j[3]].value,10);w=Math.floor(c/60),b=c%60}var p=new Date(q[j[2]+j.size].value,q[j[1]+j.size].value,q[j[0]+j.size].value,w,b);u>=p&&(p=gantt.date.add(u,gantt._get_timepicker_step(),"minute"));var h=gantt._resolve_default_mapping(f),k={start_date:new Date(u),end_date:new Date(p)};return"string"==typeof h?k.start_date:k},focus:function(a){gantt._focus(a.getElementsByTagName("select")[0])}},duration:{render:function(d){var h=this.form_blocks.getTimePicker.call(this,d);h="<div class='gantt_time_selects'>"+h+"</div>";var j=this.locale.labels[this.config.duration_unit+"s"],b=d.single_date?' style="display:none"':"",c=d.readonly?" disabled='disabled'":"",f="<div class='gantt_duration' "+b+"><input type='button' class='gantt_duration_dec' value='-'"+c+"><input type='text' value='5' class='gantt_duration_value'"+c+"><input type='button' class='gantt_duration_inc' value='+'"+c+"> "+j+" <span></span></div>",g="<div style='height:"+(d.height||30)+"px;padding-top:0px;font-size:inherit;' class='gantt_section_time'>"+h+" "+f+"</div>";return g},set_value:function(F,z,m,C){function v(){var c=gantt.form_blocks.duration._get_start_date.call(gantt,F,C),d=gantt.form_blocks.duration._get_duration.call(gantt,F,C),a=gantt.calculateEndDate(c,d);x.innerHTML=gantt.templates.task_date(a)}function G(a){var c=A.value;c=parseInt(c,10),window.isNaN(c)&&(c=0),c+=a,1>c&&(c=1),A.value=c,v()}var b=C,k=F.getElementsByTagName("select"),D=F.getElementsByTagName("input"),A=D[1],q=[D[0],D[2]],x=F.getElementsByTagName("span")[0],w=C._time_format_order;q[0].onclick=gantt.bind(function(){G(-1*this.config.duration_step)},this),q[1].onclick=gantt.bind(function(){G(1*this.config.duration_step)},this),k[0].onchange=v,k[1].onchange=v,k[2].onchange=v,k[3]&&(k[3].onchange=v),A.onkeydown=gantt.bind(function(a){a=a||window.event;var c=a.charCode||a.keyCode||a.which;return 40==c?(G(-1*this.config.duration_step),!1):38==c?(G(1*this.config.duration_step),!1):void window.setTimeout(function(d){v()},1)},this),A.onchange=gantt.bind(function(a){v()},this);var B=gantt._resolve_default_mapping(C);"string"==typeof B&&(B={start_date:B});var E=m[B.start_date]||new Date,y=m[B.end_date]||gantt.calculateEndDate(E,1),j=Math.round(m[B.duration])||gantt.calculateDuration(E,y);gantt.form_blocks._fill_lightbox_select(k,0,E,w,b),A.value=j,v()},_get_start_date:function(d,h){var k=d.getElementsByTagName("select"),b=h._time_format_order,c=0,f=0;if(gantt.defined(b[3])){var g=k[b[3]],j=parseInt(g.value,10);isNaN(j)&&g.hasAttribute("data-value")&&(j=parseInt(g.getAttribute("data-value"),10)),c=Math.floor(j/60),f=j%60}return new Date(k[b[2]].value,k[b[1]].value,k[b[0]].value,c,f)},_get_duration:function(a,b){var c=a.getElementsByTagName("input")[1];return c=parseInt(c.value,10),(!c||window.isNaN(c))&&(c=1),0>c&&(c*=-1),c},get_value:function(d,h,k){var b=gantt.form_blocks.duration._get_start_date(d,k),c=gantt.form_blocks.duration._get_duration(d,k),f=gantt.calculateEndDate(b,c),g=gantt._resolve_default_mapping(k),j={start_date:new Date(b),end_date:new Date(f),duration:c};return"string"==typeof g?j.start_date:j},focus:function(a){gantt._focus(a.getElementsByTagName("select")[0])}},parent:{_filter:function(d,g,h){var b=g.filter||function(){return !0};d=d.slice(0);for(var c=0;c<d.length;c++){var f=d[c];(f.id==h||gantt.isChildOf(f.id,h)||b(f.id,f)===!1)&&(d.splice(c,1),c--)}return d},_display:function(d,h){var j=[],b=[];h&&(j=gantt.getTaskByTime(),d.allow_root&&j.unshift({id:gantt.config.root_id,text:d.root_label||""}),j=this._filter(j,d,h),d.sort&&j.sort(d.sort));for(var c=d.template||gantt.templates.task_text,f=0;f<j.length;f++){var g=c.apply(gantt,[j[f].start_date,j[f].end_date,j[f]]);void 0===g&&(g=""),b.push({key:j[f].id,label:g})}return d.options=b,d.map_to=d.map_to||"parent",gantt.form_blocks.select.render.apply(this,arguments)},render:function(a){return gantt.form_blocks.parent._display(a,!1)},set_value:function(d,g,h,b){var c=document.createElement("div");c.innerHTML=gantt.form_blocks.parent._display(b,h.id);var f=c.removeChild(c.firstChild);return d.onselect=null,d.parentNode.replaceChild(f,d),gantt.form_blocks.select.set_value.apply(gantt,[f,g,h,b])},get_value:function(){return gantt.form_blocks.select.get_value.apply(gantt,arguments)},focus:function(){return gantt.form_blocks.select.focus.apply(gantt,arguments)}}},gantt._is_lightbox_timepicker=function(){for(var a=this._get_typed_lightbox_config(),b=0;b<a.length;b++){if("time"==a[b].name&&"time"==a[b].type){return !0}}return !1},gantt._dhtmlx_confirm=function(d,f,g,b){if(!d){return g()}var c={text:d};f&&(c.title=f),b&&(c.ok=b),g&&(c.callback=function(a){a&&g()}),gantt.confirm(c)},gantt._get_typed_lightbox_config=function(a){void 0===a&&(a=this.getLightboxType());var b=this._get_type_name(a);return gantt.config.lightbox[b+"_sections"]?gantt.config.lightbox[b+"_sections"]:gantt.config.lightbox.sections},gantt._silent_redraw_lightbox=function(d){var h=this.getLightboxType();if(this.getState().lightbox){var j=this.getState().lightbox,b=this.getLightboxValues(),c=this.copy(this.getTask(j));this.resetLightbox();var f=this.mixin(c,b,!0),g=this.getLightbox(d?d:void 0);this._center_lightbox(this.getLightbox()),this._set_lightbox_values(f,g)}else{this.resetLightbox(),this.getLightbox(d?d:void 0)}this.callEvent("onLightboxChange",[h,this.getLightboxType()])},gantt._extend_to_optional=function(a){var b=a,c={render:b.render,focus:b.focus,set_value:function(g,d,f,h){var j=gantt._resolve_default_mapping(h);if(!f[j.start_date]||"start_date"==j.start_date&&this._isAllowedUnscheduledTask(f)){c.disable(g,h);var k={};for(var e in j){k[j[e]]=f[e]}return b.set_value.call(gantt,g,d,k,h)}return c.enable(g,h),b.set_value.call(gantt,g,d,f,h)},get_value:function(e,f,d){return d.disabled?{start_date:null}:b.get_value.call(gantt,e,f,d)},update_block:function(g,h){if(gantt.callEvent("onSectionToggle",[gantt._lightbox_id,h]),g.style.display=h.disabled?"none":"block",h.button){var j=g.previousSibling.firstChild.firstChild,d=gantt.locale.labels,f=h.disabled?d[h.name+"_enable_button"]:d[h.name+"_disable_button"];j.nextSibling.innerHTML=f}gantt.resizeLightbox()},disable:function(d,f){f.disabled=!0,c.update_block(d,f)},enable:function(d,f){f.disabled=!1,c.update_block(d,f)},button_click:function(g,j,d,f){if(gantt.callEvent("onSectionButton",[gantt._lightbox_id,d])!==!1){var h=gantt._get_typed_lightbox_config()[g];h.disabled?c.enable(f,h):c.disable(f,h)}}};return c},gantt.form_blocks.duration_optional=gantt._extend_to_optional(gantt.form_blocks.duration),gantt.form_blocks.time_optional=gantt._extend_to_optional(gantt.form_blocks.time),gantt.dataProcessor=function(a){return this.serverProcessor=a,this.action_param="!nativeeditor_status",this.object=null,this.updatedRows=[],this.autoUpdate=!0,this.updateMode="cell",this._tMode="GET",this._headers=null,this._payload=null,this.post_delim="_",this._waitMode=0,this._in_progress={},this._invalid={},this.mandatoryFields=[],this.messages=[],this.styles={updated:"font-weight:bold;",inserted:"font-weight:bold;",deleted:"text-decoration : line-through;",invalid:"background-color:FFE0E0;",invalid_cell:"border-bottom:2px solid red;",error:"color:red;",clear:"font-weight:normal;text-decoration:none;"},this.enableUTFencoding(!0),gantt._eventable(this),this},gantt.dataProcessor.prototype={setTransactionMode:function(a,b){"object"==typeof a?(this._tMode=a.mode||this._tMode,this._headers=this._headers||a.headers,this._payload=this._payload||a.payload):(this._tMode=a,this._tSend=b),"REST"==this._tMode&&(this._tSend=!1,this._endnm=!0)},escape:function(a){return this._utf?encodeURIComponent(a):escape(a)},enableUTFencoding:function(a){this._utf=!!a},setDataColumns:function(a){this._columns="string"==typeof a?a.split(","):a},getSyncState:function(){return !this.updatedRows.length},enableDataNames:function(a){this._endnm=!!a},enablePartialDataSend:function(a){this._changed=!!a},setUpdateMode:function(a,b){this.autoUpdate="cell"==a,this.updateMode=a,this.dnd=b},ignore:function(a,b){this._silent_mode=!0,a.call(b||window),this._silent_mode=!1},setUpdated:function(d,f,g){if(!this._silent_mode){var b=this.findRow(d);g=g||"updated";var c=this.obj.getUserData(d,this.action_param);c&&"updated"==g&&(g=c),f?(this.set_invalid(d,!1),this.updatedRows[b]=d,this.obj.setUserData(d,this.action_param,g),this._in_progress[d]&&(this._in_progress[d]="wait")):this.is_invalid(d)||(this.updatedRows.splice(b,1),this.obj.setUserData(d,this.action_param,"")),f||this._clearUpdateFlag(d),this.markRow(d,f,g),f&&this.autoUpdate&&this.sendData(d)}},_clearUpdateFlag:function(a){},markRow:function(d,g,h){var b="",c=this.is_invalid(d);if(c&&(b=this.styles[c],g=!0),this.callEvent("onRowMark",[d,g,h,c])&&(b=this.styles[g?h:"clear"]+b,this.obj[this._methods[0]](d,b),c&&c.details)){b+=this.styles[c+"_cell"];for(var f=0;f<c.details.length;f++){c.details[f]&&this.obj[this._methods[1]](d,f,b)}}},getState:function(a){return this.obj.getUserData(a,this.action_param)},is_invalid:function(a){return this._invalid[a]},set_invalid:function(a,b,c){c&&(b={value:b,details:c,toString:function(){return this.value.toString()}}),this._invalid[a]=b},checkBeforeUpdate:function(a){return !0},sendData:function(a){return !this._waitMode||"tree"!=this.obj.mytype&&!this.obj._h2?(this.obj.editStop&&this.obj.editStop(),"undefined"==typeof a||this._tSend?this.sendAllData():this._in_progress[a]?!1:(this.messages=[],!this.checkBeforeUpdate(a)&&this.callEvent("onValidationError",[a,this.messages])?!1:void this._beforeSendData(this._getRowData(a),a))):void 0},_beforeSendData:function(a,b){return this.callEvent("onBeforeUpdate",[b,this.getState(b),a])?void this._sendData(a,b):!1},serialize:function(d,f){if("string"==typeof d){return d}if("undefined"!=typeof f){return this.serialize_one(d,"")}var g=[],b=[];for(var c in d){d.hasOwnProperty(c)&&(g.push(this.serialize_one(d[c],c+this.post_delim)),b.push(c))}return g.push("ids="+this.escape(b.join(","))),gantt.security_key&&g.push("dhx_security="+gantt.security_key),g.join("&")},serialize_one:function(c,d){if("string"==typeof c){return c}var f=[];for(var b in c){if(c.hasOwnProperty(b)){if(("id"==b||b==this.action_param)&&"REST"==this._tMode){continue}f.push(this.escape((d||"")+b)+"="+this.escape(c[b]))}}return f.join("&")},_sendData:function(m,h){if(m){if(!this.callEvent("onBeforeDataSending",h?[h,this.getState(h),m]:[null,null,m])){return !1}h&&(this._in_progress[h]=(new Date).valueOf());var f=this,k=function(d){var e=[];if(h){e.push(h)}else{if(m){for(var n in m){e.push(n)}}}return f.afterUpdate(f,d,e)},g=this.serverProcessor+(this._user?gantt._urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+this.obj.getUserData(0,"version")].join("&"):"");if("GET"==this._tMode){gantt.ajax.get(g+(-1!=g.indexOf("?")?"&":"?")+this.serialize(m,h),k)}else{if("POST"==this._tMode){gantt.ajax.post(g,this.serialize(m,h),k)}else{if("REST"==this._tMode){var p=this.getState(h),b=g.replace(/(\&|\?)editing\=true/,""),c="",l="post";if("inserted"==p?c=this.serialize(m,h):"deleted"==p?(l="DELETE",b=b+("/"==b.slice(-1)?"":"/")+h):(l="PUT",c=this.serialize(m,h),b=b+("/"==b.slice(-1)?"":"/")+h),this._payload){for(var j in this._payload){b=b+this._urlSeparator(b)+this.escape(j)+"="+this.escape(this._payload[j])}}gantt.ajax.query({url:b,method:l,headers:this._headers,data:c,callback:k})}}}this._waitMode++}},sendAllData:function(){if(this.updatedRows.length){this.messages=[];for(var a=!0,b=0;b<this.updatedRows.length;b++){a&=this.checkBeforeUpdate(this.updatedRows[b])}if(!a&&!this.callEvent("onValidationError",["",this.messages])){return !1}if(this._tSend){this._sendData(this._getAllData())}else{for(var b=0;b<this.updatedRows.length;b++){if(!this._in_progress[this.updatedRows[b]]){if(this.is_invalid(this.updatedRows[b])){continue}if(this._beforeSendData(this._getRowData(this.updatedRows[b]),this.updatedRows[b]),this._waitMode&&("tree"==this.obj.mytype||this.obj._h2)){return}}}}}},_getAllData:function(d){for(var f={},g=!1,b=0;b<this.updatedRows.length;b++){var c=this.updatedRows[b];this._in_progress[c]||this.is_invalid(c)||this.callEvent("onBeforeUpdate",[c,this.getState(c),this._getRowData(c)])&&(f[c]=this._getRowData(c,c+this.post_delim),g=!0,this._in_progress[c]=(new Date).valueOf())}return g?f:null},setVerificator:function(a,b){this.mandatoryFields[a]=b||function(c){return""!==c}},clearVerificator:function(a){this.mandatoryFields[a]=!1},findRow:function(a){var b=0;for(b=0;b<this.updatedRows.length&&a!=this.updatedRows[b];b++){}return b},defineAction:function(a,b){this._uActions||(this._uActions=[]),this._uActions[a]=b},afterUpdateCallback:function(d,h,j,b){var c=d,f="error"!=j&&"invalid"!=j;if(f||this.set_invalid(d,j),this._uActions&&this._uActions[j]&&!this._uActions[j](b)){return delete this._in_progress[c]}"wait"!=this._in_progress[c]&&this.setUpdated(d,!1);var g=d;switch(j){case"inserted":case"insert":h!=d&&(this.obj[this._methods[2]](d,h),d=h);break;case"delete":case"deleted":return this.obj.setUserData(d,this.action_param,"true_deleted"),this.obj[this._methods[3]](d),delete this._in_progress[c],this.callEvent("onAfterUpdate",[d,j,h,b])}"wait"!=this._in_progress[c]?(f&&this.obj.setUserData(d,this.action_param,""),delete this._in_progress[c]):(delete this._in_progress[c],this.setUpdated(h,!0,this.obj.getUserData(d,this.action_param))),this.callEvent("onAfterUpdate",[g,j,h,b])},afterUpdate:function(v,m,f){if(window.JSON){try{var q=JSON.parse(m.xmlDoc.responseText),j=q.action||this.getState(f)||"updated",w=q.sid||f[0],b=q.tid||f[0];return v.afterUpdateCallback(w,b,j,q),void v.finalizeUpdate()}catch(c){}}var u=gantt.ajax.xmltop("data",m.xmlDoc);if(!u){return this.cleanUpdate(f)}var p=gantt.ajax.xpath("//data/action",u);if(!p.length){return this.cleanUpdate(f)}for(var h=0;h<p.length;h++){var k=p[h],j=k.getAttribute("type"),w=k.getAttribute("sid"),b=k.getAttribute("tid");v.afterUpdateCallback(w,b,j,k)}v.finalizeUpdate()},cleanUpdate:function(a){if(a){for(var b=0;b<a.length;b++){delete this._in_progress[a[b]]}}},finalizeUpdate:function(){this._waitMode&&this._waitMode--,("tree"==this.obj.mytype||this.obj._h2)&&this.updatedRows.length&&this.sendData(),this.callEvent("onAfterUpdateFinish",[]),this.updatedRows.length||this.callEvent("onFullSync",[])},init:function(a){this.obj=a,this.obj._dp_init&&this.obj._dp_init(this)},setOnAfterUpdate:function(a){this.attachEvent("onAfterUpdate",a)},enableDebug:function(a){},setOnBeforeUpdateHandler:function(a){this.attachEvent("onBeforeDataSending",a)},setAutoUpdate:function(a,b){a=a||2000,this._user=b||(new Date).valueOf(),this._need_update=!1,this._update_busy=!1,this.attachEvent("onAfterUpdate",function(f,g,h,d){this.afterAutoUpdate(f,g,h,d)}),this.attachEvent("onFullSync",function(){this.fullSync()});var c=this;window.setInterval(function(){c.loadUpdate()},a)},afterAutoUpdate:function(c,d,f,b){return"collision"==d?(this._need_update=!0,!1):!0},fullSync:function(){return this._need_update&&(this._need_update=!1,this.loadUpdate()),!0},getUpdates:function(a,b){return this._update_busy?!1:(this._update_busy=!0,void gantt.ajax.get(a,b))},_v:function(a){return a.firstChild?a.firstChild.nodeValue:""},_a:function(a){for(var b=[],c=0;c<a.length;c++){b[c]=this._v(a[c])}return b},loadUpdate:function(){var a=this,b=this.obj.getUserData(0,"version"),c=this.serverProcessor+gantt._urlSeparator(this.serverProcessor)+["dhx_user="+this._user,"dhx_version="+b].join("&");c=c.replace("editing=true&",""),this.getUpdates(c,function(j){var l=gantt.ajax.xpath("//userdata",j);a.obj.setUserData(0,"version",a._v(l[0]));var d=gantt.ajax.xpath("//update",j);if(d.length){a._silent_mode=!0;for(var f=0;f<d.length;f++){var g=d[f].getAttribute("status"),h=d[f].getAttribute("id"),k=d[f].getAttribute("parent");switch(g){case"inserted":a.callEvent("insertCallback",[d[f],h,k]);break;case"updated":a.callEvent("updateCallback",[d[f],h,k]);break;case"deleted":a.callEvent("deleteCallback",[d[f],h,k])}}a._silent_mode=!1}a._update_busy=!1,a=null})}},gantt._init_dp_live_update_hooks=function(a){a.attachEvent("insertCallback",gantt._insert_callback),a.attachEvent("updateCallback",gantt._update_callback),a.attachEvent("deleteCallback",gantt._delete_callback)},gantt._update_callback=function(d,g){var h=d.data||gantt.xml._xmlNodeToJSON(d.firstChild);if(gantt.isTaskExists(g)){var b=gantt.getTask(g);for(var c in h){var f=h[c];switch(c){case"id":continue;case"start_date":case"end_date":f=gantt.templates.xml_date(f);break;case"duration":b.end_date=gantt.calculateEndDate(b.start_date,f)}b[c]=f}gantt.updateTask(g),gantt.refreshData()}},gantt._insert_callback=function(d,g,h,b){var c=d.data||gantt.xml._xmlNodeToJSON(d.firstChild),f={add:gantt.addTask,isExist:gantt.isTaskExists};"links"==b&&(f.add=gantt.addLink,f.isExist=gantt.isLinkExists),f.isExist.call(gantt,g)||(c.id=g,f.add.call(gantt,c))},gantt._delete_callback=function(d,f,g,b){var c={"delete":gantt.deleteTask,isExist:gantt.isTaskExists};"links"==b&&(c["delete"]=gantt.deleteLink,c.isExist=gantt.isLinkExists),c.isExist.call(gantt,f)&&c["delete"].call(gantt,f)},gantt.assert=function(a,b){a||gantt.config.show_errors&&gantt.callEvent("onError",[b])!==!1&&gantt.message({type:"error",text:b,expire:-1})},gantt.init=function(a,b,c){this.callEvent("onBeforeGanttReady",[]),b&&c&&(this.config.start_date=this._min_date=new Date(b),this.config.end_date=this._max_date=new Date(c)),this._init_skin(),this.date.init(),this.config.scroll_size||(this.config.scroll_size=this._detectScrollSize()),gantt.event(window,"resize",this._on_resize),this.init=function(d){this.$container&&this.$container.parentNode&&(this.$container.parentNode.removeChild(this.$container),this.$container=null),this._reinit(d)},this._reinit(a)},gantt._reinit=function(a){this._init_html_area(a),this._set_sizes(),this._clear_renderers(),this.resetLightbox(),this._update_flags(),this._init_touch_events(),this._init_templates(),this._init_grid(),this._init_tasks(),this._set_scroll_events(),gantt.event(this.$container,"click",this._on_click),gantt.event(this.$container,"dblclick",this._on_dblclick),gantt.event(this.$container,"mousemove",this._on_mousemove),gantt.event(this.$container,"contextmenu",this._on_contextmenu),this.callEvent("onGanttReady",[]),this.render()},gantt._init_html_area=function(a){"string"==typeof a?this._obj=document.getElementById(a):this._obj=a,this.assert(this._obj,"Invalid html container: "+a);var b="<div class='gantt_container'><div class='gantt_grid'></div><div class='gantt_task'></div>";b+="<div class='gantt_ver_scroll'><div></div></div><div class='gantt_hor_scroll'><div></div></div></div>",this._obj.innerHTML=b,this.$container=this._obj.firstChild;var c=this.$container.childNodes;this.$grid=c[0],this.$task=c[1],this.$scroll_ver=c[2],this.$scroll_hor=c[3],this.$grid.innerHTML="<div class='gantt_grid_scale'></div><div class='gantt_grid_data'></div>",this.$grid_scale=this.$grid.childNodes[0],this.$grid_data=this.$grid.childNodes[1],this.$task.innerHTML="<div class='gantt_task_scale'></div><div class='gantt_data_area'><div class='gantt_task_bg'></div><div class='gantt_links_area'></div><div class='gantt_bars_area'></div></div>",this.$task_scale=this.$task.childNodes[0],this.$task_data=this.$task.childNodes[1],this.$task_bg=this.$task_data.childNodes[0],this.$task_links=this.$task_data.childNodes[1],this.$task_bars=this.$task_data.childNodes[2]},gantt.$click={buttons:{edit:function(a){gantt.showLightbox(a)},"delete":function(a){var b=gantt.locale.labels.confirm_deleting,c=gantt.locale.labels.confirm_deleting_title;gantt._dhtmlx_confirm(b,c,function(){if(!gantt.isTaskExists(a)){return void gantt.hideLightbox()}var d=gantt.getTask(a);d.$new?(gantt._deleteTask(a,!0),gantt.refreshData()):gantt.deleteTask(a),gantt.hideLightbox()})}}},gantt._calculate_content_height=function(){var a=this.config.scale_height,b=this._order.length*this.config.row_height,c=this._scroll_hor?this.config.scroll_size+1:0;return this._is_grid_visible()||this._is_chart_visible()?a+b+2+c:0},gantt._calculate_content_width=function(){var a=this._get_grid_width(),b=this._tasks?this._tasks.full_width:0;this._scroll_ver?this.config.scroll_size+1:0;return this._is_chart_visible()||(b=0),this._is_grid_visible()||(a=0),a+b+1},gantt._get_resize_options=function(){var a={x:!1,y:!1};return"xy"==this.config.autosize?a.x=a.y=!0:"y"==this.config.autosize||this.config.autosize===!0?a.y=!0:"x"==this.config.autosize&&(a.x=!0),a},gantt._clean_el_size=function(a){return 1*(a||"").toString().replace("px","")||0},gantt._get_box_styles=function(){var d=null;d=window.getComputedStyle?window.getComputedStyle(this._obj,null):{width:this._obj.clientWidth,height:this._obj.clientHeight};var f=["width","height","paddingTop","paddingBottom","paddingLeft","paddingRight","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"],g={boxSizing:"border-box"==d.boxSizing};d.MozBoxSizing&&(g.boxSizing="border-box"==d.MozBoxSizing);for(var b=0;b<f.length;b++){g[f[b]]=d[f[b]]?this._clean_el_size(d[f[b]]):0}var c={horPaddings:g.paddingLeft+g.paddingRight+g.borderLeftWidth+g.borderRightWidth,vertPaddings:g.paddingTop+g.paddingBottom+g.borderTopWidth+g.borderBottomWidth,borderBox:g.boxSizing,innerWidth:g.width,innerHeight:g.height,outerWidth:g.width,outerHeight:g.height};return c.borderBox?(c.innerWidth-=c.horPaddings,c.innerHeight-=c.vertPaddings):(c.outerWidth+=c.horPaddings,c.outerHeight+=c.vertPaddings),c},gantt._do_autosize=function(){var c=this._get_resize_options(),d=this._get_box_styles();if(c.y){var f=this._calculate_content_height();d.borderBox&&(f+=d.vertPaddings),this._obj.style.height=f+"px"}if(c.x){var b=this._calculate_content_width();d.borderBox&&(b+=d.horPaddings),this._obj.style.width=b+"px"}},gantt._set_sizes=function(){this._do_autosize();var a=this._get_box_styles();if(this._y=a.innerHeight,!(this._y<20)){this.$grid.style.height=this.$task.style.height=Math.max(this._y-this.$scroll_hor.offsetHeight-2,0)+"px";var b=Math.max(this._y-(this.config.scale_height||0)-this.$scroll_hor.offsetHeight-2,0);this.$grid_data.style.height=this.$task_data.style.height=b+"px";var c=Math.max(this._get_grid_width()-1,0);this.$grid.style.width=c+"px",this.$grid.style.display=0===c?"none":"",a=this._get_box_styles(),this._x=a.innerWidth,this._x<20||(this.$grid_data.style.width=Math.max(this._get_grid_width()-1,0)+"px",this.$task.style.width=Math.max(this._x-this._get_grid_width()-2,0)+"px")}},gantt.getScrollState=function(){return this.$task&&this.$task_data?{x:this.$task.scrollLeft,y:this.$task_data.scrollTop}:null},gantt._save_scroll_state=function(a,b){var c={};this._cached_scroll_pos=this._cached_scroll_pos||{},void 0!==a&&(c.x=Math.max(a,0)),void 0!==b&&(c.y=Math.max(b,0)),this.mixin(this._cached_scroll_pos,c,!0)},gantt._restore_scroll_state=function(){var a={x:0,y:0};return this._cached_scroll_pos&&(a.x=this._cached_scroll_pos.x||a.x,a.y=this._cached_scroll_pos.y||a.y),a},gantt.scrollTo=function(c,d){var f=this._restore_scroll_state();1*c==c&&(this.$task.scrollLeft=c,this._save_scroll_state(c,void 0)),1*d==d&&(this.$task_data.scrollTop=d,this.$grid_data.scrollTop=d,gantt.config.smart_rendering&&this.$grid_data.scrollTop!=d&&(this.$grid_data.scrollTop=d%gantt.config.row_height),this._save_scroll_state(void 0,this.$task_data.scrollTop));var b=gantt._restore_scroll_state();this.callEvent("onGanttScroll",[f.x,f.y,b.x,b.y])},gantt.showDate=function(a){var b=this.posFromDate(a),c=Math.max(b-this.config.task_scroll_offset,0);this.scrollTo(c)},gantt.showTask=function(c){var d=this.getTaskNode(c);if(d){var f=Math.max(d.offsetLeft-this.config.task_scroll_offset,0),b=d.offsetTop-(this.$task_data.offsetHeight-this.config.row_height)/2;this.scrollTo(f,b)}},gantt._on_resize=gantt.setSizes=function(){gantt._set_sizes(),gantt._scroll_resize()},gantt.render=function(){if(this._is_render_active()){this.callEvent("onBeforeGanttRender",[]);var c=this.copy(this._restore_scroll_state()),d=null;if(c&&(d=gantt.dateFromPos(c.x+this.config.task_scroll_offset)),this._render_grid(),this._render_tasks_scales(),this._scroll_resize(),this._on_resize(),this._render_data(),this.config.preserve_scroll&&c){var f=gantt._restore_scroll_state(),b=gantt.dateFromPos(f.x);(+d!=+b||f.y!=c.y)&&(d&&this.showDate(d),gantt.scrollTo(void 0,c.y))}this.callEvent("onGanttRender",[])}},gantt._set_scroll_events=function(){function a(l){var f=gantt._get_resize_options();gantt._wheel_time=new Date;var j=b?-20*l.deltaX:2*l.wheelDeltaX,g=b?-40*l.deltaY:l.wheelDelta;if(j&&Math.abs(j)>Math.abs(g)){if(f.x){return !0}if(!gantt.$scroll_hor||!gantt.$scroll_hor.offsetWidth){return !0}var m=j/-40,c=gantt.$task.scrollLeft,e=c+30*m;if(gantt.scrollTo(e,null),gantt.$scroll_hor.scrollLeft=e,c==gantt.$task.scrollLeft){return !0}}else{if(f.y){return !0}if(!gantt.$scroll_ver||!gantt.$scroll_ver.offsetHeight){return !0}var m=g/-40;"undefined"==typeof g&&(m=l.detail);var k=gantt.$scroll_ver.scrollTop,h=gantt.$scroll_ver.scrollTop+30*m;if(!gantt.config.prevent_default_scroll&&gantt._cached_scroll_pos&&(gantt._cached_scroll_pos.y==h||gantt._cached_scroll_pos.y<=0&&0>=h)){return !0}if(gantt.scrollTo(null,h),gantt.$scroll_ver.scrollTop=h,k==gantt.$scroll_ver.scrollTop){return !0}}return l.preventDefault&&l.preventDefault(),l.cancelBubble=!0,!1}this.event(this.$scroll_hor,"scroll",function(){if(new Date-(gantt._wheel_time||0)<100){return !0}if(!gantt._touch_scroll_active){var c=gantt.$scroll_hor.scrollLeft;gantt.scrollTo(c)}}),this.event(this.$scroll_ver,"scroll",function(){if(!gantt._touch_scroll_active){var c=gantt.$scroll_ver.scrollTop;gantt.$grid_data.scrollTop=c,gantt.scrollTo(null,c)}}),this.event(this.$task,"scroll",function(){var c=gantt.$task.scrollLeft,d=gantt.$scroll_hor.scrollLeft;d!=c&&(gantt.$scroll_hor.scrollLeft=c)}),this.event(this.$task_data,"scroll",function(){var c=gantt.$task_data.scrollTop,d=gantt.$scroll_ver.scrollTop;d!=c&&(gantt.$scroll_ver.scrollTop=c)});var b=gantt.env.isFF;b?this.event(gantt.$container,"wheel",a):this.event(gantt.$container,"mousewheel",a)},gantt._scroll_resize=function(){if(!(this._x<20||this._y<20)){var a=this._scroll_sizes();a.x?(this.$scroll_hor.style.display="block",this.$scroll_hor.style.height=a.scroll_size+"px",this.$scroll_hor.style.width=a.x+"px",this.$scroll_hor.firstChild.style.width=a.x_inner+"px"):(this.$scroll_hor.style.display="none",this.$scroll_hor.style.height=this.$scroll_hor.style.width="0px"),a.y?(this.$scroll_ver.style.display="block",this.$scroll_ver.style.width=a.scroll_size+"px",this.$scroll_ver.style.height=a.y+"px",this.$scroll_ver.style.top=this.config.scale_height+"px",this.$scroll_ver.firstChild.style.height=a.y_inner+"px"):(this.$scroll_ver.style.display="none",this.$scroll_ver.style.width=this.$scroll_ver.style.height="0px")}},gantt._scroll_sizes=function(){var m=this._get_grid_width(),h=Math.max(this._x-m,0),f=Math.max(this._y-this.config.scale_height,0),k=this.config.scroll_size+1,g=Math.max(this.$task_data.offsetWidth-k,0),p=this.config.row_height*this._order.length,b=this._get_resize_options(),c=this._scroll_hor=b.x?!1:g>h,l=this._scroll_ver=b.y?!1:p>f,j={x:!1,y:!1,scroll_size:k,x_inner:g+m+k+2,y_inner:this.config.scale_height+p};return c&&(j.x=Math.max(this._x-(l?k:2),0)),l&&(j.y=Math.max(this._y-(c?k:0)-this.config.scale_height,0)),j},gantt._getClassName=function(a){if(!a){return""}var b=a.className||"";return b.baseVal&&(b=b.baseVal),b.indexOf||(b=""),gantt._trim(b)},gantt.locate=function(d){var f=gantt._get_target_node(d),g=gantt._getClassName(f);if((g||"").indexOf("gantt_task_cell")>=0){return null}for(var b=arguments[1]||this.config.task_attribute;f;){if(f.getAttribute){var c=f.getAttribute(b);if(c){return c}}f=f.parentNode}return null},gantt._get_target_node=function(a){var b;return a.tagName?b=a:(a=a||window.event,b=a.target||a.srcElement),b},gantt._trim=function(a){var b=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};return b.apply(a)},gantt._locate_css=function(d,h,k){void 0===k&&(k=!0);for(var b=gantt._get_target_node(d),c="";b;){if(c=gantt._getClassName(b)){var f=c.indexOf(h);if(f>=0){if(!k){return b}var g=0===f||!gantt._trim(c.charAt(f-1)),j=f+h.length>=c.length||!gantt._trim(c.charAt(f+h.length));if(g&&j){return b}}}b=b.parentNode}return null},gantt._locateHTML=function(c,d){var f=gantt._get_target_node(c);for(d=d||this.config.task_attribute;f;){if(f.getAttribute){var b=f.getAttribute(d);if(b){return f}}f=f.parentNode}return null},gantt.getTaskRowNode=function(d){for(var f=this.$grid_data.childNodes,g=this.config.task_attribute,b=0;b<f.length;b++){if(f[b].getAttribute){var c=f[b].getAttribute(g);if(c==d){return f[b]}}}return null},gantt.getState=function(){return{drag_id:this._tasks_dnd.drag.id,drag_mode:this._tasks_dnd.drag.mode,drag_from_start:this._tasks_dnd.drag.left,selected_task:this._selected_task,min_date:new Date(this._min_date),max_date:new Date(this._max_date),lightbox:this._lightbox_id,touch_drag:this._touch_drag}},gantt._checkTimeout=function(a,b){if(!b){return !0}var c=1000/b;return 1>c?!0:a._on_timeout?!1:(setTimeout(function(){delete a._on_timeout},c),a._on_timeout=!0,!0)},gantt.selectTask=function(a){if(!this.config.select_task){return !1}if(a){if(this._selected_task==a){return this._selected_task}if(!this.callEvent("onBeforeTaskSelected",[a])){return !1}this.unselectTask(),this._selected_task=a,this.refreshTask(a),this.callEvent("onTaskSelected",[a])}return this._selected_task},gantt.unselectTask=function(a){var a=a||this._selected_task;a&&(this._selected_task=null,this.refreshTask(a),this.callEvent("onTaskUnselected",[a]))},gantt.getSelectedId=function(){return this.defined(this._selected_task)?this._selected_task:null},gantt.changeLightboxType=function(a){return this.getLightboxType()==a?!0:void gantt._silent_redraw_lightbox(a)},gantt._is_render_active=function(){return !this._skip_render},gantt._correct_dst_change=function(d,g,h,b){var c=gantt._get_line(b)*h;if(c>3600&&86400>c){var f=d.getTimezoneOffset()-g;f&&(d=gantt.date.add(d,f,"minute"))}return d},gantt.batchUpdate=function(q,j){var f,m=this._dp&&"off"!=this._dp.updateMode;m&&(f=this._dp.updateMode,this._dp.setUpdateMode("off"));var h=this._sync_order;this._sync_order=function(){};var u=this._sync_links;this._sync_links=function(){};var b=this._adjust_scales;this._adjust_scales=function(){};var c={},p=this.resetProjectDates;this.resetProjectDates=function(a){c[a.id]=a},this._skip_render=!0,this.callEvent("onBeforeBatchUpdate",[]);try{q()}catch(k){}this.callEvent("onAfterBatchUpdate",[]),this._sync_order=h,this._sync_order(),this._sync_links=u,this._sync_links(),this.resetProjectDates=p;for(var g in c){this.resetProjectDates(c[g])}this._adjust_scales=b,this._adjust_scales(),this._skip_render=!1,j||this.render(),m&&(this._dp.setUpdateMode(f),this._dp.setGanttMode("tasks"),this._dp.sendData(),this._dp.setGanttMode("links"),this._dp.sendData())},gantt.env={isIE:navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0,isIE6:!window.XMLHttpRequest&&navigator.userAgent.indexOf("MSIE")>=0,isIE7:navigator.userAgent.indexOf("MSIE 7.0")>=0&&navigator.userAgent.indexOf("Trident")<0,isIE8:navigator.userAgent.indexOf("MSIE 8.0")>=0&&navigator.userAgent.indexOf("Trident")>=0,isOpera:navigator.userAgent.indexOf("Opera")>=0,isChrome:navigator.userAgent.indexOf("Chrome")>=0,isKHTML:navigator.userAgent.indexOf("Safari")>=0||navigator.userAgent.indexOf("Konqueror")>=0,isFF:navigator.userAgent.indexOf("Firefox")>=0,isIPad:navigator.userAgent.search(/iPad/gi)>=0,isEdge:-1!=navigator.userAgent.indexOf("Edge")},gantt.ajax={cache:!0,method:"get",parse:function(a){if("string"!=typeof a){return a}var b;return a=a.replace(/^[\s]+/,""),window.DOMParser&&!gantt.env.isIE?b=(new window.DOMParser).parseFromString(a,"text/xml"):window.ActiveXObject!==window.undefined&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)),b},xmltop:function(c,d,f){if("undefined"==typeof d.status||d.status<400){var b=d.responseXML?d.responseXML||d:gantt.ajax.parse(d.responseText||d);if(b&&null!==b.documentElement&&!b.getElementsByTagName("parsererror").length){return b.getElementsByTagName(c)[0]}}return -1!==f&&gantt.callEvent("onLoadXMLError",["Incorrect XML",arguments[1],f]),document.createElement("DIV")},xpath:function(d,f){if(f.nodeName||(f=f.responseXML||f),gantt.env.isIE){return f.selectNodes(d)||[]}for(var g,b=[],c=(f.ownerDocument||f).evaluate(d,f,null,XPathResult.ANY_TYPE,null);;){if(g=c.iterateNext(),!g){break}b.push(g)}return b},query:function(a){gantt.ajax._call(a.method||"GET",a.url,a.data||"",a.async||!0,a.callback,null,a.headers)},get:function(a,b){this._call("GET",a,null,!0,b)},getSync:function(a){return this._call("GET",a,null,!1)},put:function(a,b,c){this._call("PUT",a,b,!0,c)},del:function(a,b,c){this._call("DELETE",a,b,!0,c)},post:function(a,b,c){1==arguments.length?b="":2!=arguments.length||"function"!=typeof b&&"function"!=typeof window[b]?b=String(b):(c=b,b=""),this._call("POST",a,b,!0,c)},postSync:function(a,b){return b=null===b?"":String(b),this._call("POST",a,b,!1)},getLong:function(a,b){this._call("GET",a,null,!0,b,{url:a})},postLong:function(a,b,c){2==arguments.length&&(c=b,b=""),this._call("POST",a,b,!0,c,{url:a,postData:b})},_call:function(m,h,f,k,g,p,b){var c=window.XMLHttpRequest&&!gantt.env.isIE?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),l=null!==navigator.userAgent.match(/AppleWebKit/)&&null!==navigator.userAgent.match(/Qt/)&&null!==navigator.userAgent.match(/Safari/);if(k&&(c.onreadystatechange=function(){if(4==c.readyState||l&&3==c.readyState){if((200!=c.status||""===c.responseText)&&!gantt.callEvent("onAjaxError",[c])){return}window.setTimeout(function(){"function"==typeof g&&g.apply(window,[{xmlDoc:c,filePath:h}]),p&&("undefined"!=typeof p.postData?gantt.ajax.postLong(p.url,p.postData,g):gantt.ajax.getLong(p.url,g)),g=null,c=null},1)}}),"GET"!=m||this.cache||(h+=(h.indexOf("?")>=0?"&":"?")+"dhxr"+(new Date).getTime()+"=1"),c.open(m,h,k),b){for(var j in b){c.setRequestHeader(j,b[j])}}else{"POST"==m.toUpperCase()||"PUT"==m||"DELETE"==m?c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"):"GET"==m&&(f=null)}return c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(f),k?void 0:{xmlDoc:c,filePath:h}}},gantt._urlSeparator=function(a){return -1!=a.indexOf("?")?"&":"?"},function(){function z(d,g){var c=d.callback;j(!1),d.box.parentNode.removeChild(d.box),p=d.box=null,c&&c(g)}function u(a){if(p){a=a||event;var c=a.which||event.keyCode;return gantt.message.keyboard&&((13==c||32==c)&&z(p,!0),27==c&&z(p,!1)),a.preventDefault&&a.preventDefault(),!(a.cancelBubble=!0)}}function j(a){j.cover||(j.cover=document.createElement("DIV"),j.cover.onkeydown=u,j.cover.className="dhx_modal_cover",document.body.appendChild(j.cover));document.body.scrollHeight;j.cover.style.display=a?"inline-block":"none"}function x(a,c){var d="gantt_"+a.toLowerCase().replace(/ /g,"_")+"_button dhtmlx_"+a.toLowerCase().replace(/ /g,"_")+"_button";return"<div class='gantt_popup_button dhtmlx_popup_button "+d+"' result='"+c+"' ><div>"+a+"</div></div>"}function m(a){w.area||(w.area=document.createElement("DIV"),w.area.className="gantt_message_area dhtmlx_message_area",w.area.style[w.position]="5px",document.body.appendChild(w.area)),w.hide(a.id);var c=document.createElement("DIV");return c.innerHTML="<div>"+a.text+"</div>",c.className="gantt-info dhtmlx-info gantt-"+a.type+" dhtmlx-"+a.type,c.onclick=function(){w.hide(a.id),a=null},"bottom"==w.position&&w.area.firstChild?w.area.insertBefore(c,w.area.firstChild):w.area.appendChild(c),a.expire>0&&(w.timers[a.id]=window.setTimeout(function(){w.hide(a.id)},a.expire)),w.pull[a.id]=c,c=null,a.id}function A(h,t,c){var d=document.createElement("DIV");d.className=" gantt_modal_box dhtmlx_modal_box gantt-"+h.type+" dhtmlx-"+h.type,d.setAttribute("dhxbox",1);var g="";if(h.width&&(d.style.width=h.width),h.height&&(d.style.height=h.height),h.title&&(g+='<div class="gantt_popup_title dhtmlx_popup_title">'+h.title+"</div>"),g+='<div class="gantt_popup_text dhtmlx_popup_text"><span>'+(h.content?"":h.text)+'</span></div><div  class="gantt_popup_controls dhtmlx_popup_controls">',t&&(g+=x(h.ok||"OK",!0)),c&&(g+=x(h.cancel||"Cancel",!1)),h.buttons){for(var l=0;l<h.buttons.length;l++){g+=x(h.buttons[l],l)}}if(g+="</div>",d.innerHTML=g,h.content){var a=h.content;"string"==typeof a&&(a=document.getElementById(a)),"none"==a.style.display&&(a.style.display=""),d.childNodes[h.title?1:0].appendChild(a)}return d.onclick=function(r){r=r||event;var e=r.target||r.srcElement;if(e.className||(e=e.parentNode),"gantt_popup_button"==e.className.split(" ")[0]){var o=e.getAttribute("result");o="true"==o||("false"==o?!1:o),z(h,o)}},h.box=d,(t||c)&&(p=h),d}function b(g,c,e){var h=g.tagName?g:A(g,c,e);g.hidden||j(!0),document.body.appendChild(h);var l=Math.abs(Math.floor(((window.innerWidth||document.documentElement.offsetWidth)-h.offsetWidth)/2)),d=Math.abs(Math.floor(((window.innerHeight||document.documentElement.offsetHeight)-h.offsetHeight)/2));return"top"==g.position?h.style.top="-3px":h.style.top=d+"px",h.style.left=l+"px",h.onkeydown=u,h.focus(),g.hidden&&gantt.modalbox.hide(h),h}function f(a){return b(a,!0,!1)}function y(a){return b(a,!0,!0)}function v(a){return b(a)}function k(a,c,d){return"object"!=typeof a&&("function"==typeof c&&(d=c,c=""),a={text:a,type:c,callback:d}),a}function q(d,g,h,c){return"object"!=typeof d&&(d={text:d,type:g,expire:h,id:c}),d.id=d.id||w.uid(),d.expire=d.expire||w.expire,d}var p=null;document.attachEvent?document.attachEvent("onkeydown",u):document.addEventListener("keydown",u,!0),gantt.alert=function(){var a=k.apply(this,arguments);return a.type=a.type||"confirm",f(a)},gantt.confirm=function(){var a=k.apply(this,arguments);return a.type=a.type||"alert",y(a)},gantt.modalbox=function(){var a=k.apply(this,arguments);return a.type=a.type||"alert",v(a)},gantt.modalbox.hide=function(a){for(;a&&a.getAttribute&&!a.getAttribute("dhxbox");){a=a.parentNode}a&&(a.parentNode.removeChild(a),j(!1))};var w=gantt.message=function(d,h,i,c){d=q.apply(this,arguments),d.type=d.type||"info";var g=d.type.split("-")[0];switch(g){case"alert":return f(d);case"confirm":return y(d);case"modalbox":return v(d);default:return m(d)}};w.seed=(new Date).valueOf(),w.uid=function(){return w.seed++},w.expire=4000,w.keyboard=!0,w.position="top",w.pull={},w.timers={},w.hideAll=function(){for(var a in w.pull){w.hide(a)}},w.hide=function(a){var c=w.pull[a];c&&c.parentNode&&(window.setTimeout(function(){c.parentNode.removeChild(c),c=null},2000),c.className+=" hidden",w.timers[a]&&window.clearTimeout(w.timers[a]),delete w.pull[a])}}(),gantt.date={init:function(){for(var a=gantt.locale.date.month_short,b=gantt.locale.date.month_short_hash={},c=0;c<a.length;c++){b[a[c]]=c}for(var a=gantt.locale.date.month_full,b=gantt.locale.date.month_full_hash={},c=0;c<a.length;c++){b[a[c]]=c}},date_part:function(a){var b=new Date(a);return a.setHours(0),this.hour_start(a),a.getHours()&&(a.getDate()<b.getDate()||a.getMonth()<b.getMonth()||a.getFullYear()<b.getFullYear())&&a.setTime(a.getTime()+3600000*(24-a.getHours())),a},time_part:function(a){return(a.valueOf()/1000-60*a.getTimezoneOffset())%86400},week_start:function(a){var b=a.getDay();return gantt.config.start_on_monday&&(0===b?b=6:b--),this.date_part(this.add(a,-1*b,"day"))},month_start:function(a){return a.setDate(1),this.date_part(a)},year_start:function(a){return a.setMonth(0),this.month_start(a)},day_start:function(a){return this.date_part(a)},hour_start:function(a){return a.getMinutes()&&a.setMinutes(0),this.minute_start(a),a},minute_start:function(a){return a.getSeconds()&&a.setSeconds(0),a.getMilliseconds()&&a.setMilliseconds(0),a},_add_days:function(a,b){var c=new Date(a.valueOf());return c.setDate(c.getDate()+b),b>=0&&!a.getHours()&&c.getHours()&&(c.getDate()<=a.getDate()||c.getMonth()<a.getMonth()||c.getFullYear()<a.getFullYear())&&c.setTime(c.getTime()+3600000*(24-c.getHours())),c},add:function(c,d,f){var b=new Date(c.valueOf());switch(f){case"day":b=gantt.date._add_days(b,d);break;case"week":b=gantt.date._add_days(b,7*d);break;case"month":b.setMonth(b.getMonth()+d);break;case"year":b.setYear(b.getFullYear()+d);break;case"hour":b.setTime(b.getTime()+60*d*60*1000);break;case"minute":b.setTime(b.getTime()+60*d*1000);break;default:return gantt.date["add_"+f](c,d,f)}return b},to_fixed:function(a){return 10>a?"0"+a:a},copy:function(a){return new Date(a.valueOf())},date_to_str:function(a,b){return a=a.replace(/%[a-zA-Z]/g,function(c){switch(c){case"%d":return'"+gantt.date.to_fixed(date.getDate())+"';case"%m":return'"+gantt.date.to_fixed((date.getMonth()+1))+"';case"%j":return'"+date.getDate()+"';case"%n":return'"+(date.getMonth()+1)+"';case"%y":return'"+gantt.date.to_fixed(date.getFullYear()%100)+"';case"%Y":return'"+date.getFullYear()+"';case"%D":return'"+gantt.locale.date.day_short[date.getDay()]+"';case"%l":return'"+gantt.locale.date.day_full[date.getDay()]+"';case"%M":return'"+gantt.locale.date.month_short[date.getMonth()]+"';case"%F":return'"+gantt.locale.date.month_full[date.getMonth()]+"';case"%h":return'"+gantt.date.to_fixed((date.getHours()+11)%12+1)+"';case"%g":return'"+((date.getHours()+11)%12+1)+"';case"%G":return'"+date.getHours()+"';case"%H":return'"+gantt.date.to_fixed(date.getHours())+"';case"%i":return'"+gantt.date.to_fixed(date.getMinutes())+"';case"%a":return'"+(date.getHours()>11?"pm":"am")+"';case"%A":return'"+(date.getHours()>11?"PM":"AM")+"';case"%s":return'"+gantt.date.to_fixed(date.getSeconds())+"';case"%W":return'"+gantt.date.to_fixed(gantt.date.getISOWeek(date))+"';default:return c}}),b&&(a=a.replace(/date\.get/g,"date.getUTC")),new Function("date",'return "'+a+'";')},str_to_date:function(d,g){for(var h="var temp=date.match(/[a-zA-Z]+|[0-9]+/g);",b=d.match(/%[a-zA-Z]/g),c=0;c<b.length;c++){switch(b[c]){case"%j":case"%d":h+="set[2]=temp["+c+"]||1;";break;case"%n":case"%m":h+="set[1]=(temp["+c+"]||1)-1;";break;case"%y":h+="set[0]=temp["+c+"]*1+(temp["+c+"]>50?1900:2000);";break;case"%g":case"%G":case"%h":case"%H":h+="set[3]=temp["+c+"]||0;";break;case"%i":h+="set[4]=temp["+c+"]||0;";break;case"%Y":h+="set[0]=temp["+c+"]||0;";break;case"%a":case"%A":h+="set[3]=set[3]%12+((temp["+c+"]||'').toLowerCase()=='am'?0:12);";break;case"%s":h+="set[5]=temp["+c+"]||0;";break;case"%M":h+="set[1]=gantt.locale.date.month_short_hash[temp["+c+"]]||0;";break;case"%F":h+="set[1]=gantt.locale.date.month_full_hash[temp["+c+"]]||0;"}}var f="set[0],set[1],set[2],set[3],set[4],set[5]";return g&&(f=" Date.UTC("+f+")"),new Function("date","var set=[0,0,1,0,0,0]; "+h+" return new Date("+f+");")},getISOWeek:function(d){if(!d){return !1}var g=d.getDay();0===g&&(g=7);var h=new Date(d.valueOf());h.setDate(d.getDate()+(4-g));var b=h.getFullYear(),c=Math.round((h.getTime()-new Date(b,0,1).getTime())/86400000),f=1+Math.floor(c/7);return f},getUTCISOWeek:function(a){return this.getISOWeek(a)},convert_to_utc:function(a){return new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())},parseDate:function(a,b){return"string"==typeof a&&(gantt.defined(b)&&(b="string"==typeof b?gantt.defined(gantt.templates[b])?gantt.templates[b]:gantt.date.str_to_date(b):gantt.templates.xml_date),a=a?b(a):null),a}},gantt.date.quarter_start=function(a){gantt.date.month_start(a);var b,c=a.getMonth();return b=c>=9?9:c>=6?6:c>=3?3:0,a.setMonth(b),a},gantt.date.add_quarter=function(a,b){return gantt.date.add(a,3*b,"month")},gantt.config||(gantt.config={}),gantt.config||(gantt.config={}),gantt.templates||(gantt.templates={}),function(){gantt.mixin(gantt.config,{links:{finish_to_start:"0",start_to_start:"1",finish_to_finish:"2",start_to_finish:"3"},types:{task:"task",project:"project",milestone:"milestone"},duration_unit:"day",work_time:!1,correct_work_time:!1,skip_off_time:!1,autosize:!1,autosize_min_width:0,show_links:!0,show_task_cells:!0,static_background:!1,branch_loading:!1,show_loading:!1,show_chart:!0,show_grid:!0,min_duration:3600000,xml_date:"%d-%m-%Y %H:%i",api_date:"%d-%m-%Y %H:%i",start_on_monday:!0,server_utc:!1,show_progress:!0,fit_tasks:!1,select_task:!0,scroll_on_click:!0,preserve_scroll:!0,readonly:!1,date_grid:"%Y-%m-%d",drag_links:!0,drag_progress:!0,drag_resize:!0,drag_move:!0,drag_mode:{resize:"resize",progress:"progress",move:"move",ignore:"ignore"},round_dnd_dates:!0,link_wrapper_width:20,root_id:0,autofit:!1,columns:[{name:"text",tree:!0,width:"*",resize:!0},{name:"start_date",align:"center",resize:!0},{name:"duration",align:"center"},{name:"add",width:"44"}],step:1,scale_unit:"day",scale_offset_minimal:!0,subscales:[],inherit_scale_class:!1,time_step:60,duration_step:1,date_scale:"%d %M",task_date:"%d %F %Y",time_picker:"%H:%i",task_attribute:"task_id",link_attribute:"link_id",layer_attribute:"data-layer",buttons_left:["gantt_save_btn","gantt_cancel_btn"],_migrate_buttons:{dhx_save_btn:"gantt_save_btn",dhx_cancel_btn:"gantt_cancel_btn",dhx_delete_btn:"gantt_delete_btn"},buttons_right:["gantt_delete_btn"],lightbox:{sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"time",type:"duration",map_to:"auto"}],project_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",readonly:!0,map_to:"auto"}],milestone_sections:[{name:"description",height:70,map_to:"text",type:"textarea",focus:!0},{name:"type",type:"typeselect",map_to:"type"},{name:"time",type:"duration",single_date:!0,map_to:"auto"}]},drag_lightbox:!0,sort:!1,details_on_create:!0,details_on_dblclick:!0,initial_scroll:!0,task_scroll_offset:100,order_branch:!1,order_branch_free:!1,task_height:"full",min_column_width:70,min_grid_column_width:70,grid_resizer_column_attribute:"column_index",grid_resizer_attribute:"grid_resizer",keep_grid_width:!1,grid_resize:!1,show_unscheduled:!0,readonly_property:"readonly",editable_property:"editable",type_renderers:{},open_tree_initially:!1,optimize_render:!0,prevent_default_scroll:!1,show_errors:!0}),gantt.keys={edit_save:13,edit_cancel:27},gantt._init_template=function(c,d,f){var b=this._reg_templates||{};f=f||c,this.config[c]&&b[f]!=this.config[c]&&(d&&this.templates[f]||(this.templates[f]=this.date.date_to_str(this.config[c]),b[f]=this.config[c])),this._reg_templates=b},gantt._init_templates=function(){var a=gantt.locale.labels;a.gantt_save_btn=a.icon_save,a.gantt_cancel_btn=a.icon_cancel,a.gantt_delete_btn=a.icon_delete;var b=this.date.date_to_str,c=this.config;gantt._init_template("date_scale",!0),gantt._init_template("date_grid",!0,"grid_date_format"),gantt._init_template("task_date",!0),gantt.mixin(this.templates,{xml_date:this.date.str_to_date(c.xml_date,c.server_utc),xml_format:b(c.xml_date,c.server_utc),api_date:this.date.str_to_date(c.api_date),progress_text:function(d,f,g){return""},grid_header_class:function(d,f){return""},task_text:function(d,f,g){return g.text},task_class:function(d,f,g){return""},grid_row_class:function(d,f,g){return""},task_row_class:function(d,f,g){return""},task_cell_class:function(d,f){return""},scale_cell_class:function(d){return""},scale_row_class:function(d){return""},grid_indent:function(d){return"<div class='gantt_tree_indent'></div>"},grid_folder:function(d){return"<div class='gantt_tree_icon gantt_folder_"+(d.$open?"open":"closed")+"'></div>"},grid_file:function(d){return"<div class='gantt_tree_icon gantt_file'></div>"},grid_open:function(d){return"<div class='gantt_tree_icon gantt_"+(d.$open?"close":"open")+"'></div>"},grid_blank:function(d){return"<div class='gantt_tree_icon gantt_blank'></div>"},date_grid:function(d,f){return f&&gantt.isUnscheduledTask(f)&&gantt.config.show_unscheduled?gantt.templates.task_unscheduled_time(f):gantt.templates.grid_date_format(d)},task_time:function(d,f,g){return gantt.isUnscheduledTask(g)&&gantt.config.show_unscheduled?gantt.templates.task_unscheduled_time(g):gantt.templates.task_date(d)+" - "+gantt.templates.task_date(f)},task_unscheduled_time:function(d){return""},time_picker:b(c.time_picker),link_class:function(d){return""},link_description:function(d){var f=gantt.getTask(d.source),g=gantt.getTask(d.target);return"<b>"+f.text+"</b> &ndash;  <b>"+g.text+"</b>"},drag_link:function(g,j,k,d){g=gantt.getTask(g);var f=gantt.locale.labels,h="<b>"+g.text+"</b> "+(j?f.link_start:f.link_end)+"<br/>";return k&&(k=gantt.getTask(k),h+="<b> "+k.text+"</b> "+(d?f.link_start:f.link_end)+"<br/>"),h},drag_link_class:function(g,j,k,d){var f="";if(g&&k){var h=gantt.isLinkAllowed(g,k,j,d);f=" "+(h?"gantt_link_allow":"gantt_link_deny")}return"gantt_link_tooltip"+f}}),this.callEvent("onTemplatesReady",[])}}(),window.jQuery&&!function(a){var b=[];a.fn.dhx_gantt=function(d){if(d=d||{},"string"!=typeof d){var c=[];return this.each(function(){if(this&&this.getAttribute&&!this.getAttribute("dhxgantt")){for(var e in d){"data"!=e&&(gantt.config[e]=d[e])}gantt.init(this),d.data&&gantt.parse(d.data),c.push(gantt)}}),1===c.length?c[0]:c}return b[d]?b[d].apply(this,[]):void a.error("Method "+d+" does not exist on jQuery.dhx_gantt")}}(jQuery),gantt.locale={date:{month_full:["January","February","March","April","May","June","July","August","September","October","November","December"],month_short:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],day_full:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],day_short:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},labels:{new_task:"New task",icon_save:"Save",icon_cancel:"Cancel",icon_details:"Details",icon_edit:"Edit",icon_delete:"Delete",confirm_closing:"",confirm_deleting:"Task will be deleted permanently, are you sure?",section_description:"Description",section_time:"Time period",section_type:"Type",column_text:"Task name",column_start_date:"Start time",column_duration:"Duration",column_add:"",link:"Link",confirm_link_deleting:"will be deleted",link_start:" (start)",link_end:" (end)",type_task:"Task",type_project:"Project",type_milestone:"Milestone",minutes:"Minutes",hours:"Hours",days:"Days",weeks:"Week",months:"Months",years:"Years"}},gantt.skins.skyblue={config:{grid_width:350,row_height:27,scale_height:27,link_line_width:1,link_arrow_size:8,lightbox_additional_height:75},_second_column_width:95,_third_column_width:80},gantt.skins.meadow={config:{grid_width:350,row_height:27,scale_height:30,link_line_width:2,link_arrow_size:6,lightbox_additional_height:72},_second_column_width:95,_third_column_width:80},gantt.skins.terrace={config:{grid_width:360,row_height:35,scale_height:35,link_line_width:2,link_arrow_size:6,lightbox_additional_height:75},_second_column_width:90,_third_column_width:70},gantt.skins.broadway={config:{grid_width:360,row_height:35,scale_height:35,link_line_width:1,link_arrow_size:7,lightbox_additional_height:86},_second_column_width:90,_third_column_width:80,_lightbox_template:"<div class='gantt_cal_ltitle'><span class='gantt_mark'>&nbsp;</span><span class='gantt_time'></span><span class='gantt_title'></span><div class='gantt_cancel_btn'></div></div><div class='gantt_cal_larea'></div>",_config_buttons_left:{},_config_buttons_right:{gantt_delete_btn:"icon_delete",gantt_save_btn:"icon_save"}},gantt.config.touch_drag=500,gantt.config.touch=!0,gantt.config.touch_feedback=!0,gantt._touch_feedback=function(){gantt.config.touch_feedback&&navigator.vibrate&&navigator.vibrate(1)},gantt._init_touch_events=function(){"force"!=this.config.touch&&(this.config.touch=this.config.touch&&(-1!=navigator.userAgent.indexOf("Mobile")||-1!=navigator.userAgent.indexOf("iPad")||-1!=navigator.userAgent.indexOf("Android")||-1!=navigator.userAgent.indexOf("Touch"))),this.config.touch&&(window.navigator.msPointerEnabled?this._touch_events(["MSPointerMove","MSPointerDown","MSPointerUp"],function(a){return a.pointerType==a.MSPOINTER_TYPE_MOUSE?null:a},function(a){return !a||a.pointerType==a.MSPOINTER_TYPE_MOUSE}):this._touch_events(["touchmove","touchstart","touchend"],function(a){return a.touches&&a.touches.length>1?null:a.touches[0]?{target:a.target,pageX:a.touches[0].pageX,pageY:a.touches[0].pageY,clientX:a.touches[0].clientX,clientY:a.touches[0].clientY}:a},function(){return !1}))},gantt._touch_events=function(v,m,f){function q(a){return a&&a.preventDefault&&a.preventDefault(),(a||event).cancelBubble=!0,!1}function j(l){var o=gantt._task_area_pulls,r=gantt.getTask(l);if(r&&gantt.isTaskVisible(l)){for(var d in o){if(r=o[d][l],r&&r.getAttribute("task_id")&&r.getAttribute("task_id")==l){var g=r.cloneNode(!0);return k=r,o[d][l]=g,r.style.display="none",g.className+=" gantt_drag_move ",r.parentNode.appendChild(g),g}}}}var w,b=0,c=!1,u=!1,p=null,h=null,k=null;this._gantt_touch_event_ready||(this._gantt_touch_event_ready=1,gantt.event(gantt.$container,v[0],function(d){if(!f(d)&&c){h&&clearTimeout(h);var a=m(d);if(gantt._tasks_dnd.drag.id||gantt._tasks_dnd.drag.start_drag){return gantt._tasks_dnd.on_mouse_move(a),d.preventDefault&&d.preventDefault(),d.cancelBubble=!0,!1}if(a&&p){var l=p.pageX-a.pageX,e=p.pageY-a.pageY;if(!u&&(Math.abs(l)>5||Math.abs(e)>5)&&(gantt._touch_scroll_active=u=!0,b=0,w=gantt.getScrollState()),u){gantt.scrollTo(w.x+l,w.y+e);var n=gantt.getScrollState();if(w.x!=n.x&&e>2*l||w.y!=n.y&&l>2*e){return q(d)}}}return q(d)}})),gantt.event(this.$container,"contextmenu",function(a){return c?q(a):void 0}),gantt.event(this.$container,v[1],function(a){if(!f(a)){if(a.touches&&a.touches.length>1){return void (c=!1)}if(c=!0,p=m(a),p&&b){var d=new Date;500>d-b?(gantt._on_dblclick(p),q(a)):b=d}else{b=new Date}h=setTimeout(function(){var e=gantt.locate(p);!e||gantt._locate_css(p,"gantt_link_control")||gantt._locate_css(p,"gantt_grid_data")||(gantt._tasks_dnd.on_mouse_down(p),gantt._tasks_dnd.drag&&gantt._tasks_dnd.drag.start_drag&&(j(e),gantt._tasks_dnd._start_dnd(p),gantt._touch_drag=!0,gantt.refreshTask(e),gantt._touch_feedback())),h=null},gantt.config.touch_drag)}}),gantt.event(this.$container,v[2],function(e){if(!f(e)){h&&clearTimeout(h),gantt._touch_drag=!1,c=!1;var d=m(e);gantt._tasks_dnd.on_mouse_up(d),k&&(gantt.refreshTask(gantt.locate(k)),k.parentNode&&(k.parentNode.removeChild(k),gantt._touch_feedback())),gantt._touch_scroll_active=c=u=!1,k=null}})},function(){function c(j,l){var m=gantt.env.isIE?"":"%c",g=[m,'"',j,'"',m," has been deprecated in dhtmlxGantt v4.0 and will stop working in v5.0. Use ",m,'"',l,'"',m," instead. \nSee more details at http://docs.dhtmlx.com/gantt/migrating.html "].join(""),h=window.console.warn||window.console.log,k=[g];gantt.env.isIE||(k=k.concat(["font-weight:bold","font-weight:normal","font-weight:bold","font-weight:normal"])),h.apply(window.console,k)}function d(a){return function(){return c("dhtmlx."+a,"gantt."+a),gantt[a].apply(gantt,arguments)}}window.dhtmlx||(window.dhtmlx={});for(var f=["message","alert","confirm","modalbox","uid","copy","mixin","defined","bind","assert"],b=0;b<f.length;b++){window.dhtmlx[f[b]]||(dhtmlx[f[b]]=d(f[b]))}window.dataProcessor||(window.dataProcessor=function(a){return c("new dataProcessor(url)","new gantt.dataProcessor(url)"),new gantt.dataProcessor(a)})}();