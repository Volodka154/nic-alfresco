(function(){var e=YAHOO.util.Dom,b=YAHOO.util.Event;var g=/^([0-9]+)$/;Alfresco.WindowChoiceContactor=function d(i){Alfresco.WindowChoiceContactor.superclass.constructor.call(this,i,[]);this.name="Alfresco.WindowChoiceContactor";Alfresco.util.ComponentManager.reregister(this);return this};YAHOO.extend(Alfresco.WindowChoiceContactor,Alfresco.WindowChoiceItem,{inputINN:null,inputKPP:null,extra:{},onReady:function a(){Alfresco.WindowChoiceContactor.superclass.dialogCreate.call(this);this.editForm();this.setEvents();this.options.dataUrl.classes="body_table_choice_contractor";this.options.dataUrl.type="btl-contr:contractor-folder";this.options.dataUrl.field="name,inn,kpp";this.options.dataUrl.extra=""},inputEvent:function h(){b.on(this.input,"input",function(j,i){this.options.dataUrl.q_word=encodeURI(this.input.value);this.cleanData();if(this.input.value.length>2||this.input.value.length==0){this.getPageData()}else{this.tBodyLeft.innerHTML="Введите не менее 3-х символов."}},this,true)},setEvents:function f(){Alfresco.WindowChoiceContactor.superclass.setEvents.call(this);b.on(this.inputINN,"input",function(l,k){if(this.inputINN.value.length==0||g.test(this.input.value)){if("inn" in this.extra){if(this.inputINN.value!=""){this.extra.inn=this.inputINN.value}else{delete this.extra.inn}}else{if(this.inputINN.value!=""){this.extra.inn=this.inputINN.value}}this.options.dataUrl.extra="";if("inn" in this.extra&&this.extra.inn!=""){this.options.dataUrl.extra=" @btl\\-contr:inn:"+this.extra.inn+"*"}if("kpp" in this.extra&&this.extra.kpp!=""){this.options.dataUrl.extra+=(this.options.dataUrl.extra)?" AND @btl\\-contr:kpp:"+this.extra.kpp+"*":"@btl\\-contr:kpp:"+this.extra.kpp+"*"}this.cleanData();this.getPageData()}else{}},this,true);b.on(this.inputKPP,"input",function(l,k){if("kpp" in this.extra){if(this.inputKPP.value!=""){this.extra.kpp=this.inputKPP.value}else{delete this.extra.kpp}}else{if(this.inputKPP.value!=""){this.extra.kpp=this.inputKPP.value}}this.options.dataUrl.extra="";if("inn" in this.extra&&this.extra.inn!=""){this.options.dataUrl.extra=" @btl\\-contr:inn:"+this.extra.inn+"*"}if("kpp" in this.extra&&this.extra.kpp!=""){this.options.dataUrl.extra+=(this.options.dataUrl.extra)?" AND @btl\\-contr:kpp:"+this.extra.kpp+"*":"@btl\\-contr:kpp:"+this.extra.kpp+"*"}this.cleanData();this.getPageData()},this,true);function j(k){if(k.which==null){if(k.keyCode<32){return null}return String.fromCharCode(k.keyCode)}if(k.which!=0&&k.charCode!=0){if(k.which<32){return null}return String.fromCharCode(k.which)}return null}var i=function(l){l=l||event;if(l.ctrlKey||l.altKey||l.metaKey){return}var k=j(l);if(k==null){return}if(k<"0"||k>"9"){return false}};this.inputKPP.onkeypress=i;this.inputINN.onkeypress=i},editForm:function c(){var k=document.createElement("input");k.style.width="250px";k.setAttribute("placeholder","ИНН");var q=document.createElement("input");q.style.width="250px";q.setAttribute("placeholder","КПП");this.input.style.width="320px";this.input.setAttribute("placeholder","Название");var i=this.input.parentNode;i.insertBefore(k,this.input.nextSibling);i.insertBefore(q,k.nextSibling);this.inputINN=k;this.inputKPP=q;var l=document.createElement("div");var r=document.createElement("span");r.innerHTML="Название";r.className="head_table_choice_contractor";r.setAttribute("style","margin-left:15px;");var p=document.createElement("span");p.innerHTML="ИНН";p.className="head_table_choice_contractor";var m=document.createElement("span");m.innerHTML="КПП";m.className="head_table_choice_contractor";l.appendChild(r);l.appendChild(p);l.appendChild(m);var j=this.tBodyLeft.parentNode;j.insertBefore(l,this.tBodyLeft);var n=this.tBodyRight.parentNode;var o=l.cloneNode(true);n.insertBefore(o,this.tBodyRight)}})})();